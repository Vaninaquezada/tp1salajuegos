import{A as rE,B as iE,C as sE,D as oE,E as Ua,F as Re,G as tr,H as Zt,I as Rs,J as _i,K as _u,L as yu,M as vu,N as aE,O as Ps,P as wu,Q as Ze,R as bt,S as Lp,T as Bp,U as Cu,V as jp,W as qp,a as j,b as As,c as pu,d as YC,e as JC,f as Mp,g as Np,h as Ss,i as Fp,j as Fa,k as Op,l as XC,m as Rn,n as Vp,o as gu,p as ZC,q as eE,r as mu,s as nt,t as tE,u as nE,v as Pn,w as mi,x as Up,y as Oa,z as Va}from"./chunk-N6NWTE6O.js";import{a as KC,b as QC}from"./chunk-HTOYDNA7.js";import{$ as gC,$a as Me,A as Sa,Aa as su,Ab as Na,B as vp,Ba as bC,Bb as LC,C as ys,Ca as se,Cb as pi,D as hC,Da as Pa,Db as er,E as eu,Ea as TC,Eb as bs,F as An,Fa as di,Fb as Xt,G as wp,Ga as Z,Gb as Tr,H as dC,Ha as AC,Hb as BC,I as tu,Ia as SC,Ib as jC,J as vs,Ja as Rp,Jb as qC,K as Cp,Ka as He,Kb as du,L as ws,La as hn,Lb as $C,M as Xe,Ma as qe,Mb as fu,N as Ep,Na as Jt,Nb as Sn,O as fC,Oa as ot,P as pt,Pa as RC,Pb as Ts,Q as Te,Qa as ou,Qb as zC,R as Yn,Ra as PC,Rb as It,S as le,Sa as DC,Sb as GC,T as un,Ta as Da,Tb as WC,U as pC,Ua as ke,Ub as gi,V as ne,Va as Pp,Vb as HC,W as Ip,Wa as xa,X as z,Xa as O,Y as Q,Ya as U,Z as Rt,Za as we,_ as Ir,_a as au,a as rC,aa as mC,ab as br,b as iC,ba as Ot,bb as ka,c as Wt,ca as Vt,cb as xC,d as gp,da as _C,db as kC,e as mp,ea as Jn,eb as Dp,f as Ft,fa as nu,fb as xp,g as Ht,ga as ru,gb as MC,h as Zc,ha as Xn,hb as G,i as sC,ia as yC,ib as dn,j as Qn,ja as Qt,jb as Ma,k as Er,ka as bp,l as ui,la as vC,lb as lu,m as Fe,ma as iu,mb as cu,n as J,na as Yt,nb as uu,o as Aa,oa as xe,ob as Zn,p as oC,pa as Tp,q as aC,qa as wC,qb as NC,r as te,ra as hi,rb as fi,s as _p,sa as Cs,sb as Es,t as Kt,ta as CC,tb as FC,u as lC,ua as Ap,ub as OC,v as yp,va as EC,vb as kp,w as cC,wa as Ut,wb as hu,x as uC,xa as Sp,xb as VC,y as cn,ya as IC,yb as UC,z as _s,za as Ra,zb as Is}from"./chunk-N5BIHXGG.js";import{a as $,b as ye,d as pp,e as R}from"./chunk-U7UK6LYI.js";var bu=new ne(""),Wp=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new Te(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(z(bu),z(xe))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),La=class{_doc;constructor(e){this._doc=e}manager},Eu="ng-app-id";function lE(n){for(let e of n)e.remove()}function cE(n,e){let t=e.createElement("style");return t.textContent=n,t}function AP(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Eu}="${e}"],link[${Eu}="${e}"]`);if(i)for(let s of i)s.removeAttribute(Eu),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function zp(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Hp=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=gi(s),AP(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,cE);r?.forEach(i=>this.addUsage(i,this.external,zp))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(lE(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])lE(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,cE(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,zp(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Eu,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(z(Xt),z(Ap),z(Sp,8),z(Ut))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),$p={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Kp=/%COMP%/g;var hE="%COMP%",SP=`_nghost-${hE}`,RP=`_ngcontent-${hE}`,PP=!0,DP=new ne("",{providedIn:"root",factory:()=>PP});function xP(n){return RP.replace(Kp,n)}function kP(n){return SP.replace(Kp,n)}function dE(n,e){return e.map(t=>t.replace(Kp,n))}var Qp=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c,u=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=u,this.tracingService=d,this.platformIsServer=gi(a),this.defaultRenderer=new Ba(t,o,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ra.ShadowDom&&(r=ye($({},r),{encapsulation:Ra.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Iu?i.applyToHost(t):i instanceof ja&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,p=this.platformIsServer,m=this.tracingService;switch(r.encapsulation){case Ra.Emulated:s=new Iu(c,u,r,this.appId,d,o,a,p,m);break;case Ra.ShadowDom:return new Gp(c,u,t,r,o,a,this.nonce,p,m);default:s=new ja(c,u,r,d,o,a,p,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(z(Wp),z(Hp),z(Ap),z(DP),z(Xt),z(Ut),z(xe),z(Sp),z(IC,8))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),Ba=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS($p[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(uE(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(uE(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Te(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=$p[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=$p[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Pa.DashCase|Pa.Important)?e.style.setProperty(t,r,i&Pa.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Pa.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Tr().getGlobalEventTarget(this.doc,e),!e))throw new Te(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function uE(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Gp=class extends Ba{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,o,a,c,u){super(e,s,o,c,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=i.styles;d=dE(i.id,d);for(let m of d){let y=document.createElement("style");a&&y.setAttribute("nonce",a),y.textContent=m,this.shadowRoot.appendChild(y)}let p=i.getExternalStyles?.();if(p)for(let m of p){let y=zp(m,s);a&&y.setAttribute("nonce",a),this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ja=class extends Ba{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,u){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let d=r.styles;this.styles=u?dE(u,d):d,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Iu=class extends ja{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,u){let d=i+"-"+r.id;super(e,t,r,s,o,a,c,u,d),this.contentAttr=xP(d),this.hostAttr=kP(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Tu=class n extends jC{supportsDOMEvents=!0;static makeCurrent(){BC(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=MP();return t==null?null:NP(t)}resetBaseElement(){qa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return GC(document.cookie,e)}},qa=null;function MP(){return qa=qa||document.querySelector("base"),qa?qa.getAttribute("href"):null}function NP(n){return new URL(n,document.baseURI).pathname}var FP=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),pE=(()=>{class n extends La{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(z(Xt))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})(),fE=["alt","control","meta","shift"],OP={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},VP={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},gE=(()=>{class n extends La{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Tr().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),fE.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),o+=u+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=OP[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),fE.forEach(o=>{if(o!==i){let a=VP[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(z(Xt))};static \u0275prov=le({token:n,factory:n.\u0275fac})}return n})();function Yp(n,e){return LC($({rootComponent:n},UP(e)))}function UP(n){return{appProviders:[...$P,...n?.providers??[]],platformProviders:qP}}function LP(){Tu.makeCurrent()}function BP(){return new Tp}function jP(){return CC(document),document}var qP=[{provide:Ut,useValue:WC},{provide:EC,useValue:LP,multi:!0},{provide:Xt,useFactory:jP}];var $P=[{provide:mC,useValue:"root"},{provide:Tp,useFactory:BP},{provide:bu,useClass:pE,multi:!0,deps:[Xt]},{provide:bu,useClass:gE,multi:!0,deps:[Xt]},Qp,Hp,Wp,{provide:TC,useExisting:Qp},{provide:HC,useClass:FP},[]];var mE=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(z(Xt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var oe="primary",nl=Symbol("RouteTitle"),tg=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function wi(n){return new tg(n)}function bE(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function GP(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Dn(n[t],e[t]))return!1;return!0}function Dn(n,e){let t=n?ng(n):void 0,r=e?ng(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!TE(n[i],e[i]))return!1;return!0}function ng(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function TE(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function AE(n){return n.length>0?n[n.length-1]:null}function Rr(n){return oC(n)?n:ou(n)?Fe(Promise.resolve(n)):J(n)}var WP={exact:RE,subset:PE},SE={exact:HP,subset:KP,ignored:()=>!0};function _E(n,e,t){return WP[t.paths](n.root,e.root,t.matrixParams)&&SE[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function HP(n,e){return Dn(n,e)}function RE(n,e,t){if(!yi(n.segments,e.segments)||!Ru(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!RE(n.children[r],e.children[r],t))return!1;return!0}function KP(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>TE(n[t],e[t]))}function PE(n,e,t){return DE(n,e,e.segments,t)}function DE(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!yi(i,t)||e.hasChildren()||!Ru(i,t,r))}else if(n.segments.length===t.length){if(!yi(n.segments,t)||!Ru(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!PE(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!yi(n.segments,i)||!Ru(n.segments,i,r)||!n.children[oe]?!1:DE(n.children[oe],e,s,r)}}function Ru(n,e,t){return e.every((r,i)=>SE[t](n[i].parameters,r.parameters))}var kn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new _e([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=wi(this.queryParams),this._queryParamMap}toString(){return JP.serialize(this)}},_e=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pu(this)}},Ar=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=wi(this.parameters),this._parameterMap}toString(){return kE(this)}};function QP(n,e){return yi(n,e)&&n.every((t,r)=>Dn(t.parameters,e[r].parameters))}function yi(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function YP(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===oe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==oe&&(t=t.concat(e(i,r)))}),t}var rl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:()=>new Ci,providedIn:"root"})}return n})(),Ci=class{parse(e){let t=new ig(e);return new kn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${$a(e.root,!0)}`,r=eD(e.queryParams),i=typeof e.fragment=="string"?`#${XP(e.fragment)}`:"";return`${t}${r}${i}`}},JP=new Ci;function Pu(n){return n.segments.map(e=>kE(e)).join("/")}function $a(n,e){if(!n.hasChildren())return Pu(n);if(e){let t=n.children[oe]?$a(n.children[oe],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==oe&&r.push(`${i}:${$a(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=YP(n,(r,i)=>i===oe?[$a(n.children[oe],!1)]:[`${i}:${$a(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[oe]!=null?`${Pu(n)}/${t[0]}`:`${Pu(n)}/(${t.join("//")})`}}function xE(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Au(n){return xE(n).replace(/%3B/gi,";")}function XP(n){return encodeURI(n)}function rg(n){return xE(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Du(n){return decodeURIComponent(n)}function yE(n){return Du(n.replace(/\+/g,"%20"))}function kE(n){return`${rg(n.path)}${ZP(n.parameters)}`}function ZP(n){return Object.entries(n).map(([e,t])=>`;${rg(e)}=${rg(t)}`).join("")}function eD(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Au(t)}=${Au(i)}`).join("&"):`${Au(t)}=${Au(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var tD=/^[^\/()?;#]+/;function Jp(n){let e=n.match(tD);return e?e[0]:""}var nD=/^[^\/()?;=#]+/;function rD(n){let e=n.match(nD);return e?e[0]:""}var iD=/^[^=?&#]+/;function sD(n){let e=n.match(iD);return e?e[0]:""}var oD=/^[^&#]+/;function aD(n){let e=n.match(oD);return e?e[0]:""}var ig=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new _e([],{}):new _e([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[oe]=new _e(e,t)),r}parseSegment(){let e=Jp(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Te(4009,!1);return this.capture(e),new Ar(Du(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=rD(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Jp(this.remaining);i&&(r=i,this.capture(r))}e[Du(t)]=Du(r)}parseQueryParam(e){let t=sD(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=aD(this.remaining);o&&(r=o,this.capture(r))}let i=yE(t),s=yE(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Jp(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Te(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=oe);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[oe]:new _e([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Te(4011,!1)}};function ME(n){return n.segments.length>0?new _e([],{[oe]:n}):n}function NE(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=NE(i);if(r===oe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new _e(n.segments,e);return lD(t)}function lD(n){if(n.numberOfChildren===1&&n.children[oe]){let e=n.children[oe];return new _e(n.segments.concat(e.segments),e.children)}return n}function Sr(n){return n instanceof kn}function FE(n,e,t=null,r=null){let i=OE(n);return VE(i,e,t,r)}function OE(n){let e;function t(s){let o={};for(let c of s.children){let u=t(c);o[c.outlet]=u}let a=new _e(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=ME(r);return e??i}function VE(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Xp(i,i,i,t,r);let s=cD(e);if(s.toRoot())return Xp(i,i,new _e([],{}),t,r);let o=uD(s,i,n),a=o.processChildren?Ga(o.segmentGroup,o.index,s.commands):LE(o.segmentGroup,o.index,s.commands);return Xp(i,o.segmentGroup,a,t,r)}function ku(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ha(n){return typeof n=="object"&&n!=null&&n.outlets}function Xp(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let o;n===e?o=t:o=UE(n,e,t);let a=ME(NE(o));return new kn(a,s,i)}function UE(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=UE(s,e,t)}),new _e(n.segments,r)}var Mu=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&ku(r[0]))throw new Te(4003,!1);let i=r.find(Ha);if(i&&i!==AE(r))throw new Te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function cD(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Mu(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Mu(t,e,r)}var ks=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function uD(n,e,t){if(n.isAbsolute)return new ks(e,!0,0);if(!t)return new ks(e,!1,NaN);if(t.parent===null)return new ks(t,!0,0);let r=ku(n.commands[0])?0:1,i=t.segments.length-1+r;return hD(t,i,n.numberOfDoubleDots)}function hD(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Te(4005,!1);i=r.segments.length}return new ks(r,!1,i-s)}function dD(n){return Ha(n[0])?n[0].outlets:{[oe]:n}}function LE(n,e,t){if(n??=new _e([],{}),n.segments.length===0&&n.hasChildren())return Ga(n,e,t);let r=fD(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new _e(n.segments.slice(0,r.pathIndex),{});return s.children[oe]=new _e(n.segments.slice(r.pathIndex),n.children),Ga(s,0,i)}else return r.match&&i.length===0?new _e(n.segments,{}):r.match&&!n.hasChildren()?sg(n,e,t):r.match?Ga(n,0,i):sg(n,e,t)}function Ga(n,e,t){if(t.length===0)return new _e(n.segments,{});{let r=dD(t),i={};if(Object.keys(r).some(s=>s!==oe)&&n.children[oe]&&n.numberOfChildren===1&&n.children[oe].segments.length===0){let s=Ga(n.children[oe],e,t);return new _e(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=LE(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new _e(n.segments,i)}}function fD(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Ha(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!wE(c,u,o))return s;r+=2}else{if(!wE(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function sg(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Ha(s)){let c=pD(s.outlets);return new _e(r,c)}if(i===0&&ku(t[0])){let c=n.segments[e];r.push(new Ar(c.path,vE(t[0]))),i++;continue}let o=Ha(s)?s.outlets[oe]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&ku(a)?(r.push(new Ar(o,vE(a))),i+=2):(r.push(new Ar(o,{})),i++)}return new _e(r,{})}function pD(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=sg(new _e([],{}),0,r))}),e}function vE(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function wE(n,e,t){return n==t.path&&Dn(e,t.parameters)}var xu="imperative",rt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(rt||{}),Bt=class{id;url;constructor(e,t){this.id=e,this.url=t}},Ei=class extends Bt{type=rt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Mn=class extends Bt{urlAfterRedirects;type=rt.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Pt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Pt||{}),Ka=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Ka||{}),xn=class extends Bt{reason;code;type=rt.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},nr=class extends Bt{reason;code;type=rt.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Ns=class extends Bt{error;target;type=rt.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Qa=class extends Bt{urlAfterRedirects;state;type=rt.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nu=class extends Bt{urlAfterRedirects;state;type=rt.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fu=class extends Bt{urlAfterRedirects;state;shouldActivate;type=rt.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ou=class extends Bt{urlAfterRedirects;state;type=rt.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vu=class extends Bt{urlAfterRedirects;state;type=rt.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Uu=class{route;type=rt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Lu=class{route;type=rt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Bu=class{snapshot;type=rt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ju=class{snapshot;type=rt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qu=class{snapshot;type=rt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$u=class{snapshot;type=rt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ya=class{},Fs=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function gD(n,e){return n.providers&&!n._injector&&(n._injector=Rp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function fn(n){return n.outlet||oe}function mD(n,e){let t=n.filter(r=>fn(r)===e);return t.push(...n.filter(r=>fn(r)!==e)),t}function il(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var zu=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return il(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Us(this.rootInjector)}},Us=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new zu(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(z(Ot))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gu=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=og(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=og(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ag(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ag(e,this._root).map(t=>t.value)}};function og(n,e){if(n===e.value)return e;for(let t of e.children){let r=og(n,t);if(r)return r}return null}function ag(n,e){if(n===e.value)return[e];for(let t of e.children){let r=ag(n,t);if(r.length)return r.unshift(e),r}return[]}var Lt=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function xs(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ja=class extends Gu{snapshot;constructor(e,t){super(e),this.snapshot=t,gg(this,e)}toString(){return this.snapshot.toString()}};function BE(n){let e=_D(n),t=new Ht([new Ar("",{})]),r=new Ht({}),i=new Ht({}),s=new Ht({}),o=new Ht(""),a=new rr(t,r,s,o,i,oe,n,e.root);return a.snapshot=e.root,new Ja(new Lt(a,[]),e)}function _D(n){let e={},t={},r={},i="",s=new vi([],e,r,i,t,oe,n,null,{});return new Xa("",new Lt(s,[]))}var rr=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(te(u=>u[nl]))??J(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(te(e=>wi(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(te(e=>wi(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Wu(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&qE(i)&&(r.resolve[nl]=i.title),r}var vi=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[nl]}constructor(e,t,r,i,s,o,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=wi(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=wi(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Xa=class extends Gu{url;constructor(e,t){super(t),this.url=e,gg(this,t)}toString(){return jE(this._root)}};function gg(n,e){e.value._routerState=n,e.children.forEach(t=>gg(n,t))}function jE(n){let e=n.children.length>0?` { ${n.children.map(jE).join(", ")} } `:"";return`${n.value}${e}`}function Zp(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Dn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Dn(e.params,t.params)||n.paramsSubject.next(t.params),GP(e.url,t.url)||n.urlSubject.next(t.url),Dn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function lg(n,e){let t=Dn(n.params,e.params)&&QP(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||lg(n.parent,e.parent))}function qE(n){return typeof n.title=="string"||n.title===null}var $E=new ne(""),sl=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=oe;activateEvents=new Yt;deactivateEvents=new Yt;attachEvents=new Yt;detachEvents=new Yt;routerOutletData=wC(void 0);parentContexts=Q(Us);location=Q(AC);changeDetector=Q(Na);inputBinder=Q(Yu,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Te(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Te(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new cg(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=qe({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Jn]})}return n})(),cg=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===rr?this.route:e===Us?this.childContexts:e===$E?this.outletData:this.parent.get(e,t)}},Yu=new ne("");function yD(n,e,t){let r=Za(n,e._root,t?t._root:void 0);return new Ja(r,e)}function Za(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=vD(n,e,t);return new Lt(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Za(n,a)),o}}let r=wD(e.value),i=e.children.map(s=>Za(n,s));return new Lt(r,i)}}function vD(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Za(n,r,i);return Za(n,r)})}function wD(n){return new rr(new Ht(n.url),new Ht(n.params),new Ht(n.queryParams),new Ht(n.fragment),new Ht(n.data),n.outlet,n.component,n)}var Os=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},zE="ngNavigationCancelingError";function Hu(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Sr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=GE(!1,Pt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function GE(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[zE]=!0,t.cancellationCode=e,t}function CD(n){return WE(n)&&Sr(n.url)}function WE(n){return!!n&&n[zE]}var ED=(n,e,t,r)=>te(i=>(new ug(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),ug=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Zp(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=xs(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=xs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=xs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=xs(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new $u(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ju(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Zp(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Zp(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},Ku=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ms=class{component;route;constructor(e,t){this.component=e,this.route=t}};function ID(n,e,t){let r=n._root,i=e?e._root:null;return za(r,i,t,[r.value])}function bD(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ls(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!pC(n)?n:e.get(n):r}function za(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=xs(e);return n.children.forEach(o=>{TD(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Wa(a,t.getContext(o),i)),i}function TD(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=AD(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Ku(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?za(n,e,a?a.children:null,r,i):za(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ms(a.outlet.component,o))}else o&&Wa(e,a,i),i.canActivateChecks.push(new Ku(r)),s.component?za(n,null,a?a.children:null,r,i):za(n,null,t,r,i);return i}function AD(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!yi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!yi(n.url,e.url)||!Dn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!lg(n,e)||!Dn(n.queryParams,e.queryParams);case"paramsChange":default:return!lg(n,e)}}function Wa(n,e,t){let r=xs(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Wa(o,e.children.getContext(s),t):Wa(o,null,t):Wa(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ms(e.outlet.component,i)):t.canDeactivateChecks.push(new Ms(null,i)):t.canDeactivateChecks.push(new Ms(null,i))}function ol(n){return typeof n=="function"}function SD(n){return typeof n=="boolean"}function RD(n){return n&&ol(n.canLoad)}function PD(n){return n&&ol(n.canActivate)}function DD(n){return n&&ol(n.canActivateChild)}function xD(n){return n&&ol(n.canDeactivate)}function kD(n){return n&&ol(n.canMatch)}function HE(n){return n instanceof aC||n?.name==="EmptyError"}var Su=Symbol("INITIAL_VALUE");function Vs(){return Xe(n=>_p(n.map(e=>e.pipe(ys(1),ws(Su)))).pipe(te(e=>{for(let t of e)if(t!==!0){if(t===Su)return Su;if(t===!1||MD(t))return t}return!0}),cn(e=>e!==Su),ys(1)))}function MD(n){return Sr(n)||n instanceof Os}function ND(n,e){return Kt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?J(ye($({},t),{guardsResult:!0})):FD(o,r,i,n).pipe(Kt(a=>a&&SD(a)?OD(r,s,n,e):J(a)),te(a=>ye($({},t),{guardsResult:a})))})}function FD(n,e,t,r){return Fe(n).pipe(Kt(i=>jD(i.component,i.route,t,e,r)),An(i=>i!==!0,!0))}function OD(n,e,t,r){return Fe(e).pipe(Sa(i=>lC(UD(i.route.parent,r),VD(i.route,r),BD(n,i.path,t),LD(n,i.route,t))),An(i=>i!==!0,!0))}function VD(n,e){return n!==null&&e&&e(new qu(n)),J(!0)}function UD(n,e){return n!==null&&e&&e(new Bu(n)),J(!0)}function LD(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return J(!0);let i=r.map(s=>yp(()=>{let o=il(e)??t,a=Ls(s,o),c=PD(a)?a.canActivate(e,n):Vt(o,()=>a(e,n));return Rr(c).pipe(An())}));return J(i).pipe(Vs())}function BD(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>bD(o)).filter(o=>o!==null).map(o=>yp(()=>{let a=o.guards.map(c=>{let u=il(o.node)??t,d=Ls(c,u),p=DD(d)?d.canActivateChild(r,n):Vt(u,()=>d(r,n));return Rr(p).pipe(An())});return J(a).pipe(Vs())}));return J(s).pipe(Vs())}function jD(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return J(!0);let o=s.map(a=>{let c=il(e)??i,u=Ls(a,c),d=xD(u)?u.canDeactivate(n,e,t,r):Vt(c,()=>u(n,e,t,r));return Rr(d).pipe(An())});return J(o).pipe(Vs())}function qD(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return J(!0);let s=i.map(o=>{let a=Ls(o,n),c=RD(a)?a.canLoad(e,t):Vt(n,()=>a(e,t));return Rr(c)});return J(s).pipe(Vs(),KE(r))}function KE(n){return iC(pt(e=>{if(typeof e!="boolean")throw Hu(n,e)}),te(e=>e===!0))}function $D(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return J(!0);let s=i.map(o=>{let a=Ls(o,n),c=kD(a)?a.canMatch(e,t):Vt(n,()=>a(e,t));return Rr(c)});return J(s).pipe(Vs(),KE(r))}var el=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},tl=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Ds(n){return Aa(new el(n))}function zD(n){return Aa(new Te(4e3,!1))}function GD(n){return Aa(GE(!1,Pt.GuardRejected))}var hg=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return J(r);if(i.numberOfChildren>1||!i.children[oe])return zD(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:u,routeConfig:d,url:p,outlet:m,params:y,data:T,title:k}=i,x=Vt(s,()=>a({params:y,data:T,queryParams:c,fragment:u,routeConfig:d,url:p,outlet:m,title:k}));if(x instanceof kn)throw new tl(x);t=x}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new tl(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new kn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new _e(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Te(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},dg={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function WD(n,e,t,r,i){let s=QE(n,e,t);return s.matched?(r=gD(e,r),$D(r,e,t,i).pipe(te(o=>o===!0?s:$({},dg)))):J(s)}function QE(n,e,t){if(e.path==="**")return HD(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},dg):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||bE)(t,n,e);if(!i)return $({},dg);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?$($({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function HD(n){return{matched:!0,parameters:n.length>0?AE(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function CE(n,e,t,r){return t.length>0&&YD(n,t,r)?{segmentGroup:new _e(e,QD(r,new _e(t,n.children))),slicedSegments:[]}:t.length===0&&JD(n,t,r)?{segmentGroup:new _e(n.segments,KD(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new _e(n.segments,n.children),slicedSegments:t}}function KD(n,e,t,r){let i={};for(let s of t)if(Ju(n,e,s)&&!r[fn(s)]){let o=new _e([],{});i[fn(s)]=o}return $($({},r),i)}function QD(n,e){let t={};t[oe]=e;for(let r of n)if(r.path===""&&fn(r)!==oe){let i=new _e([],{});t[fn(r)]=i}return t}function YD(n,e,t){return t.some(r=>Ju(n,e,r)&&fn(r)!==oe)}function JD(n,e,t){return t.some(r=>Ju(n,e,r))}function Ju(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function XD(n,e,t){return e.length===0&&!n.children[t]}var fg=class{};function ZD(n,e,t,r,i,s,o="emptyOnly"){return new pg(n,e,t,r,i,o,s).recognize()}var ex=31,pg=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new hg(this.urlSerializer,this.urlTree)}noMatchError(e){return new Te(4002,`'${e.segmentGroup}'`)}recognize(){let e=CE(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(te(({children:t,rootSnapshot:r})=>{let i=new Lt(r,t),s=new Xa("",i),o=FE(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new vi([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,t).pipe(te(r=>({children:r,rootSnapshot:t})),_s(r=>{if(r instanceof tl)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof el?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(te(o=>o instanceof Lt?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return Fe(s).pipe(Sa(o=>{let a=r.children[o],c=mD(t,o);return this.processSegmentGroup(e,c,a,o,i)}),vs((o,a)=>(o.push(...a),o)),vp(null),dC(),Kt(o=>{if(o===null)return Ds(r);let a=YE(o);return tx(a),J(a)}))}processSegment(e,t,r,i,s,o,a){return Fe(t).pipe(Sa(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a).pipe(_s(u=>{if(u instanceof el)return J(null);throw u}))),An(c=>!!c),_s(c=>{if(HE(c))return XD(r,i,s)?J(new fg):Ds(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,a,c){return fn(r)!==o&&(o===oe||!Ju(i,s,r))?Ds(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):Ds(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:u,consumedSegments:d,positionalParamSegments:p,remainingSegments:m}=QE(t,i,s);if(!c)return Ds(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>ex&&(this.allowRedirects=!1));let y=new vi(s,u,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,EE(i),fn(i),i.component??i._loadedComponent??null,i,IE(i)),T=Wu(y,a,this.paramsInheritanceStrategy);y.params=Object.freeze(T.params),y.data=Object.freeze(T.data);let k=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,p,y,e);return this.applyRedirects.lineralizeSegments(i,k).pipe(Kt(x=>this.processSegment(e,r,t,x.concat(m),o,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a=WD(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Xe(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Xe(({routes:u})=>{let d=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:y}=c,T=new vi(m,p,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,EE(r),fn(r),r.component??r._loadedComponent??null,r,IE(r)),k=Wu(T,o,this.paramsInheritanceStrategy);T.params=Object.freeze(k.params),T.data=Object.freeze(k.data);let{segmentGroup:x,slicedSegments:W}=CE(t,m,y,u);if(W.length===0&&x.hasChildren())return this.processChildren(d,u,x,T).pipe(te(F=>new Lt(T,F)));if(u.length===0&&W.length===0)return J(new Lt(T,[]));let K=fn(r)===s;return this.processSegment(d,u,x,W,K?oe:s,!0,T).pipe(te(F=>new Lt(T,F instanceof Lt?[F]:[])))}))):Ds(t)))}getChildConfig(e,t,r){return t.children?J({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?J({routes:t._loadedRoutes,injector:t._loadedInjector}):qD(e,t,r,this.urlSerializer).pipe(Kt(i=>i?this.configLoader.loadChildren(e,t).pipe(pt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):GD(t))):J({routes:[],injector:e})}};function tx(n){n.sort((e,t)=>e.value.outlet===oe?-1:t.value.outlet===oe?1:e.value.outlet.localeCompare(t.value.outlet))}function nx(n){let e=n.value.routeConfig;return e&&e.path===""}function YE(n){let e=[],t=new Set;for(let r of n){if(!nx(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=YE(r.children);e.push(new Lt(r.value,i))}return e.filter(r=>!t.has(r))}function EE(n){return n.data||{}}function IE(n){return n.resolve||{}}function rx(n,e,t,r,i,s){return Kt(o=>ZD(n,e,t,r,o.extractedUrl,i,s).pipe(te(({state:a,tree:c})=>ye($({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function ix(n,e){return Kt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return J(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of JE(c))o.add(u);let a=0;return Fe(o).pipe(Sa(c=>s.has(c)?sx(c,r,n,e):(c.data=Wu(c,c.parent,n).resolve,J(void 0))),pt(()=>a++),wp(1),Kt(c=>a===o.size?J(t):Qn))})}function JE(n){let e=n.children.map(t=>JE(t)).flat();return[n,...e]}function sx(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!qE(i)&&(s[nl]=i.title),ox(s,n,e,r).pipe(te(o=>(n._resolvedData=o,n.data=Wu(n,n.parent,t).resolve,null)))}function ox(n,e,t,r){let i=ng(n);if(i.length===0)return J({});let s={};return Fe(i).pipe(Kt(o=>ax(n[o],e,t,r).pipe(An(),pt(a=>{if(a instanceof Os)throw Hu(new Ci,a);s[o]=a}))),wp(1),te(()=>s),_s(o=>HE(o)?Qn:Aa(o)))}function ax(n,e,t,r){let i=il(e)??r,s=Ls(n,i),o=s.resolve?s.resolve(e,t):Vt(i,()=>s(e,t));return Rr(o)}function eg(n){return Xe(e=>{let t=n(e);return t?Fe(t).pipe(te(()=>e)):J(e)})}var mg=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===oe);return r}getResolvedTitleForRoute(t){return t.data[nl]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:()=>Q(XE),providedIn:"root"})}return n})(),XE=(()=>{class n extends mg{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(z(mE))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),al=new ne("",{providedIn:"root",factory:()=>({})}),_g=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=He({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&we(0,"router-outlet")},dependencies:[sl],encapsulation:2})}return n})();function yg(n){let e=n.children&&n.children.map(yg),t=e?ye($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==oe&&(t.component=_g),t}var ll=new ne(""),ZE=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=Q(VC);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return J(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Rr(t.loadComponent()).pipe(te(tI),pt(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),eu(()=>{this.componentLoaders.delete(t)})),i=new mp(r,()=>new Ft).pipe(gp());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return J({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=eI(r,this.compiler,t,this.onLoadEndListener).pipe(eu(()=>{this.childrenLoaders.delete(r)})),o=new mp(s,()=>new Ft).pipe(gp());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function eI(n,e,t,r){return Rr(n.loadChildren()).pipe(te(tI),Kt(i=>i instanceof SC||Array.isArray(i)?J(i):Fe(e.compileModuleAsync(i))),te(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(ll,[],{optional:!0,self:!0}).flat()),{routes:o.map(yg),injector:s}}))}function lx(n){return n&&typeof n=="object"&&"default"in n}function tI(n){return lx(n)?n.default:n}var Xu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:()=>Q(cx),providedIn:"root"})}return n})(),cx=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),nI=new ne("");var rI=new ne(""),iI=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Ft;transitionAbortSubject=new Ft;configLoader=Q(ZE);environmentInjector=Q(Ot);destroyRef=Q(bp);urlSerializer=Q(rl);rootContexts=Q(Us);location=Q(du);inputBindingEnabled=Q(Yu,{optional:!0})!==null;titleStrategy=Q(mg);options=Q(al,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=Q(Xu);createViewTransition=Q(nI,{optional:!0});navigationErrorHandler=Q(rI,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>J(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Uu(i)),r=i=>this.events.next(new Lu(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(ye($({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new Ht(null),this.transitions.pipe(cn(r=>r!==null),Xe(r=>{let i=!1,s=!1;return J(r).pipe(Xe(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Pt.SupersededByNewNavigation),Qn;this.currentTransition=r,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?ye($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!a&&c!=="reload"){let u="";return this.events.next(new nr(o.id,this.urlSerializer.serialize(o.rawUrl),u,Ka.IgnoredSameUrlNavigation)),o.resolve(!1),Qn}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return J(o).pipe(Xe(u=>(this.events.next(new Ei(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?Qn:Promise.resolve(u))),rx(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),pt(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=ye($({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let d=new Qa(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:u,extractedUrl:d,source:p,restoredState:m,extras:y}=o,T=new Ei(u,this.urlSerializer.serialize(d),p,m);this.events.next(T);let k=BE(this.rootComponentType).snapshot;return this.currentTransition=r=ye($({},o),{targetSnapshot:k,urlAfterRedirects:d,extras:ye($({},y),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,J(r)}else{let u="";return this.events.next(new nr(o.id,this.urlSerializer.serialize(o.extractedUrl),u,Ka.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Qn}}),pt(o=>{let a=new Nu(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),te(o=>(this.currentTransition=r=ye($({},o),{guards:ID(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),ND(this.environmentInjector,o=>this.events.next(o)),pt(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Hu(this.urlSerializer,o.guardsResult);let a=new Fu(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),cn(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",Pt.GuardRejected),!1)),eg(o=>{if(o.guards.canActivateChecks.length!==0)return J(o).pipe(pt(a=>{let c=new Ou(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Xe(a=>{let c=!1;return J(a).pipe(ix(this.paramsInheritanceStrategy,this.environmentInjector),pt({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",Pt.NoDataFromResolver)}}))}),pt(a=>{let c=new Vu(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),eg(o=>{let a=c=>{let u=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(c.routeConfig).pipe(pt(d=>{c.component=d}),te(()=>{})));for(let d of c.children)u.push(...a(d));return u};return _p(a(o.targetSnapshot.root)).pipe(vp(null),ys(1))}),eg(()=>this.afterPreactivation()),Xe(()=>{let{currentSnapshot:o,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return c?Fe(c).pipe(te(()=>r)):J(r)}),te(o=>{let a=yD(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=ye($({},o),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,r}),pt(()=>{this.events.next(new Ya)}),ED(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),ys(1),pt({next:o=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Mn(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),fC(this.transitionAbortSubject.pipe(pt(o=>{throw o}))),eu(()=>{!i&&!s&&this.cancelNavigationTransition(r,"",Pt.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),_s(o=>{if(this.destroyed)return r.resolve(!1),Qn;if(s=!0,WE(o))this.events.next(new xn(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),CD(o)?this.events.next(new Fs(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let a=new Ns(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=Vt(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof Os){let{message:u,cancellationCode:d}=Hu(this.urlSerializer,c);this.events.next(new xn(r.id,this.urlSerializer.serialize(r.extractedUrl),u,d)),this.events.next(new Fs(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return Qn}))}))}cancelNavigationTransition(t,r,i){let s=new xn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ux(n){return n!==xu}var sI=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:()=>Q(hx),providedIn:"root"})}return n})(),Qu=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},hx=(()=>{class n extends Qu{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),oI=(()=>{class n{urlSerializer=Q(rl);options=Q(al,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=Q(du);urlHandlingStrategy=Q(Xu);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new kn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof kn?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=BE(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:()=>Q(dx),providedIn:"root"})}return n})(),dx=(()=>{class n extends oI{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Ei?this.updateStateMemento():t instanceof nr?this.commitTransition(r):t instanceof Qa?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Ya?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof xn&&(t.code===Pt.GuardRejected||t.code===Pt.NoDataFromResolver)?this.restoreHistory(r):t instanceof Ns?this.restoreHistory(r,!0):t instanceof Mn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=$($({},o),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=$($({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function vg(n,e){n.events.pipe(cn(t=>t instanceof Mn||t instanceof xn||t instanceof Ns||t instanceof nr),te(t=>t instanceof Mn||t instanceof nr?0:(t instanceof xn?t.code===Pt.Redirect||t.code===Pt.SupersededByNewNavigation:!1)?2:1),cn(t=>t!==2),ys(1)).subscribe(()=>{e()})}var fx={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},px={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Tt=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=Q(RC);stateManager=Q(oI);options=Q(al,{optional:!0})||{};pendingTasks=Q(vC);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=Q(iI);urlSerializer=Q(rl);location=Q(du);urlHandlingStrategy=Q(Xu);_events=new Ft;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=Q(sI);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=Q(ll,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!Q(Yu,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new rC;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof xn&&r.code!==Pt.Redirect&&r.code!==Pt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Mn)this.navigated=!0;else if(r instanceof Fs){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||ux(i.source)},o);this.scheduleNavigation(a,xu,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}mx(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),xu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=$({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(yg),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:o,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=$($({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=OE(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return VE(p,t,d,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Sr(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,xu,null,r)}navigate(t,r={skipLocationChange:!1}){return gx(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},fx):r===!1?i=$({},px):i=r,Sr(t))return _E(this.currentUrlTree,t,i);let s=this.parseUrl(t);return _E(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,u;o?(a=o.resolve,c=o.reject,u=o.promise):u=new Promise((p,m)=>{a=p,c=m});let d=this.pendingTasks.add();return vg(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(p=>Promise.reject(p))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gx(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Te(4008,!1)}function mx(n){return!(n instanceof Ya)&&!(n instanceof Fs)}var Pr=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Ft;constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a;let c=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof Mn&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Sr(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:bC(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:Sr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(Z(Tt),Z(rr),yC("tabindex"),Z(di),Z(hi),Z(qC))};static \u0275dir=qe({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&Me("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Da("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",pi],skipLocationChange:[2,"skipLocationChange","skipLocationChange",pi],replaceUrl:[2,"replaceUrl","replaceUrl",pi],routerLink:"routerLink"},features:[Jn]})}return n})();var yx=new ne("");function wg(n,...e){return Ir([{provide:ll,multi:!0,useValue:n},[],{provide:rr,useFactory:vx,deps:[Tt]},{provide:PC,multi:!0,useFactory:wx},e.map(t=>t.\u0275providers)])}function vx(n){return n.routerState.root}function wx(){let n=Q(Qt);return e=>{let t=n.get(DC);if(e!==t.components[0])return;let r=n.get(Tt),i=n.get(Cx);n.get(Ex)===1&&r.initialNavigation(),n.get(Ix,null,Ip.Optional)?.setUpPreloading(),n.get(yx,null,Ip.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Cx=new ne("",{factory:()=>new Ft}),Ex=new ne("",{providedIn:"root",factory:()=>1});var Ix=new ne("");var bx="firebase",Tx="11.6.1";bt.registerVersion(bx,Tx,"app-compat");var aI="@firebase/database",lI="1.0.14";var vm="";function Ax(n){vm=n}var Rg=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),nt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:mu(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Pg=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Pn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var jI=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Rg(e)}}catch{}return new Pg},bi=jI("localStorage"),Dg=jI("sessionStorage");var zs=new Rs("@firebase/database"),Sx=function(){let n=1;return function(){return n++}}(),qI=function(n){let e=oE(n),t=new iE;t.update(e);let r=t.digest();return pu.encodeByteArray(r)},wl=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=wl.apply(null,r):typeof r=="object"?e+=nt(r):e+=r,e+=" "}return e},Ti=null,cI=!0,Rx=function(n,e){j(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(zs.logLevel=Zt.VERBOSE,Ti=zs.log.bind(zs),e&&Dg.set("logging_enabled",!0)):typeof n=="function"?Ti=n:(Ti=null,Dg.remove("logging_enabled"))},gt=function(...n){if(cI===!0&&(cI=!1,Ti===null&&Dg.get("logging_enabled")===!0&&Rx(!0)),Ti){let e=wl.apply(null,n);Ti(e)}},Cl=function(n){return function(...e){gt(n,...e)}},xg=function(...n){let e="FIREBASE INTERNAL ERROR: "+wl(...n);zs.error(e)},Ai=function(...n){let e=`FIREBASE FATAL ERROR: ${wl(...n)}`;throw zs.error(e),new Error(e)},jt=function(...n){let e="FIREBASE WARNING: "+wl(...n);zs.warn(e)},Px=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&jt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},$I=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Dx=function(n){if(Rn()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ws="[MIN_NAME]",Si="[MAX_NAME]",Zs=function(n,e){if(n===e)return 0;if(n===Ws||e===Si)return-1;if(e===Ws||n===Si)return 1;{let t=uI(n),r=uI(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},xx=function(n,e){return n===e?0:n<e?-1:1},cl=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+nt(e))},wm=function(n){if(typeof n!="object"||n===null)return nt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=nt(e[r]),t+=":",t+=wm(n[e[r]]);return t+="}",t},zI=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function nn(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var GI=function(n){j(!$I(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let d=u.join(""),p="";for(c=0;c<64;c+=8){let m=parseInt(d.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),p=p+m}return p.toLowerCase()},kx=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Mx=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var Nx=new RegExp("^-?(0*)\\d{1,10}$"),Fx=-2147483648,Ox=2147483647,uI=function(n){if(Nx.test(n)){let e=Number(n);if(e>=Fx&&e<=Ox)return e}return null},El=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw jt("Exception was thrown by user callback.",t),e},Math.floor(0))}},Vx=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},pl=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var kg=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,yu(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){jt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Mg=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(gt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',jt(e)}},hI=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),th="5",WI="v",HI="s",KI="r",QI="f",YI=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,JI="ls",XI="p",Ng="ac",ZI="websocket",eb="long_polling";var Fg=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1,u=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=bi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&bi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function Ux(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function tb(n,e,t){j(typeof e=="string","typeof type must == string"),j(typeof t=="object","typeof params must == object");let r;if(e===ZI)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===eb)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Ux(n)&&(t.ns=n.namespace);let i=[];return nn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var Og=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Pn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return JC(this.counters_)}};var Cg={},Eg={};function Cm(n){let e=n.toString();return Cg[e]||(Cg[e]=new Og),Cg[e]}function Lx(n,e){let t=n.toString();return Eg[t]||(Eg[t]=e()),Eg[t]}var Vg=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&El(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var dI="start",Bx="close",jx="pLPCommand",qx="pRTLPCB",nb="id",rb="pw",ib="ser",$x="cb",zx="seg",Gx="ts",Wx="d",Hx="dframe",sb=1870,ob=30,Kx=sb-ob,Qx=25e3,Yx=3e4,Ug=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Cl(e),this.stats_=Cm(t),this.urlFn=c=>(this.appCheckToken&&(c[Ng]=this.appCheckToken),tb(t,eb,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Vg(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Yx)),Dx(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Lg((...s)=>{let[o,a,c,u,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===dI)this.id=a,this.password=c;else if(o===Bx)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[dI]="t",r[ib]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[$x]=this.scriptTagHolder.uniqueCallbackIdentifier),r[WI]=th,this.transportSessionId&&(r[HI]=this.transportSessionId),this.lastSessionId&&(r[JI]=this.lastSessionId),this.applicationId&&(r[XI]=this.applicationId),this.appCheckToken&&(r[Ng]=this.appCheckToken),typeof location<"u"&&location.hostname&&YI.test(location.hostname)&&(r[KI]=QI);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Rn()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!kx()&&!Mx()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=nt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=YC(t),i=zI(r,Kx);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Rn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[Hx]="t",r[nb]=e,r[rb]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=nt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Lg=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Rn())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Sx(),window[jx+this.uniqueCallbackIdentifier]=e,window[qx+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){gt("frame writing exception"),a.stack&&gt(a.stack),gt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||gt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[nb]=this.myID,e[rb]=this.myPW,e[ib]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ob+r.length<=sb;){let o=this.pendingSegs.shift();r=r+"&"+zx+i+"="+o.seg+"&"+Gx+i+"="+o.ts+"&"+Wx+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(Qx)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Rn()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{gt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var Jx=16384,Xx=45e3,nh=null;typeof MozWebSocket<"u"?nh=MozWebSocket:typeof WebSocket<"u"&&(nh=WebSocket);var ul=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Cl(this.connId),this.stats_=Cm(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[WI]=th,!Rn()&&typeof location<"u"&&location.hostname&&YI.test(location.hostname)&&(a[KI]=QI),r&&(a[HI]=r),i&&(a[JI]=i),s&&(a[Ng]=s),o&&(a[XI]=o),tb(t,ZI,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,bi.set("previous_websocket_failure",!0);try{let i;if(Rn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${th}/${vm}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new nh(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&nh!==null&&!n.forceDisallow_}static previouslyFailed(){return bi.isInMemoryStorage||bi.get("previous_websocket_failure")===!0}markConnectionHealthy(){bi.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=mu(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(j(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=nt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=zI(r,Jx);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Xx))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),Zx=(()=>{class n{static get ALL_TRANSPORTS(){return[Ug,ul]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=ul&&ul.isAvailable(),i=r&&!ul.previouslyFailed();if(t.webSocketOnly&&(r||jt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ul];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),ek=6e4,tk=5e3,nk=10*1024,rk=100*1024,Ig="t",fI="d",ik="s",pI="r",sk="e",gI="o",mI="a",_I="n",yI="p",ok="h",Bg=class{constructor(e,t,r,i,s,o,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Cl("c:"+this.id+":"),this.transportManager_=new Zx(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=pl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>rk?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>nk?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ig in e){let t=e[Ig];t===mI?this.upgradeIfSecondaryHealthy_():t===pI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===gI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=cl("t",e),r=cl("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:yI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:mI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:_I,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=cl("t",e),r=cl("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=cl(Ig,e);if(fI in e){let r=e[fI];if(t===ok){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===_I){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ik?this.onConnectionShutdown_(r):t===pI?this.onReset_(r):t===sk?xg("Server Error: "+r):t===gI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):xg("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),th!==r&&jt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),pl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ek))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):pl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(tk))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:yI,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(bi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var rh=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var ih=class{constructor(e){this.allowedEvents_=e,this.listeners_={},j(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){j(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var sh=class n extends ih{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Op()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return j(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var vI=32,wI=768,be=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ce(){return new be("")}function he(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function xr(n){return n.pieces_.length-n.pieceNum_}function Pe(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new be(n.pieces_,e)}function ab(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function ak(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function lb(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function cb(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new be(e,0)}function it(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof be)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new be(t,0)}function ue(n){return n.pieceNum_>=n.pieces_.length}function en(n,e){let t=he(n),r=he(e);if(t===null)return e;if(t===r)return en(Pe(n),Pe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ub(n,e){if(xr(n)!==xr(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function gn(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(xr(n)>xr(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var jg=class{constructor(e,t){this.errorPrefix_=t,this.parts_=lb(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Ua(this.parts_[r]);hb(this)}};function lk(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ua(e),hb(n)}function ck(n){let e=n.parts_.pop();n.byteLength_-=Ua(e),n.parts_.length>0&&(n.byteLength_-=1)}function hb(n){if(n.byteLength_>wI)throw new Error(n.errorPrefix_+"has a key path longer than "+wI+" bytes ("+n.byteLength_+").");if(n.parts_.length>vI)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+vI+") or object contains a cycle "+Ii(n))}function Ii(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var qg=class n extends ih{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return j(e==="visible","Unknown event type: "+e),[this.visible_]}};var hl=1e3,uk=60*5*1e3,CI=30*1e3,hk=1.3,dk=3e4,fk="server_kill",EI=3,Em=(()=>{class n extends rh{constructor(t,r,i,s,o,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Cl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=hl,this.maxReconnectDelay_=uk,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Rn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");qg.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&sh.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(nt(o)),j(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Ss,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),j(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Pn(t,"w")){let i=mi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();jt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||nE(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=CI)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=tE(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+nt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):xg("Unrecognized action received from server: "+nt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){j(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=hl,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=hl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>dk&&(this.reconnectDelay_=hl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*hk)}this.onConnectStatus_(!1)}establishConnection_(){return R(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(m){j(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(m)};this.realtime_={close:u,sendRequest:d};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[m,y]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);a?gt("getToken() completed but was canceled"):(gt("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=y&&y.token,c=new Bg(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,T=>{jt(T+" ("+this.repoInfo_.toString()+")"),this.interrupt(fk)},o))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&jt(m),u())}}})}interrupt(t){gt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){gt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Up(this.interruptReasons_)&&(this.reconnectDelay_=hl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>wm(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new be(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){gt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=EI&&(this.reconnectDelay_=CI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){gt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=EI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Rn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+vm.replace(/\./g,"-")]=1,Op()?t["framework.cordova"]=1:XC()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=sh.getInstance().currentlyOnline();return Up(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),de=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Hs=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new de(Ws,e),i=new de(Ws,t);return this.compare(r,i)!==0}minPost(){return de.MIN}};var eh,oh=class extends Hs{static get __EMPTY_NODE(){return eh}static set __EMPTY_NODE(e){eh=e}compare(e,t){return Zs(e.name,t.name)}isDefinedOn(e){throw As("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return de.MIN}maxPost(){return new de(Si,eh)}makePost(e,t){return j(typeof e=="string","KeyIndex indexValue must always be a string."),new de(e,eh)}toString(){return".key"}},Gs=new oh;var qs=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},pn=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??tn.EMPTY_NODE,this.right=o??tn.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return tn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return tn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),$g=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new pn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},tn=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,pn.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,pn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new qs(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new qs(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new qs(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new qs(this.root_,null,this.comparator_,!0,e)}};tn.EMPTY_NODE=new $g;function pk(n,e){return Zs(n.name,e.name)}function Im(n,e){return Zs(n,e)}var zg;function gk(n){zg=n}var db=function(n){return typeof n=="number"?"number:"+GI(n):"string:"+n},fb=function(n){if(n.isLeafNode()){let e=n.val();j(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Pn(e,".sv"),"Priority must be a string or number.")}else j(n===zg||n.isEmpty(),"priority of unexpected type.");j(n===zg||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var II,Ks=(()=>{class n{static set __childrenNodeConstructor(t){II=t}static get __childrenNodeConstructor(){return II}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,j(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),fb(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ue(t)?this:he(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=he(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(j(i!==".priority"||xr(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Pe(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+db(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=GI(this.value_):t+=this.value_,this.lazyHash_=qI(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(j(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return j(s>=0,"Unknown leaf type: "+r),j(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),pb,gb;function mk(n){pb=n}function _k(n){gb=n}var Gg=class extends Hs{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Zs(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return de.MIN}maxPost(){return new de(Si,new Ks("[PRIORITY-POST]",gb))}makePost(e,t){let r=pb(e);return new de(t,new Ks("[PRIORITY-POST]",r))}toString(){return".priority"}},_t=new Gg;var yk=Math.log(2),Wg=class{constructor(e){let t=s=>parseInt(Math.log(s)/yk,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ah=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,p,m;if(d===0)return null;if(d===1)return p=n[c],m=t?t(p):p,new pn(m,p.node,pn.BLACK,null,null);{let y=parseInt(d/2,10)+c,T=i(c,y),k=i(y+1,u);return p=n[y],m=t?t(p):p,new pn(m,p.node,pn.BLACK,T,k)}},s=function(c){let u=null,d=null,p=n.length,m=function(T,k){let x=p-T,W=p;p-=T;let K=i(x+1,W),F=n[x],X=t?t(F):F;y(new pn(X,F.node,k,null,K))},y=function(T){u?(u.left=T,u=T):(d=T,u=T)};for(let T=0;T<c.count;++T){let k=c.nextBitIsOne(),x=Math.pow(2,c.count-(T+1));k?m(x,pn.BLACK):(m(x,pn.BLACK),m(x,pn.RED))}return d},o=new Wg(n.length),a=s(o);return new tn(r||e,a)};var bg,js={},Qs=class n{static get Default(){return j(js&&_t,"ChildrenNode.ts has not been loaded"),bg=bg||new n({".priority":js},{".priority":_t}),bg}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=mi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof tn?t:null}hasIndex(e){return Pn(this.indexSet_,e.toString())}addIndex(e,t){j(e!==Gs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(de.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ah(r,e.getCompare()):a=js;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=Oa(this.indexes_,(i,s)=>{let o=mi(this.indexSet_,s);if(j(o,"Missing index implementation for "+s),i===js)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(de.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),ah(a,o.getCompare())}else return js;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new de(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Oa(this.indexes_,i=>{if(i===js)return i;{let s=t.get(e.name);return s?i.remove(new de(e.name,s)):i}});return new n(r,this.indexSet_)}};var dl,Oe=(()=>{class n{static get EMPTY_NODE(){return dl||(dl=new n(new tn(Im),null,Qs.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&fb(this.priorityNode_),this.children_.isEmpty()&&j(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||dl}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?dl:r}}getChild(t){let r=he(t);return r===null?this:this.getImmediateChild(r).getChild(Pe(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(j(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new de(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?dl:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=he(t);if(i===null)return r;{j(he(t)!==".priority"||xr(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Pe(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(_t,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+db(this.getPriority().val())+":"),this.forEachChild(_t,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":qI(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new de(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new de(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new de(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,de.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,de.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Il?-1:0}withIndex(t){if(t===Gs||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Gs||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(_t),s=r.getIterator(_t),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Gs?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),Hg=class extends Oe{constructor(){super(new tn(Im),Oe.EMPTY_NODE,Qs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Oe.EMPTY_NODE}isEmpty(){return!1}},Il=new Hg;Object.defineProperties(de,{MIN:{value:new de(Ws,Oe.EMPTY_NODE)},MAX:{value:new de(Si,Il)}});oh.__EMPTY_NODE=Oe.EMPTY_NODE;Ks.__childrenNodeConstructor=Oe;gk(Il);_k(Il);var vk=!0;function mt(n,e=null){if(n===null)return Oe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),j(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Ks(t,mt(e))}if(!(n instanceof Array)&&vk){let t=[],r=!1;if(nn(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=mt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new de(o,c)))}}),t.length===0)return Oe.EMPTY_NODE;let s=ah(t,pk,o=>o.name,Im);if(r){let o=ah(t,_t.getCompare());return new Oe(s,mt(e),new Qs({".priority":o},{".priority":_t}))}else return new Oe(s,mt(e),Qs.Default)}else{let t=Oe.EMPTY_NODE;return nn(n,(r,i)=>{if(Pn(n,r)&&r.substring(0,1)!=="."){let s=mt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(mt(e))}}mk(mt);var Kg=class extends Hs{constructor(e){super(),this.indexPath_=e,j(!ue(e)&&he(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Zs(e.name,t.name):s}makePost(e,t){let r=mt(e),i=Oe.EMPTY_NODE.updateChild(this.indexPath_,r);return new de(t,i)}maxPost(){let e=Oe.EMPTY_NODE.updateChild(this.indexPath_,Il);return new de(Si,e)}toString(){return lb(this.indexPath_,0).join("/")}};var Qg=class extends Hs{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Zs(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return de.MIN}maxPost(){return de.MAX}makePost(e,t){let r=mt(e);return new de(t,r)}toString(){return".value"}},wk=new Qg;function Ck(n){return{type:"value",snapshotNode:n}}function Ek(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Ik(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function bI(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function bk(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Yg=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=_t}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return j(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return j(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ws}hasEnd(){return this.endSet_}getIndexEndValue(){return j(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return j(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Si}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return j(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===_t}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function TI(n){let e={};if(n.isDefault())return e;let t;if(n.index_===_t?t="$priority":n.index_===wk?t="$value":n.index_===Gs?t="$key":(j(n.index_ instanceof Kg,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=nt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=nt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+nt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=nt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+nt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function AI(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==_t&&(e.i=n.index_.toString()),e}var Jg=class n extends rh{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(j(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Cl("p:rest:"),this.listens_={}}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=TI(e._queryParams);this.restRequest_(s+".json",c,(u,d)=>{let p=d;if(u===404&&(p=null,u=null),u===null&&this.onDataUpdate_(s,p,!1,r),mi(this.listens_,o)===a){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",i(m,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=TI(e._queryParams),r=e._path.toString(),i=new Ss;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+rE(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=mu(a.responseText)}catch{jt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&jt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Xg=class{constructor(){this.rootNode_=Oe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function lh(){return{value:null,children:new Map}}function mb(n,e,t){if(ue(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=he(e);n.children.has(r)||n.children.set(r,lh());let i=n.children.get(r);e=Pe(e),mb(i,e,t)}}function Zg(n,e,t){n.value!==null?t(e,n.value):Tk(n,(r,i)=>{let s=new be(e.toString()+"/"+r);Zg(i,s,t)})}function Tk(n,e){n.children.forEach((t,r)=>{e(r,t)})}var em=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&nn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var SI=10*1e3,Ak=30*1e3,Sk=5*60*1e3,tm=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new em(e);let r=SI+(Ak-SI)*Math.random();pl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;nn(e,(i,s)=>{s>0&&Pn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),pl(this.reportStats_.bind(this),Math.floor(Math.random()*2*Sk))}};var ir=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ir||{});function _b(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function yb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function vb(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var nm=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ir.ACK_USER_WRITE,this.source=_b()}operationForChild(e){if(ue(this.path)){if(this.affectedTree.value!=null)return j(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new be(e));return new n(Ce(),t,this.revert)}}else return j(he(this.path)===e,"operationForChild called for unrelated child."),new n(Pe(this.path),this.affectedTree,this.revert)}};var Ys=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ir.OVERWRITE}operationForChild(e){return ue(this.path)?new n(this.source,Ce(),this.snap.getImmediateChild(e)):new n(this.source,Pe(this.path),this.snap)}};var ch=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ir.MERGE}operationForChild(e){if(ue(this.path)){let t=this.children.subtree(new be(e));return t.isEmpty()?null:t.value?new Ys(this.source,Ce(),t.value):new n(this.source,Ce(),t)}else return j(he(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Pe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var _l=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ue(e))return this.isFullyInitialized()&&!this.filtered_;let t=he(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function Rk(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(bk(o.childName,o.snapshotNode))}),fl(n,i,"child_removed",e,r,t),fl(n,i,"child_added",e,r,t),fl(n,i,"child_moved",s,r,t),fl(n,i,"child_changed",e,r,t),fl(n,i,"value",e,r,t),i}function fl(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>Dk(n,a,c)),o.forEach(a=>{let c=Pk(n,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function Pk(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Dk(n,e,t){if(e.childName==null||t.childName==null)throw As("Should only compare child_ events.");let r=new de(e.childName,e.snapshotNode),i=new de(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function wb(n,e){return{eventCache:n,serverCache:e}}function gl(n,e,t,r){return wb(new _l(e,t,r),n.serverCache)}function Cb(n,e,t,r){return wb(n.eventCache,new _l(e,t,r))}function rm(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ri(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Tg,xk=()=>(Tg||(Tg=new tn(xx)),Tg),Dt=class n{static fromObject(e){let t=new n(null);return nn(e,(r,i)=>{t=t.set(new be(r),i)}),t}constructor(e,t=xk()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ce(),value:this.value};if(ue(e))return null;{let r=he(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Pe(e),t);return s!=null?{path:it(new be(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ue(e))return this;{let t=he(e),r=this.children.get(t);return r!==null?r.subtree(Pe(e)):new n(null)}}set(e,t){if(ue(e))return new n(t,this.children);{let r=he(e),s=(this.children.get(r)||new n(null)).set(Pe(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ue(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=he(e),r=this.children.get(t);if(r){let i=r.remove(Pe(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ue(e))return this.value;{let t=he(e),r=this.children.get(t);return r?r.get(Pe(e)):null}}setTree(e,t){if(ue(e))return t;{let r=he(e),s=(this.children.get(r)||new n(null)).setTree(Pe(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Ce(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(it(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ce(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ue(e))return null;{let s=he(e),o=this.children.get(s);return o?o.findOnPath_(Pe(e),it(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ce(),t)}foreachOnPath_(e,t,r){if(ue(e))return this;{this.value&&r(t,this.value);let i=he(e),s=this.children.get(i);return s?s.foreachOnPath_(Pe(e),it(t,i),r):new n(null)}}foreach(e){this.foreach_(Ce(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(it(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var mn=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Dt(null))}};function ml(n,e,t){if(ue(e))return new mn(new Dt(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=en(i,e);return s=s.updateChild(o,t),new mn(n.writeTree_.set(i,s))}else{let i=new Dt(t),s=n.writeTree_.setTree(e,i);return new mn(s)}}}function RI(n,e,t){let r=n;return nn(t,(i,s)=>{r=ml(r,it(e,i),s)}),r}function PI(n,e){if(ue(e))return mn.empty();{let t=n.writeTree_.setTree(e,new Dt(null));return new mn(t)}}function im(n,e){return Pi(n,e)!=null}function Pi(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(en(t.path,e)):null}function DI(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(_t,(r,i)=>{e.push(new de(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new de(r,i.value))}),e}function Dr(n,e){if(ue(e))return n;{let t=Pi(n,e);return t!=null?new mn(new Dt(t)):new mn(n.writeTree_.subtree(e))}}function sm(n){return n.writeTree_.isEmpty()}function Js(n,e){return Eb(Ce(),n.writeTree_,e)}function Eb(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(j(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=Eb(it(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(it(n,".priority"),r)),t}}function Ib(n,e){return Rb(e,n)}function kk(n,e,t,r,i){j(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ml(n.visibleWrites,e,t)),n.lastWriteId=r}function Mk(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function Nk(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);j(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&Fk(a,r.path)?i=!1:gn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return Ok(n),!0;if(r.snap)n.visibleWrites=PI(n.visibleWrites,r.path);else{let a=r.children;nn(a,c=>{n.visibleWrites=PI(n.visibleWrites,it(r.path,c))})}return!0}else return!1}function Fk(n,e){if(n.snap)return gn(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&gn(it(n.path,t),e))return!0;return!1}function Ok(n){n.visibleWrites=bb(n.allWrites,Vk,Ce()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Vk(n){return n.visible}function bb(n,e,t){let r=mn.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)gn(t,o)?(a=en(t,o),r=ml(r,a,s.snap)):gn(o,t)&&(a=en(o,t),r=ml(r,Ce(),s.snap.getChild(a)));else if(s.children){if(gn(t,o))a=en(t,o),r=RI(r,a,s.children);else if(gn(o,t))if(a=en(o,t),ue(a))r=RI(r,Ce(),s.children);else{let c=mi(s.children,he(a));if(c){let u=c.getChild(Pe(a));r=ml(r,Ce(),u)}}}else throw As("WriteRecord should have .snap or .children")}}return r}function Tb(n,e,t,r,i){if(!r&&!i){let s=Pi(n.visibleWrites,e);if(s!=null)return s;{let o=Dr(n.visibleWrites,e);if(sm(o))return t;if(t==null&&!im(o,Ce()))return null;{let a=t||Oe.EMPTY_NODE;return Js(o,a)}}}else{let s=Dr(n.visibleWrites,e);if(!i&&sm(s))return t;if(!i&&t==null&&!im(s,Ce()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(gn(u.path,e)||gn(e,u.path))},a=bb(n.allWrites,o,e),c=t||Oe.EMPTY_NODE;return Js(a,c)}}}function Uk(n,e,t){let r=Oe.EMPTY_NODE,i=Pi(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(_t,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Dr(n.visibleWrites,e);return t.forEachChild(_t,(o,a)=>{let c=Js(Dr(s,new be(o)),a);r=r.updateImmediateChild(o,c)}),DI(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Dr(n.visibleWrites,e);return DI(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function Lk(n,e,t,r,i){j(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=it(e,t);if(im(n.visibleWrites,s))return null;{let o=Dr(n.visibleWrites,s);return sm(o)?i.getChild(t):Js(o,i.getChild(t))}}function Bk(n,e,t,r){let i=it(e,t),s=Pi(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Dr(n.visibleWrites,i);return Js(o,r.getNode().getImmediateChild(t))}else return null}function jk(n,e){return Pi(n.visibleWrites,e)}function qk(n,e,t,r,i,s,o){let a,c=Dr(n.visibleWrites,e),u=Pi(c,Ce());if(u!=null)a=u;else if(t!=null)a=Js(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],p=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),y=m.getNext();for(;y&&d.length<i;)p(y,r)!==0&&d.push(y),y=m.getNext();return d}else return[]}function $k(){return{visibleWrites:mn.empty(),allWrites:[],lastWriteId:-1}}function om(n,e,t,r){return Tb(n.writeTree,n.treePath,e,t,r)}function Ab(n,e){return Uk(n.writeTree,n.treePath,e)}function xI(n,e,t,r){return Lk(n.writeTree,n.treePath,e,t,r)}function uh(n,e){return jk(n.writeTree,it(n.treePath,e))}function zk(n,e,t,r,i,s){return qk(n.writeTree,n.treePath,e,t,r,i,s)}function bm(n,e,t){return Bk(n.writeTree,n.treePath,e,t)}function Sb(n,e){return Rb(it(n.treePath,e),n.writeTree)}function Rb(n,e){return{treePath:n,writeTree:e}}var am=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;j(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),j(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,bI(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Ik(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Ek(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,bI(r,e.snapshotNode,i.oldSnap));else throw As("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var lm=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},Pb=new lm,yl=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new _l(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return bm(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ri(this.viewCache_),s=zk(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function Gk(n,e){j(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),j(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Wk(n,e,t,r,i){let s=new am,o,a;if(t.type===ir.OVERWRITE){let u=t;u.source.fromUser?o=cm(n,e,u.path,u.snap,r,i,s):(j(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ue(u.path),o=hh(n,e,u.path,u.snap,r,i,a,s))}else if(t.type===ir.MERGE){let u=t;u.source.fromUser?o=Kk(n,e,u.path,u.children,r,i,s):(j(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=um(n,e,u.path,u.children,r,i,a,s))}else if(t.type===ir.ACK_USER_WRITE){let u=t;u.revert?o=Jk(n,e,u.path,r,i,s):o=Qk(n,e,u.path,u.affectedTree,r,i,s)}else if(t.type===ir.LISTEN_COMPLETE)o=Yk(n,e,t.path,r,s);else throw As("Unknown operation type: "+t.type);let c=s.getChanges();return Hk(e,o,c),{viewCache:o,changes:c}}function Hk(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=rm(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(Ck(rm(e)))}}function Db(n,e,t,r,i,s){let o=e.eventCache;if(uh(r,t)!=null)return e;{let a,c;if(ue(t))if(j(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Ri(e),d=u instanceof Oe?u:Oe.EMPTY_NODE,p=Ab(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let u=om(r,Ri(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=he(t);if(u===".priority"){j(xr(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let p=xI(r,t,d,c);p!=null?a=n.filter.updatePriority(d,p):a=o.getNode()}else{let d=Pe(t),p;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let m=xI(r,t,o.getNode(),c);m!=null?p=o.getNode().getImmediateChild(u).updateChild(d,m):p=o.getNode().getImmediateChild(u)}else p=bm(r,u,e.serverCache);p!=null?a=n.filter.updateChild(o.getNode(),u,p,d,i,s):a=o.getNode()}}return gl(e,a,o.isFullyInitialized()||ue(t),n.filter.filtersNodes())}}function hh(n,e,t,r,i,s,o,a){let c=e.serverCache,u,d=o?n.filter:n.filter.getIndexedFilter();if(ue(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let y=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),y,null)}else{let y=he(t);if(!c.isCompleteForPath(t)&&xr(t)>1)return e;let T=Pe(t),x=c.getNode().getImmediateChild(y).updateChild(T,r);y===".priority"?u=d.updatePriority(c.getNode(),x):u=d.updateChild(c.getNode(),y,x,T,Pb,null)}let p=Cb(e,u,c.isFullyInitialized()||ue(t),d.filtersNodes()),m=new yl(i,p,s);return Db(n,p,t,i,m,a)}function cm(n,e,t,r,i,s,o){let a=e.eventCache,c,u,d=new yl(i,e,s);if(ue(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=gl(e,u,!0,n.filter.filtersNodes());else{let p=he(t);if(p===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=gl(e,u,a.isFullyInitialized(),a.isFiltered());else{let m=Pe(t),y=a.getNode().getImmediateChild(p),T;if(ue(m))T=r;else{let k=d.getCompleteChild(p);k!=null?ab(m)===".priority"&&k.getChild(cb(m)).isEmpty()?T=k:T=k.updateChild(m,r):T=Oe.EMPTY_NODE}if(y.equals(T))c=e;else{let k=n.filter.updateChild(a.getNode(),p,T,m,d,o);c=gl(e,k,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function kI(n,e){return n.eventCache.isCompleteForChild(e)}function Kk(n,e,t,r,i,s,o){let a=e;return r.foreach((c,u)=>{let d=it(t,c);kI(e,he(d))&&(a=cm(n,a,d,u,i,s,o))}),r.foreach((c,u)=>{let d=it(t,c);kI(e,he(d))||(a=cm(n,a,d,u,i,s,o))}),a}function MI(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function um(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ue(t)?u=r:u=new Dt(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((p,m)=>{if(d.hasChild(p)){let y=e.serverCache.getNode().getImmediateChild(p),T=MI(n,y,m);c=hh(n,c,new be(p),T,i,s,o,a)}}),u.children.inorderTraversal((p,m)=>{let y=!e.serverCache.isCompleteForChild(p)&&m.value===null;if(!d.hasChild(p)&&!y){let T=e.serverCache.getNode().getImmediateChild(p),k=MI(n,T,m);c=hh(n,c,new be(p),k,i,s,o,a)}}),c}function Qk(n,e,t,r,i,s,o){if(uh(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ue(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return hh(n,e,t,c.getNode().getChild(t),i,s,a,o);if(ue(t)){let u=new Dt(null);return c.getNode().forEachChild(Gs,(d,p)=>{u=u.set(new be(d),p)}),um(n,e,t,u,i,s,a,o)}else return e}else{let u=new Dt(null);return r.foreach((d,p)=>{let m=it(t,d);c.isCompleteForPath(m)&&(u=u.set(d,c.getNode().getChild(m)))}),um(n,e,t,u,i,s,a,o)}}function Yk(n,e,t,r,i){let s=e.serverCache,o=Cb(e,s.getNode(),s.isFullyInitialized()||ue(t),s.isFiltered());return Db(n,o,t,r,Pb,i)}function Jk(n,e,t,r,i,s){let o;if(uh(r,t)!=null)return e;{let a=new yl(r,e,i),c=e.eventCache.getNode(),u;if(ue(t)||he(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=om(r,Ri(e));else{let p=e.serverCache.getNode();j(p instanceof Oe,"serverChildren would be complete if leaf node"),d=Ab(r,p)}d=d,u=n.filter.updateFullNode(c,d,s)}else{let d=he(t),p=bm(r,d,e.serverCache);p==null&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),p!=null?u=n.filter.updateChild(c,d,p,Pe(t),a,s):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,Oe.EMPTY_NODE,Pe(t),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=om(r,Ri(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||uh(r,Ce())!=null,gl(e,u,o,n.filter.filtersNodes())}}function Xk(n,e){let t=Ri(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ue(e)&&!t.getImmediateChild(he(e)).isEmpty())?t.getChild(e):null}function NI(n,e,t,r){e.type===ir.MERGE&&e.source.queryId!==null&&(j(Ri(n.viewCache_),"We should always have a full cache before handling merges"),j(rm(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=Wk(n.processor_,i,e,t,r);return Gk(n.processor_,s.viewCache),j(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Zk(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Zk(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return Rk(n.eventGenerator_,e,t,i)}var FI;function eM(n){j(!FI,"__referenceConstructor has already been defined"),FI=n}function Tm(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return j(s!=null,"SyncTree gave us an op for an invalid query."),NI(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(NI(o,e,t,r));return s}}function Am(n,e){let t=null;for(let r of n.views.values())t=t||Xk(r,e);return t}var OI;function tM(n){j(!OI,"__referenceConstructor has already been defined"),OI=n}var dh=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Dt(null),this.pendingWriteTree_=$k(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function nM(n,e,t,r,i){return kk(n.pendingWriteTree_,e,t,r,i),i?ph(n,new Ys(_b(),e,t)):[]}function $s(n,e,t=!1){let r=Mk(n.pendingWriteTree_,e);if(Nk(n.pendingWriteTree_,e)){let s=new Dt(null);return r.snap!=null?s=s.set(Ce(),!0):nn(r.children,o=>{s=s.set(new be(o),!0)}),ph(n,new nm(r.path,s,t))}else return[]}function fh(n,e,t){return ph(n,new Ys(yb(),e,t))}function rM(n,e,t){let r=Dt.fromObject(t);return ph(n,new ch(yb(),e,r))}function iM(n,e,t,r){let i=Nb(n,r);if(i!=null){let s=Fb(i),o=s.path,a=s.queryId,c=en(o,e),u=new Ys(vb(a),c,t);return Ob(n,o,u)}else return[]}function sM(n,e,t,r){let i=Nb(n,r);if(i){let s=Fb(i),o=s.path,a=s.queryId,c=en(o,e),u=Dt.fromObject(t),d=new ch(vb(a),c,u);return Ob(n,o,d)}else return[]}function xb(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=en(o,e),u=Am(a,c);if(u)return u});return Tb(i,e,s,t,!0)}function ph(n,e){return kb(e,n.syncPointTree_,null,Ib(n.pendingWriteTree_,Ce()))}function kb(n,e,t,r){if(ue(n.path))return Mb(n,e,t,r);{let i=e.get(Ce());t==null&&i!=null&&(t=Am(i,Ce()));let s=[],o=he(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let u=t?t.getImmediateChild(o):null,d=Sb(r,o);s=s.concat(kb(a,c,u,d))}return i&&(s=s.concat(Tm(i,n,r,t))),s}}function Mb(n,e,t,r){let i=e.get(Ce());t==null&&i!=null&&(t=Am(i,Ce()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,u=Sb(r,o),d=n.operationForChild(o);d&&(s=s.concat(Mb(d,a,c,u)))}),i&&(s=s.concat(Tm(i,n,r,t))),s}function Nb(n,e){return n.tagToQueryMap.get(e)}function Fb(n){let e=n.indexOf("$");return j(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new be(n.substr(0,e))}}function Ob(n,e,t){let r=n.syncPointTree_.get(e);j(r,"Missing sync point for query tag that we're tracking");let i=Ib(n.pendingWriteTree_,e);return Tm(r,t,i,null)}var hm=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},dm=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=it(this.path_,e);return new n(this.syncTree_,t)}node(){return xb(this.syncTree_,this.path_)}},oM=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},VI=function(n,e,t){if(!n||typeof n!="object")return n;if(j(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return aM(n[".sv"],e,t);if(typeof n[".sv"]=="object")return lM(n[".sv"],e);j(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},aM=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:j(!1,"Unexpected server value: "+n)}},lM=function(n,e,t){n.hasOwnProperty("increment")||j(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&j(!1,"Unexpected increment value: "+r);let i=e.node();if(j(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},cM=function(n,e,t,r){return Sm(e,new dm(t,n),r)},uM=function(n,e,t){return Sm(n,new hm(e),t)};function Sm(n,e,t){let r=n.getPriority().val(),i=VI(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=VI(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Ks(a,mt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Ks(i))),o.forEachChild(_t,(a,c)=>{let u=Sm(c,e.getImmediateChild(a),t);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var vl=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Rm(n,e){let t=e instanceof be?e:new be(e),r=n,i=he(t);for(;i!==null;){let s=mi(r.node.children,i)||{children:{},childCount:0};r=new vl(i,r,s),t=Pe(t),i=he(t)}return r}function eo(n){return n.node.value}function Vb(n,e){n.node.value=e,fm(n)}function Ub(n){return n.node.childCount>0}function hM(n){return eo(n)===void 0&&!Ub(n)}function gh(n,e){nn(n.node.children,(t,r)=>{e(new vl(t,n,r))})}function Lb(n,e,t,r){t&&!r&&e(n),gh(n,i=>{Lb(i,e,!0,r)}),t&&r&&e(n)}function dM(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function bl(n){return new be(n.parent===null?n.name:bl(n.parent)+"/"+n.name)}function fm(n){n.parent!==null&&fM(n.parent,n.name,n)}function fM(n,e,t){let r=hM(t),i=Pn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,fm(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,fm(n))}var pM=/[\[\].#$\/\u0000-\u001F\u007F]/,gM=/[\[\].#$\u0000-\u001F\u007F]/,Ag=10*1024*1024,Bb=function(n){return typeof n=="string"&&n.length!==0&&!pM.test(n)},mM=function(n){return typeof n=="string"&&n.length!==0&&!gM.test(n)},_M=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),mM(n)};var jb=function(n,e,t){let r=t instanceof be?new jg(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ii(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ii(r)+" with contents = "+e.toString());if($I(e))throw new Error(n+"contains "+e.toString()+" "+Ii(r));if(typeof e=="string"&&e.length>Ag/3&&Ua(e)>Ag)throw new Error(n+"contains a string greater than "+Ag+" utf8 bytes "+Ii(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(nn(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Bb(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ii(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);lk(r,o),jb(n,a,r),ck(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ii(r)+" in addition to actual children.")}};var yM=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Bb(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!_M(t))throw new Error(sE(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var pm=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function vM(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!ub(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function Di(n,e,t){vM(n,t),wM(n,r=>gn(r,e)||gn(e,r))}function wM(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(CM(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function CM(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Ti&&gt("event: "+t.toString()),El(r)}}}var EM="repo_interrupt",IM=25,gm=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new pm,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=lh(),this.transactionQueueTree_=new vl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function bM(n,e,t){if(n.stats_=Cm(n.repoInfo_),n.forceRestClient_||Vx())n.server_=new Jg(n.repoInfo_,(r,i,s,o)=>{UI(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>LI(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{nt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Em(n.repoInfo_,e,(r,i,s,o)=>{UI(n,r,i,s,o)},r=>{LI(n,r)},r=>{AM(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=Lx(n.repoInfo_,()=>new tm(n.stats_,n.server_)),n.infoData_=new Xg,n.infoSyncTree_=new dh({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=fh(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Pm(n,"connected",!1),n.serverSyncTree_=new dh({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);Di(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function TM(n){let t=n.infoData_.getNode(new be(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function qb(n){return oM({timestamp:TM(n)})}function UI(n,e,t,r,i){n.dataUpdateCount++;let s=new be(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Oa(t,u=>mt(u));o=sM(n.serverSyncTree_,s,c,i)}else{let c=mt(t);o=iM(n.serverSyncTree_,s,c,i)}else if(r){let c=Oa(t,u=>mt(u));o=rM(n.serverSyncTree_,s,c)}else{let c=mt(t);o=fh(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=xm(n,s)),Di(n.eventQueue_,a,o)}function LI(n,e){Pm(n,"connected",e),e===!1&&RM(n)}function AM(n,e){nn(e,(t,r)=>{Pm(n,t,r)})}function Pm(n,e,t){let r=new be("/.info/"+e),i=mt(t);n.infoData_.updateSnapshot(r,i);let s=fh(n.infoSyncTree_,r,i);Di(n.eventQueue_,r,s)}function SM(n){return n.nextWriteId_++}function RM(n){$b(n,"onDisconnectEvents");let e=qb(n),t=lh();Zg(n.onDisconnect_,Ce(),(i,s)=>{let o=cM(i,s,n.serverSyncTree_,e);mb(t,i,o)});let r=[];Zg(t,Ce(),(i,s)=>{r=r.concat(fh(n.serverSyncTree_,i,s));let o=kM(n,i);xm(n,o)}),n.onDisconnect_=lh(),Di(n.eventQueue_,Ce(),r)}function PM(n){n.persistentConnection_&&n.persistentConnection_.interrupt(EM)}function $b(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),gt(t,...e)}function zb(n,e,t){return xb(n.serverSyncTree_,e,t)||Oe.EMPTY_NODE}function Dm(n,e=n.transactionQueueTree_){if(e||mh(n,e),eo(e)){let t=Wb(n,e);j(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&DM(n,bl(e),t)}else Ub(e)&&gh(e,t=>{Dm(n,t)})}function DM(n,e,t){let r=t.map(u=>u.currentWriteId),i=zb(n,e,r),s=i,o=i.hash();for(let u=0;u<t.length;u++){let d=t[u];j(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let p=en(e,d.path);s=s.updateChild(p,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,u=>{$b(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let p=[];for(let m=0;m<t.length;m++)t[m].status=2,d=d.concat($s(n.serverSyncTree_,t[m].currentWriteId)),t[m].onComplete&&p.push(()=>t[m].onComplete(null,!0,t[m].currentOutputSnapshotResolved)),t[m].unwatcher();mh(n,Rm(n.transactionQueueTree_,e)),Dm(n,n.transactionQueueTree_),Di(n.eventQueue_,e,d);for(let m=0;m<p.length;m++)El(p[m])}else{if(u==="datastale")for(let p=0;p<t.length;p++)t[p].status===3?t[p].status=4:t[p].status=0;else{jt("transaction at "+c.toString()+" failed: "+u);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=u}xm(n,e)}},o)}function xm(n,e){let t=Gb(n,e),r=bl(t),i=Wb(n,t);return xM(n,i,r),r}function xM(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=en(t,c.path),d=!1,p;if(j(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,p=c.abortReason,i=i.concat($s(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=IM)d=!0,p="maxretry",i=i.concat($s(n.serverSyncTree_,c.currentWriteId,!0));else{let m=zb(n,c.path,o);c.currentInputSnapshot=m;let y=e[a].update(m.val());if(y!==void 0){jb("transaction failed: Data returned ",y,c.path);let T=mt(y);typeof y=="object"&&y!=null&&Pn(y,".priority")||(T=T.updatePriority(m.getPriority()));let x=c.currentWriteId,W=qb(n),K=uM(T,m,W);c.currentOutputSnapshotRaw=T,c.currentOutputSnapshotResolved=K,c.currentWriteId=SM(n),o.splice(o.indexOf(x),1),i=i.concat(nM(n.serverSyncTree_,c.path,K,c.currentWriteId,c.applyLocally)),i=i.concat($s(n.serverSyncTree_,x,!0))}else d=!0,p="nodata",i=i.concat($s(n.serverSyncTree_,c.currentWriteId,!0))}Di(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(p==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(p),!1,null))))}mh(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)El(r[a]);Dm(n,n.transactionQueueTree_)}function Gb(n,e){let t,r=n.transactionQueueTree_;for(t=he(e);t!==null&&eo(r)===void 0;)r=Rm(r,t),e=Pe(e),t=he(e);return r}function Wb(n,e){let t=[];return Hb(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Hb(n,e,t){let r=eo(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);gh(e,i=>{Hb(n,i,t)})}function mh(n,e){let t=eo(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,Vb(e,t.length>0?t:void 0)}gh(e,r=>{mh(n,r)})}function kM(n,e){let t=bl(Gb(n,e)),r=Rm(n.transactionQueueTree_,e);return dM(r,i=>{Sg(n,i)}),Sg(n,r),Lb(r,i=>{Sg(n,i)}),t}function Sg(n,e){let t=eo(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(j(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(j(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat($s(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Vb(e,void 0):t.length=s+1,Di(n.eventQueue_,bl(e),i);for(let o=0;o<r.length;o++)El(r[o])}}function MM(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function NM(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):jt(`Invalid query segment '${t}' in query '${n}'`)}return e}var BI=function(n,e){let t=FM(n),r=t.namespace;t.domain==="firebase.com"&&Ai(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ai("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Px();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Fg(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new be(t.pathString)}},FM=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let p=n.indexOf("?");p===-1&&(p=n.length),e=n.substring(0,Math.min(d,p)),d<p&&(i=MM(n.substring(d,p)));let m=NM(n.substring(Math.min(n.length,p)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let y=e.slice(0,u);if(y.toLowerCase()==="localhost")t="localhost";else if(y.split(".").length<=2)t=y;else{let T=e.indexOf(".");r=e.substring(0,T).toLowerCase(),t=e.substring(T+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var mm=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ue(this._path)?null:ab(this._path)}get ref(){return new Xs(this._repo,this._path)}get _queryIdentifier(){let e=AI(this._queryParams),t=wm(e);return t==="{}"?"default":t}get _queryObject(){return AI(this._queryParams)}isEqual(e){if(e=Re(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=ub(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+ak(this._path)}};var Xs=class n extends mm{constructor(e,t){super(e,t,new Yg,!1)}get parent(){let e=cb(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};eM(Xs);tM(Xs);var OM="FIREBASE_DATABASE_EMULATOR_HOST",_m={},VM=!1;function UM(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Ai("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),gt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=BI(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[OM]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=BI(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new hI(hI.OWNER):new Mg(n.name,n.options,e);yM("Invalid Firebase Database URL",o),ue(o.path)||Ai("Database URL must point to the root of a Firebase Database (not including a child path).");let p=BM(a,n,d,new kg(n,t));return new ym(p,n)}function LM(n,e){let t=_m[e];(!t||t[n.key]!==n)&&Ai(`Database ${e}(${n.repoInfo_}) has already been deleted.`),PM(n),delete t[n.key]}function BM(n,e,t,r){let i=_m[e.name];i||(i={},_m[e.name]=i);let s=i[n.toURLString()];return s&&Ai("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new gm(n,VM,t,r),i[n.toURLString()]=s,s}var ym=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(bM(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Xs(this._repo,Ce())),this._rootInternal}_delete(){return this._rootInternal!==null&&(LM(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ai("Cannot call "+e+" on a deleted database.")}};function jM(n){Ax(vu),_i(new tr("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return UM(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Ze(aI,lI,n),Ze(aI,lI,"esm2017")}Em.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Em.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};jM();var qM="firebase",$M="11.6.1";Ze(qM,$M,"app");function at(n){n===void 0&&(_C(at),n=Q(Qt));let e=n.get(iu);return t=>new Wt(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let a=t.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return a.add(()=>{r.unsubscribe(),o()}),a})}var _n=new kp("ANGULARFIRE2_VERSION");function Tl(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var no=(n,e)=>{let t=e?[e]:wu(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},to=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(to||{}),Kb=Is()&&typeof Zone<"u"?to.WARN:to.SILENT;var _h=class{zone;delegate;constructor(e,t=sC){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},rn=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=Q(xe);this.outsideAngular=t.runOutsideAngular(()=>new _h(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new _h(typeof Zone>"u"?void 0:Zone.current,Zc))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qb=!1;function zM(n,e){!Qb&&(Kb>to.SILENT||Is())&&(Qb=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Kb>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function GM(n){let e=Q(xe,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function xi(n){let e=Q(xe,{optional:!0});return e?e.run(()=>n()):n()}var WM=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Vt(t,()=>xi(()=>n.apply(void 0,r)))),qt=(n,e,t)=>(t||=e?to.WARN:to.VERBOSE,function(){let r,i=arguments,s,o,a;try{s=Q(rn),o=Q(iu),a=Q(Ot)}catch{return zM(n,t),n.apply(this,i)}for(let u=0;u<arguments.length;u++)typeof i[u]=="function"&&(e&&(r||=xi(()=>o.add())),i[u]=WM(i[u],r,a));let c=GM(()=>n.apply(this,i));return e?c instanceof Wt?c.pipe(ui(s.outsideAngular),Er(s.insideAngular),at(a)):c instanceof Promise?xi(()=>new Promise((u,d)=>{o.run(()=>c).then(p=>Vt(a,()=>xi(()=>u(p))),p=>Vt(a,()=>xi(()=>d(p))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:xi(()=>c):c instanceof Wt?c.pipe(ui(s.outsideAngular),Er(s.insideAngular)):xi(()=>c)});var sr=class{constructor(e){return e}},ki=class{constructor(){return wu()}};function HM(n){return n&&n.length===1?n[0]:new sr(Ps())}var km=new ne("angularfire2._apps"),KM={provide:sr,useFactory:HM,deps:[[new Rt,km]]},QM={provide:ki,deps:[[new Rt,km]]};function YM(n){return(e,t)=>{let r=t.get(Ut);Ze("angularfire",_n.full,"core"),Ze("angularfire",_n.full,"app"),Ze("angular",hu.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new sr(i)}}function Jb(n,...e){return Ir([KM,QM,{provide:km,useFactory:YM(n),multi:!0,deps:[xe,Qt,rn,...e]}])}var Xb=qt(aE,!0);var JM=new Map,XM={activated:!1,tokenObservers:[]},ZM={initialized:!1,enabled:!1};function yn(n){return JM.get(n)||Object.assign({},XM)}function nT(){return ZM}var eN="https://content-firebaseappcheck.googleapis.com/v1";var tN="exchangeDebugToken",Zb={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},kB=24*60*60*1e3;var Fm=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return R(this,null,function*(){this.stop();try{this.pending=new Ss,this.pending.promise.catch(t=>{}),yield nN(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Ss,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function nN(n){return new Promise(e=>{setTimeout(e,n)})}var rN={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},kr=new eE("appCheck","AppCheck",rN);function rT(n){if(!yn(n).activated)throw kr.create("use-before-activation",{appName:n.name})}function iT(r,i){return R(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let y=yield o.getHeartbeatsHeader();y&&(s["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(y){throw kr.create("fetch-network-error",{originalErrorMessage:y?.message})}if(c.status!==200)throw kr.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(y){throw kr.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=u.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw kr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let p=Number(d[1])*1e3,m=Date.now();return{token:u.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function sT(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${eN}/projects/${t}/apps/${r}:${tN}?key=${i}`,body:{debug_token:e}}}var iN="firebase-app-check-database",sN=1,Om="firebase-app-check-store";var yh=null;function oN(){return yh||(yh=new Promise((n,e)=>{try{let t=indexedDB.open(iN,sN);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(kr.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Om,{keyPath:"compositeKey"})}}}catch(t){e(kr.create("storage-open",{originalErrorMessage:t?.message}))}}),yh)}function aN(n,e){return lN(cN(n),e)}function lN(n,e){return R(this,null,function*(){let r=(yield oN()).transaction(Om,"readwrite"),s=r.objectStore(Om).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(kr.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function cN(n){return`${n.options.appId}-${n.name}`}var Al=new Rs("@firebase/app-check");function Mm(n,e){return gu()?aN(n,e).catch(t=>{Al.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function oT(){return nT().enabled}function aT(){return R(this,null,function*(){let n=nT();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var uN={error:"UNKNOWN_ERROR"};function hN(n){return pu.encodeString(JSON.stringify(n),!1)}function Vm(n,e=!1,t=!1){return R(this,null,function*(){let r=n.app;rT(r);let i=yn(r),s=i.token,o;if(s&&!Sl(s)&&(i.token=void 0,s=void 0),!s){let u=yield i.cachedTokenPromise;u&&(Sl(u)?s=u:yield Mm(r,void 0))}if(!e&&s&&Sl(s))return{token:s.token};let a=!1;if(oT())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=iT(sT(r,yield aT()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let u=yield i.exchangeTokenPromise;return yield Mm(r,u),i.token=u,{token:u.token}}catch(u){return u.code==="appCheck/throttled"||u.code==="appCheck/initial-throttle"?Al.warn(u.message):t&&Al.error(u),Nm(u)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),s=yield yn(r).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"||u.code==="appCheck/initial-throttle"?Al.warn(u.message):t&&Al.error(u),o=u}let c;return s?o?Sl(s)?c={token:s.token,internalError:o}:c=Nm(o):(c={token:s.token},i.token=s,yield Mm(r,s)):c=Nm(o),a&&gN(r,c),c})}function dN(n){return R(this,null,function*(){let e=n.app;rT(e);let{provider:t}=yn(e);if(oT()){let r=yield aT(),{token:i}=yield iT(sT(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function fN(n,e,t,r){let{app:i}=n,s=yn(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Sl(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),eT(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>eT(n))}function lT(n,e){let t=yn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function eT(n){let{app:e}=n,t=yn(e),r=t.tokenRefresher;r||(r=pN(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function pN(n){let{app:e}=n;return new Fm(()=>R(this,null,function*(){let t=yn(e),r;if(t.token?r=yield Vm(n,!0):r=yield Vm(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=yn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Zb.RETRIAL_MIN_WAIT,Zb.RETRIAL_MAX_WAIT)}function gN(n,e){let t=yn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Sl(n){return n.expireTimeMillis-Date.now()>0}function Nm(n){return{token:hN(uN),error:n}}var Um=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=yn(this.app);for(let t of e)lT(this.app,t.next);return Promise.resolve()}};function mN(n,e){return new Um(n,e)}function _N(n){return{getToken:e=>Vm(n,e),getLimitedUseToken:()=>dN(n),addTokenListener:e=>fN(n,"INTERNAL",e),removeTokenListener:e=>lT(n.app,e)}}var yN="@firebase/app-check",vN="0.8.13";var wN="app-check",tT="app-check-internal";function CN(){_i(new tr(wN,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return mN(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(tT).initialize()})),_i(new tr(tT,n=>{let e=n.getProvider("app-check").getImmediate();return _N(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ze(yN,vN)}CN();var EN="app-check";var Nn=class{constructor(){return no(EN)}};var IN=["localhost","0.0.0.0","127.0.0.1"],GB=typeof window<"u"&&IN.includes(window.location.hostname);var bN=["ngOnDestroy"],hT=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(bN.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>t.run(()=>u)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(d=>{let p=d?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,p),p})})})});var vh=class{constructor(e){return e}},ro=new ne("angularfire2.app.options"),io=new ne("angularfire2.app.name");function Rl(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=bt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>bt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;TN("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new vh(o)}var TN=(n,...e)=>{Is()&&typeof console<"u"&&console[n](...e)},AN={provide:vh,useFactory:Rl,deps:[ro,xe,[new Rt,io]]},dT=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:ro,useValue:t},{provide:io,useValue:r}]}}constructor(t){bt.registerVersion("angularfire",_n.full,"core"),bt.registerVersion("angularfire",_n.full,"app-compat"),bt.registerVersion("angular",hu.full,t.toString())}static \u0275fac=function(r){return new(r||n)(z(Ut))};static \u0275mod=hn({type:n});static \u0275inj=un({providers:[AN]})}return n})();function wh(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return SN(i,o)||(uT("error",`${e} was already initialized on the ${t} Firebase App with different settings.${RN?" You may need to reload as Firebase is not HMR aware.":""}`),uT("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function SN(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var RN=typeof module<"u"&&!!module.hot,uT=(n,...e)=>{Is()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Lm=new ne("angularfire2.auth.use-emulator"),Bm=new ne("angularfire2.auth.settings"),jm=new ne("angularfire2.auth.tenant-id"),qm=new ne("angularfire2.auth.langugage-code"),$m=new ne("angularfire2.auth.use-device-language"),zm=new ne("angularfire.auth.persistence"),Gm=(n,e,t,r,i,s,o,a)=>wh(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,d]of Object.entries(o))c.settings[u]=d;return a&&c.setPersistence(a),c},[t,r,i,s,o,a]),fT=(()=>{class n{injector=Q(Ot);authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,c,u,d,p,m,y){let T=new Ft,k=J(void 0).pipe(Er(o.outsideAngular),Xe(()=>s.runOutsideAngular(()=>import("./chunk-J4XM6XRA.js"))),te(()=>Rl(t,s,r)),te(x=>Gm(x,s,a,u,d,p,c,m)),Cp({bufferSize:1,refCount:!1}));if(gi(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=J(null);else{k.pipe(An()).subscribe();let x=k.pipe(Xe(F=>F.getRedirectResult().then(X=>X,()=>null)),at(this.injector),Cp({bufferSize:1,refCount:!1})),W=k.pipe(Xe(F=>new Wt(X=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(re=>X.next(re),re=>X.error(re),()=>X.complete()))})))),K=k.pipe(Xe(F=>new Wt(X=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(re=>X.next(re),re=>X.error(re),()=>X.complete()))}))));this.authState=x.pipe(Ep(W),ui(o.outsideAngular),Er(o.insideAngular)),this.user=x.pipe(Ep(K),ui(o.outsideAngular),Er(o.insideAngular)),this.idToken=this.user.pipe(Xe(F=>F?Fe(F.getIdToken()):J(null))),this.idTokenResult=this.user.pipe(Xe(F=>F?Fe(F.getIdTokenResult()):J(null))),this.credential=uC(x,T,this.authState.pipe(cn(F=>!F))).pipe(te(F=>F?.user?F:null),ui(o.outsideAngular),Er(o.insideAngular))}return hT(this,k,s,{spy:{apply:(x,W,K)=>{(x.startsWith("signIn")||x.startsWith("createUser"))&&K.then(F=>T.next(F))}}})}static \u0275fac=function(r){return new(r||n)(z(ro),z(io,8),z(Ut),z(xe),z(rn),z(Lm,8),z(Bm,8),z(jm,8),z(qm,8),z($m,8),z(zm,8),z(Nn,8))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var pT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gT={};var or,Wm;(function(){var n;function e(C,_){function w(){}w.prototype=_.prototype,C.D=_.prototype,C.prototype=new w,C.prototype.constructor=C,C.C=function(E,I,A){for(var v=Array(arguments.length-2),Wn=2;Wn<arguments.length;Wn++)v[Wn-2]=arguments[Wn];return _.prototype[I].apply(E,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,_,w){w||(w=0);var E=Array(16);if(typeof _=="string")for(var I=0;16>I;++I)E[I]=_.charCodeAt(w++)|_.charCodeAt(w++)<<8|_.charCodeAt(w++)<<16|_.charCodeAt(w++)<<24;else for(I=0;16>I;++I)E[I]=_[w++]|_[w++]<<8|_[w++]<<16|_[w++]<<24;_=C.g[0],w=C.g[1],I=C.g[2];var A=C.g[3],v=_+(A^w&(I^A))+E[0]+3614090360&4294967295;_=w+(v<<7&4294967295|v>>>25),v=A+(I^_&(w^I))+E[1]+3905402710&4294967295,A=_+(v<<12&4294967295|v>>>20),v=I+(w^A&(_^w))+E[2]+606105819&4294967295,I=A+(v<<17&4294967295|v>>>15),v=w+(_^I&(A^_))+E[3]+3250441966&4294967295,w=I+(v<<22&4294967295|v>>>10),v=_+(A^w&(I^A))+E[4]+4118548399&4294967295,_=w+(v<<7&4294967295|v>>>25),v=A+(I^_&(w^I))+E[5]+1200080426&4294967295,A=_+(v<<12&4294967295|v>>>20),v=I+(w^A&(_^w))+E[6]+2821735955&4294967295,I=A+(v<<17&4294967295|v>>>15),v=w+(_^I&(A^_))+E[7]+4249261313&4294967295,w=I+(v<<22&4294967295|v>>>10),v=_+(A^w&(I^A))+E[8]+1770035416&4294967295,_=w+(v<<7&4294967295|v>>>25),v=A+(I^_&(w^I))+E[9]+2336552879&4294967295,A=_+(v<<12&4294967295|v>>>20),v=I+(w^A&(_^w))+E[10]+4294925233&4294967295,I=A+(v<<17&4294967295|v>>>15),v=w+(_^I&(A^_))+E[11]+2304563134&4294967295,w=I+(v<<22&4294967295|v>>>10),v=_+(A^w&(I^A))+E[12]+1804603682&4294967295,_=w+(v<<7&4294967295|v>>>25),v=A+(I^_&(w^I))+E[13]+4254626195&4294967295,A=_+(v<<12&4294967295|v>>>20),v=I+(w^A&(_^w))+E[14]+2792965006&4294967295,I=A+(v<<17&4294967295|v>>>15),v=w+(_^I&(A^_))+E[15]+1236535329&4294967295,w=I+(v<<22&4294967295|v>>>10),v=_+(I^A&(w^I))+E[1]+4129170786&4294967295,_=w+(v<<5&4294967295|v>>>27),v=A+(w^I&(_^w))+E[6]+3225465664&4294967295,A=_+(v<<9&4294967295|v>>>23),v=I+(_^w&(A^_))+E[11]+643717713&4294967295,I=A+(v<<14&4294967295|v>>>18),v=w+(A^_&(I^A))+E[0]+3921069994&4294967295,w=I+(v<<20&4294967295|v>>>12),v=_+(I^A&(w^I))+E[5]+3593408605&4294967295,_=w+(v<<5&4294967295|v>>>27),v=A+(w^I&(_^w))+E[10]+38016083&4294967295,A=_+(v<<9&4294967295|v>>>23),v=I+(_^w&(A^_))+E[15]+3634488961&4294967295,I=A+(v<<14&4294967295|v>>>18),v=w+(A^_&(I^A))+E[4]+3889429448&4294967295,w=I+(v<<20&4294967295|v>>>12),v=_+(I^A&(w^I))+E[9]+568446438&4294967295,_=w+(v<<5&4294967295|v>>>27),v=A+(w^I&(_^w))+E[14]+3275163606&4294967295,A=_+(v<<9&4294967295|v>>>23),v=I+(_^w&(A^_))+E[3]+4107603335&4294967295,I=A+(v<<14&4294967295|v>>>18),v=w+(A^_&(I^A))+E[8]+1163531501&4294967295,w=I+(v<<20&4294967295|v>>>12),v=_+(I^A&(w^I))+E[13]+2850285829&4294967295,_=w+(v<<5&4294967295|v>>>27),v=A+(w^I&(_^w))+E[2]+4243563512&4294967295,A=_+(v<<9&4294967295|v>>>23),v=I+(_^w&(A^_))+E[7]+1735328473&4294967295,I=A+(v<<14&4294967295|v>>>18),v=w+(A^_&(I^A))+E[12]+2368359562&4294967295,w=I+(v<<20&4294967295|v>>>12),v=_+(w^I^A)+E[5]+4294588738&4294967295,_=w+(v<<4&4294967295|v>>>28),v=A+(_^w^I)+E[8]+2272392833&4294967295,A=_+(v<<11&4294967295|v>>>21),v=I+(A^_^w)+E[11]+1839030562&4294967295,I=A+(v<<16&4294967295|v>>>16),v=w+(I^A^_)+E[14]+4259657740&4294967295,w=I+(v<<23&4294967295|v>>>9),v=_+(w^I^A)+E[1]+2763975236&4294967295,_=w+(v<<4&4294967295|v>>>28),v=A+(_^w^I)+E[4]+1272893353&4294967295,A=_+(v<<11&4294967295|v>>>21),v=I+(A^_^w)+E[7]+4139469664&4294967295,I=A+(v<<16&4294967295|v>>>16),v=w+(I^A^_)+E[10]+3200236656&4294967295,w=I+(v<<23&4294967295|v>>>9),v=_+(w^I^A)+E[13]+681279174&4294967295,_=w+(v<<4&4294967295|v>>>28),v=A+(_^w^I)+E[0]+3936430074&4294967295,A=_+(v<<11&4294967295|v>>>21),v=I+(A^_^w)+E[3]+3572445317&4294967295,I=A+(v<<16&4294967295|v>>>16),v=w+(I^A^_)+E[6]+76029189&4294967295,w=I+(v<<23&4294967295|v>>>9),v=_+(w^I^A)+E[9]+3654602809&4294967295,_=w+(v<<4&4294967295|v>>>28),v=A+(_^w^I)+E[12]+3873151461&4294967295,A=_+(v<<11&4294967295|v>>>21),v=I+(A^_^w)+E[15]+530742520&4294967295,I=A+(v<<16&4294967295|v>>>16),v=w+(I^A^_)+E[2]+3299628645&4294967295,w=I+(v<<23&4294967295|v>>>9),v=_+(I^(w|~A))+E[0]+4096336452&4294967295,_=w+(v<<6&4294967295|v>>>26),v=A+(w^(_|~I))+E[7]+1126891415&4294967295,A=_+(v<<10&4294967295|v>>>22),v=I+(_^(A|~w))+E[14]+2878612391&4294967295,I=A+(v<<15&4294967295|v>>>17),v=w+(A^(I|~_))+E[5]+4237533241&4294967295,w=I+(v<<21&4294967295|v>>>11),v=_+(I^(w|~A))+E[12]+1700485571&4294967295,_=w+(v<<6&4294967295|v>>>26),v=A+(w^(_|~I))+E[3]+2399980690&4294967295,A=_+(v<<10&4294967295|v>>>22),v=I+(_^(A|~w))+E[10]+4293915773&4294967295,I=A+(v<<15&4294967295|v>>>17),v=w+(A^(I|~_))+E[1]+2240044497&4294967295,w=I+(v<<21&4294967295|v>>>11),v=_+(I^(w|~A))+E[8]+1873313359&4294967295,_=w+(v<<6&4294967295|v>>>26),v=A+(w^(_|~I))+E[15]+4264355552&4294967295,A=_+(v<<10&4294967295|v>>>22),v=I+(_^(A|~w))+E[6]+2734768916&4294967295,I=A+(v<<15&4294967295|v>>>17),v=w+(A^(I|~_))+E[13]+1309151649&4294967295,w=I+(v<<21&4294967295|v>>>11),v=_+(I^(w|~A))+E[4]+4149444226&4294967295,_=w+(v<<6&4294967295|v>>>26),v=A+(w^(_|~I))+E[11]+3174756917&4294967295,A=_+(v<<10&4294967295|v>>>22),v=I+(_^(A|~w))+E[2]+718787259&4294967295,I=A+(v<<15&4294967295|v>>>17),v=w+(A^(I|~_))+E[9]+3951481745&4294967295,C.g[0]=C.g[0]+_&4294967295,C.g[1]=C.g[1]+(I+(v<<21&4294967295|v>>>11))&4294967295,C.g[2]=C.g[2]+I&4294967295,C.g[3]=C.g[3]+A&4294967295}r.prototype.u=function(C,_){_===void 0&&(_=C.length);for(var w=_-this.blockSize,E=this.B,I=this.h,A=0;A<_;){if(I==0)for(;A<=w;)i(this,C,A),A+=this.blockSize;if(typeof C=="string"){for(;A<_;)if(E[I++]=C.charCodeAt(A++),I==this.blockSize){i(this,E),I=0;break}}else for(;A<_;)if(E[I++]=C[A++],I==this.blockSize){i(this,E),I=0;break}}this.h=I,this.o+=_},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var _=1;_<C.length-8;++_)C[_]=0;var w=8*this.o;for(_=C.length-8;_<C.length;++_)C[_]=w&255,w/=256;for(this.u(C),C=Array(16),_=w=0;4>_;++_)for(var E=0;32>E;E+=8)C[w++]=this.g[_]>>>E&255;return C};function s(C,_){var w=a;return Object.prototype.hasOwnProperty.call(w,C)?w[C]:w[C]=_(C)}function o(C,_){this.h=_;for(var w=[],E=!0,I=C.length-1;0<=I;I--){var A=C[I]|0;E&&A==_||(w[I]=A,E=!1)}this.g=w}var a={};function c(C){return-128<=C&&128>C?s(C,function(_){return new o([_|0],0>_?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return p;if(0>C)return x(u(-C));for(var _=[],w=1,E=0;C>=w;E++)_[E]=C/w|0,w*=4294967296;return new o(_,0)}function d(C,_){if(C.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(C.charAt(0)=="-")return x(d(C.substring(1),_));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=u(Math.pow(_,8)),E=p,I=0;I<C.length;I+=8){var A=Math.min(8,C.length-I),v=parseInt(C.substring(I,I+A),_);8>A?(A=u(Math.pow(_,A)),E=E.j(A).add(u(v))):(E=E.j(w),E=E.add(u(v)))}return E}var p=c(0),m=c(1),y=c(16777216);n=o.prototype,n.m=function(){if(k(this))return-x(this).m();for(var C=0,_=1,w=0;w<this.g.length;w++){var E=this.i(w);C+=(0<=E?E:4294967296+E)*_,_*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(T(this))return"0";if(k(this))return"-"+x(this).toString(C);for(var _=u(Math.pow(C,6)),w=this,E="";;){var I=X(w,_).g;w=W(w,I.j(_));var A=((0<w.g.length?w.g[0]:w.h)>>>0).toString(C);if(w=I,T(w))return A+E;for(;6>A.length;)A="0"+A;E=A+E}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function T(C){if(C.h!=0)return!1;for(var _=0;_<C.g.length;_++)if(C.g[_]!=0)return!1;return!0}function k(C){return C.h==-1}n.l=function(C){return C=W(this,C),k(C)?-1:T(C)?0:1};function x(C){for(var _=C.g.length,w=[],E=0;E<_;E++)w[E]=~C.g[E];return new o(w,~C.h).add(m)}n.abs=function(){return k(this)?x(this):this},n.add=function(C){for(var _=Math.max(this.g.length,C.g.length),w=[],E=0,I=0;I<=_;I++){var A=E+(this.i(I)&65535)+(C.i(I)&65535),v=(A>>>16)+(this.i(I)>>>16)+(C.i(I)>>>16);E=v>>>16,A&=65535,v&=65535,w[I]=v<<16|A}return new o(w,w[w.length-1]&-2147483648?-1:0)};function W(C,_){return C.add(x(_))}n.j=function(C){if(T(this)||T(C))return p;if(k(this))return k(C)?x(this).j(x(C)):x(x(this).j(C));if(k(C))return x(this.j(x(C)));if(0>this.l(y)&&0>C.l(y))return u(this.m()*C.m());for(var _=this.g.length+C.g.length,w=[],E=0;E<2*_;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var I=0;I<C.g.length;I++){var A=this.i(E)>>>16,v=this.i(E)&65535,Wn=C.i(I)>>>16,aa=C.i(I)&65535;w[2*E+2*I]+=v*aa,K(w,2*E+2*I),w[2*E+2*I+1]+=A*aa,K(w,2*E+2*I+1),w[2*E+2*I+1]+=v*Wn,K(w,2*E+2*I+1),w[2*E+2*I+2]+=A*Wn,K(w,2*E+2*I+2)}for(E=0;E<_;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=_;E<2*_;E++)w[E]=0;return new o(w,0)};function K(C,_){for(;(C[_]&65535)!=C[_];)C[_+1]+=C[_]>>>16,C[_]&=65535,_++}function F(C,_){this.g=C,this.h=_}function X(C,_){if(T(_))throw Error("division by zero");if(T(C))return new F(p,p);if(k(C))return _=X(x(C),_),new F(x(_.g),x(_.h));if(k(_))return _=X(C,x(_)),new F(x(_.g),_.h);if(30<C.g.length){if(k(C)||k(_))throw Error("slowDivide_ only works with positive integers.");for(var w=m,E=_;0>=E.l(C);)w=re(w),E=re(E);var I=ie(w,1),A=ie(E,1);for(E=ie(E,2),w=ie(w,2);!T(E);){var v=A.add(E);0>=v.l(C)&&(I=I.add(w),A=v),E=ie(E,1),w=ie(w,1)}return _=W(C,I.j(_)),new F(I,_)}for(I=p;0<=C.l(_);){for(w=Math.max(1,Math.floor(C.m()/_.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),A=u(w),v=A.j(_);k(v)||0<v.l(C);)w-=E,A=u(w),v=A.j(_);T(A)&&(A=m),I=I.add(A),C=W(C,v)}return new F(I,C)}n.A=function(C){return X(this,C).h},n.and=function(C){for(var _=Math.max(this.g.length,C.g.length),w=[],E=0;E<_;E++)w[E]=this.i(E)&C.i(E);return new o(w,this.h&C.h)},n.or=function(C){for(var _=Math.max(this.g.length,C.g.length),w=[],E=0;E<_;E++)w[E]=this.i(E)|C.i(E);return new o(w,this.h|C.h)},n.xor=function(C){for(var _=Math.max(this.g.length,C.g.length),w=[],E=0;E<_;E++)w[E]=this.i(E)^C.i(E);return new o(w,this.h^C.h)};function re(C){for(var _=C.g.length+1,w=[],E=0;E<_;E++)w[E]=C.i(E)<<1|C.i(E-1)>>>31;return new o(w,C.h)}function ie(C,_){var w=_>>5;_%=32;for(var E=C.g.length-w,I=[],A=0;A<E;A++)I[A]=0<_?C.i(A+w)>>>_|C.i(A+w+1)<<32-_:C.i(A+w);return new o(I,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Wm=gT.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,or=gT.Integer=o}).apply(typeof pT<"u"?pT:typeof self<"u"?self:typeof window<"u"?window:{});var Ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ar={};var Hm,DN,so,Km,Pl,Eh,Qm,Ym,Jm;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,f){return l==Array.prototype||l==Object.prototype||(l[h]=f.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ch=="object"&&Ch];for(var h=0;h<l.length;++h){var f=l[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var f=r;l=l.split(".");for(var g=0;g<l.length-1;g++){var b=l[g];if(!(b in f))break e;f=f[b]}l=l[l.length-1],g=f[l],h=h(g),h!=g&&h!=null&&e(f,l,{configurable:!0,writable:!0,value:h})}}function s(l,h){l instanceof String&&(l+="");var f=0,g=!1,b={next:function(){if(!g&&f<l.length){var D=f++;return{value:h(D,l[D]),done:!1}}return g=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(l){return l||function(){return s(this,function(h,f){return f})}});var o=o||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,f){return l.call.apply(l.bind,arguments)}function p(l,h,f){if(!l)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,g),l.apply(h,b)}}return function(){return l.apply(h,arguments)}}function m(l,h,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function y(l,h){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),l.apply(this,g)}}function T(l,h){function f(){}f.prototype=h.prototype,l.aa=h.prototype,l.prototype=new f,l.prototype.constructor=l,l.Qb=function(g,b,D){for(var V=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)V[Ie-2]=arguments[Ie];return h.prototype[b].apply(g,V)}}function k(l){let h=l.length;if(0<h){let f=Array(h);for(let g=0;g<h;g++)f[g]=l[g];return f}return[]}function x(l,h){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let b=l.length||0,D=g.length||0;l.length=b+D;for(let V=0;V<D;V++)l[b+V]=g[V]}else l.push(g)}}class W{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function K(l){return/^[\s\xa0]*$/.test(l)}function F(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function X(l){return X[" "](l),l}X[" "]=function(){};var re=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function ie(l,h,f){for(let g in l)h.call(f,l[g],g,l)}function C(l,h){for(let f in l)h.call(void 0,l[f],f,l)}function _(l){let h={};for(let f in l)h[f]=l[f];return h}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(l,h){let f,g;for(let b=1;b<arguments.length;b++){g=arguments[b];for(f in g)l[f]=g[f];for(let D=0;D<w.length;D++)f=w[D],Object.prototype.hasOwnProperty.call(g,f)&&(l[f]=g[f])}}function I(l){var h=1;l=l.split(":");let f=[];for(;0<h&&l.length;)f.push(l.shift()),h--;return l.length&&f.push(l.join(":")),f}function A(l){a.setTimeout(()=>{throw l},0)}function v(){var l=$f;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class Wn{constructor(){this.h=this.g=null}add(h,f){let g=aa.get();g.set(h,f),this.h?this.h.next=g:this.g=g,this.h=g}}var aa=new W(()=>new W1,l=>l.reset());class W1{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let la,ca=!1,$f=new Wn,nw=()=>{let l=a.Promise.resolve(void 0);la=()=>{l.then(H1)}};var H1=()=>{for(var l;l=v();){try{l.h.call(l.g)}catch(f){A(f)}var h=aa;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}ca=!1};function yr(){this.s=this.s,this.C=this.C}yr.prototype.s=!1,yr.prototype.ma=function(){this.s||(this.s=!0,this.N())},yr.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ut(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}ut.prototype.h=function(){this.defaultPrevented=!0};var K1=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let f=()=>{};a.addEventListener("test",f,h),a.removeEventListener("test",f,h)}catch{}return l}();function ua(l,h){if(ut.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var f=this.type=l.type,g=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(re){e:{try{X(h.nodeName);var b=!0;break e}catch{}b=!1}b||(h=null)}}else f=="mouseover"?h=l.fromElement:f=="mouseout"&&(h=l.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Q1[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&ua.aa.h.call(this)}}T(ua,ut);var Q1={2:"touch",3:"pen",4:"mouse"};ua.prototype.h=function(){ua.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ha="closure_listenable_"+(1e6*Math.random()|0),Y1=0;function J1(l,h,f,g,b){this.listener=l,this.proxy=null,this.src=h,this.type=f,this.capture=!!g,this.ha=b,this.key=++Y1,this.da=this.fa=!1}function Oc(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Vc(l){this.src=l,this.g={},this.h=0}Vc.prototype.add=function(l,h,f,g,b){var D=l.toString();l=this.g[D],l||(l=this.g[D]=[],this.h++);var V=Gf(l,h,g,b);return-1<V?(h=l[V],f||(h.fa=!1)):(h=new J1(h,this.src,D,!!g,b),h.fa=f,l.push(h)),h};function zf(l,h){var f=h.type;if(f in l.g){var g=l.g[f],b=Array.prototype.indexOf.call(g,h,void 0),D;(D=0<=b)&&Array.prototype.splice.call(g,b,1),D&&(Oc(h),l.g[f].length==0&&(delete l.g[f],l.h--))}}function Gf(l,h,f,g){for(var b=0;b<l.length;++b){var D=l[b];if(!D.da&&D.listener==h&&D.capture==!!f&&D.ha==g)return b}return-1}var Wf="closure_lm_"+(1e6*Math.random()|0),Hf={};function rw(l,h,f,g,b){if(g&&g.once)return sw(l,h,f,g,b);if(Array.isArray(h)){for(var D=0;D<h.length;D++)rw(l,h[D],f,g,b);return null}return f=Jf(f),l&&l[ha]?l.K(h,f,u(g)?!!g.capture:!!g,b):iw(l,h,f,!1,g,b)}function iw(l,h,f,g,b,D){if(!h)throw Error("Invalid event type");var V=u(b)?!!b.capture:!!b,Ie=Qf(l);if(Ie||(l[Wf]=Ie=new Vc(l)),f=Ie.add(h,f,g,V,D),f.proxy)return f;if(g=X1(),f.proxy=g,g.src=l,g.listener=f,l.addEventListener)K1||(b=V),b===void 0&&(b=!1),l.addEventListener(h.toString(),g,b);else if(l.attachEvent)l.attachEvent(aw(h.toString()),g);else if(l.addListener&&l.removeListener)l.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function X1(){function l(f){return h.call(l.src,l.listener,f)}let h=Z1;return l}function sw(l,h,f,g,b){if(Array.isArray(h)){for(var D=0;D<h.length;D++)sw(l,h[D],f,g,b);return null}return f=Jf(f),l&&l[ha]?l.L(h,f,u(g)?!!g.capture:!!g,b):iw(l,h,f,!0,g,b)}function ow(l,h,f,g,b){if(Array.isArray(h))for(var D=0;D<h.length;D++)ow(l,h[D],f,g,b);else g=u(g)?!!g.capture:!!g,f=Jf(f),l&&l[ha]?(l=l.i,h=String(h).toString(),h in l.g&&(D=l.g[h],f=Gf(D,f,g,b),-1<f&&(Oc(D[f]),Array.prototype.splice.call(D,f,1),D.length==0&&(delete l.g[h],l.h--)))):l&&(l=Qf(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Gf(h,f,g,b)),(f=-1<l?h[l]:null)&&Kf(f))}function Kf(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[ha])zf(h.i,l);else{var f=l.type,g=l.proxy;h.removeEventListener?h.removeEventListener(f,g,l.capture):h.detachEvent?h.detachEvent(aw(f),g):h.addListener&&h.removeListener&&h.removeListener(g),(f=Qf(h))?(zf(f,l),f.h==0&&(f.src=null,h[Wf]=null)):Oc(l)}}}function aw(l){return l in Hf?Hf[l]:Hf[l]="on"+l}function Z1(l,h){if(l.da)l=!0;else{h=new ua(h,this);var f=l.listener,g=l.ha||l.src;l.fa&&Kf(l),l=f.call(g,h)}return l}function Qf(l){return l=l[Wf],l instanceof Vc?l:null}var Yf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jf(l){return typeof l=="function"?l:(l[Yf]||(l[Yf]=function(h){return l.handleEvent(h)}),l[Yf])}function ht(){yr.call(this),this.i=new Vc(this),this.M=this,this.F=null}T(ht,yr),ht.prototype[ha]=!0,ht.prototype.removeEventListener=function(l,h,f,g){ow(this,l,h,f,g)};function Ct(l,h){var f,g=l.F;if(g)for(f=[];g;g=g.F)f.push(g);if(l=l.M,g=h.type||h,typeof h=="string")h=new ut(h,l);else if(h instanceof ut)h.target=h.target||l;else{var b=h;h=new ut(g,l),E(h,b)}if(b=!0,f)for(var D=f.length-1;0<=D;D--){var V=h.g=f[D];b=Uc(V,g,!0,h)&&b}if(V=h.g=l,b=Uc(V,g,!0,h)&&b,b=Uc(V,g,!1,h)&&b,f)for(D=0;D<f.length;D++)V=h.g=f[D],b=Uc(V,g,!1,h)&&b}ht.prototype.N=function(){if(ht.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var f=l.g[h],g=0;g<f.length;g++)Oc(f[g]);delete l.g[h],l.h--}}this.F=null},ht.prototype.K=function(l,h,f,g){return this.i.add(String(l),h,!1,f,g)},ht.prototype.L=function(l,h,f,g){return this.i.add(String(l),h,!0,f,g)};function Uc(l,h,f,g){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var b=!0,D=0;D<h.length;++D){var V=h[D];if(V&&!V.da&&V.capture==f){var Ie=V.listener,st=V.ha||V.src;V.fa&&zf(l.i,V),b=Ie.call(st,g)!==!1&&b}}return b&&!g.defaultPrevented}function lw(l,h,f){if(typeof l=="function")f&&(l=m(l,f));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function cw(l){l.g=lw(()=>{l.g=null,l.i&&(l.i=!1,cw(l))},l.l);let h=l.h;l.h=null,l.m.apply(null,h)}class eP extends yr{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:cw(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function da(l){yr.call(this),this.h=l,this.g={}}T(da,yr);var uw=[];function hw(l){ie(l.g,function(h,f){this.g.hasOwnProperty(f)&&Kf(h)},l),l.g={}}da.prototype.N=function(){da.aa.N.call(this),hw(this)},da.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xf=a.JSON.stringify,tP=a.JSON.parse,nP=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Zf(){}Zf.prototype.h=null;function dw(l){return l.h||(l.h=l.i())}function fw(){}var fa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ep(){ut.call(this,"d")}T(ep,ut);function tp(){ut.call(this,"c")}T(tp,ut);var oi={},pw=null;function Lc(){return pw=pw||new ht}oi.La="serverreachability";function gw(l){ut.call(this,oi.La,l)}T(gw,ut);function pa(l){let h=Lc();Ct(h,new gw(h))}oi.STAT_EVENT="statevent";function mw(l,h){ut.call(this,oi.STAT_EVENT,l),this.stat=h}T(mw,ut);function Et(l){let h=Lc();Ct(h,new mw(h,l))}oi.Ma="timingevent";function _w(l,h){ut.call(this,oi.Ma,l),this.size=h}T(_w,ut);function ga(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function ma(){this.g=!0}ma.prototype.xa=function(){this.g=!1};function rP(l,h,f,g,b,D){l.info(function(){if(l.g)if(D)for(var V="",Ie=D.split("&"),st=0;st<Ie.length;st++){var me=Ie[st].split("=");if(1<me.length){var dt=me[0];me=me[1];var ft=dt.split("_");V=2<=ft.length&&ft[1]=="type"?V+(dt+"="+me+"&"):V+(dt+"=redacted&")}}else V=null;else V=D;return"XMLHTTP REQ ("+g+") [attempt "+b+"]: "+h+`
`+f+`
`+V})}function iP(l,h,f,g,b,D,V){l.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+b+"]: "+h+`
`+f+`
`+D+" "+V})}function fs(l,h,f,g){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+oP(l,f)+(g?" "+g:"")})}function sP(l,h){l.info(function(){return"TIMEOUT: "+h})}ma.prototype.info=function(){};function oP(l,h){if(!l.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(l=0;l<f.length;l++)if(Array.isArray(f[l])){var g=f[l];if(!(2>g.length)){var b=g[1];if(Array.isArray(b)&&!(1>b.length)){var D=b[0];if(D!="noop"&&D!="stop"&&D!="close")for(var V=1;V<b.length;V++)b[V]=""}}}}return Xf(f)}catch{return h}}var Bc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yw={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},np;function jc(){}T(jc,Zf),jc.prototype.g=function(){return new XMLHttpRequest},jc.prototype.i=function(){return{}},np=new jc;function vr(l,h,f,g){this.j=l,this.i=h,this.l=f,this.R=g||1,this.U=new da(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new vw}function vw(){this.i=null,this.g="",this.h=!1}var ww={},rp={};function ip(l,h,f){l.L=1,l.v=Gc(Hn(h)),l.m=f,l.P=!0,Cw(l,null)}function Cw(l,h){l.F=Date.now(),qc(l),l.A=Hn(l.v);var f=l.A,g=l.R;Array.isArray(g)||(g=[String(g)]),Fw(f.i,"t",g),l.C=0,f=l.j.J,l.h=new vw,l.g=Zw(l.j,f?h:null,!l.m),0<l.O&&(l.M=new eP(m(l.Y,l,l.g),l.O)),h=l.U,f=l.g,g=l.ca;var b="readystatechange";Array.isArray(b)||(b&&(uw[0]=b.toString()),b=uw);for(var D=0;D<b.length;D++){var V=rw(f,b[D],g||h.handleEvent,!1,h.h||h);if(!V)break;h.g[V.key]=V}h=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),pa(),rP(l.i,l.u,l.A,l.l,l.R,l.m)}vr.prototype.ca=function(l){l=l.target;let h=this.M;h&&Kn(l)==3?h.j():this.Y(l)},vr.prototype.Y=function(l){try{if(l==this.g)e:{let ft=Kn(this.g);var h=this.g.Ba();let ms=this.g.Z();if(!(3>ft)&&(ft!=3||this.g&&(this.h.h||this.g.oa()||qw(this.g)))){this.J||ft!=4||h==7||(h==8||0>=ms?pa(3):pa(2)),sp(this);var f=this.g.Z();this.X=f;t:if(Ew(this)){var g=qw(this.g);l="";var b=g.length,D=Kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ai(this),_a(this);var V="";break t}this.h.i=new a.TextDecoder}for(h=0;h<b;h++)this.h.h=!0,l+=this.h.i.decode(g[h],{stream:!(D&&h==b-1)});g.length=0,this.h.g+=l,this.C=0,V=this.h.g}else V=this.g.oa();if(this.o=f==200,iP(this.i,this.u,this.A,this.l,this.R,ft,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,st=this.g;if((Ie=st.g?st.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(Ie)){var me=Ie;break t}}me=null}if(f=me)fs(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,op(this,f);else{this.o=!1,this.s=3,Et(12),ai(this),_a(this);break e}}if(this.P){f=!0;let ln;for(;!this.J&&this.C<V.length;)if(ln=aP(this,V),ln==rp){ft==4&&(this.s=4,Et(14),f=!1),fs(this.i,this.l,null,"[Incomplete Response]");break}else if(ln==ww){this.s=4,Et(15),fs(this.i,this.l,V,"[Invalid Chunk]"),f=!1;break}else fs(this.i,this.l,ln,null),op(this,ln);if(Ew(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ft!=4||V.length!=0||this.h.h||(this.s=1,Et(16),f=!1),this.o=this.o&&f,!f)fs(this.i,this.l,V,"[Invalid Chunked Response]"),ai(this),_a(this);else if(0<V.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+V.length),dp(dt),dt.M=!0,Et(11))}}else fs(this.i,this.l,V,null),op(this,V);ft==4&&ai(this),this.o&&!this.J&&(ft==4?Qw(this.j,this):(this.o=!1,qc(this)))}else bP(this.g),f==400&&0<V.indexOf("Unknown SID")?(this.s=3,Et(12)):(this.s=0,Et(13)),ai(this),_a(this)}}}catch{}finally{}};function Ew(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function aP(l,h){var f=l.C,g=h.indexOf(`
`,f);return g==-1?rp:(f=Number(h.substring(f,g)),isNaN(f)?ww:(g+=1,g+f>h.length?rp:(h=h.slice(g,g+f),l.C=g+f,h)))}vr.prototype.cancel=function(){this.J=!0,ai(this)};function qc(l){l.S=Date.now()+l.I,Iw(l,l.I)}function Iw(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=ga(m(l.ba,l),h)}function sp(l){l.B&&(a.clearTimeout(l.B),l.B=null)}vr.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(sP(this.i,this.A),this.L!=2&&(pa(),Et(17)),ai(this),this.s=2,_a(this)):Iw(this,this.S-l)};function _a(l){l.j.G==0||l.J||Qw(l.j,l)}function ai(l){sp(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,hw(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function op(l,h){try{var f=l.j;if(f.G!=0&&(f.g==l||ap(f.h,l))){if(!l.K&&ap(f.h,l)&&f.G==3){try{var g=f.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var b=g;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<l.F)Yc(f),Kc(f);else break e;hp(f),Et(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=ga(m(f.Za,f),6e3));if(1>=Aw(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ci(f,11)}else if((l.K||f.g==l)&&Yc(f),!K(h))for(b=f.Da.g.parse(h),h=0;h<b.length;h++){let me=b[h];if(f.T=me[0],me=me[1],f.G==2)if(me[0]=="c"){f.K=me[1],f.ia=me[2];let dt=me[3];dt!=null&&(f.la=dt,f.j.info("VER="+f.la));let ft=me[4];ft!=null&&(f.Aa=ft,f.j.info("SVER="+f.Aa));let ms=me[5];ms!=null&&typeof ms=="number"&&0<ms&&(g=1.5*ms,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let ln=l.g;if(ln){let Xc=ln.g?ln.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xc){var D=g.h;D.g||Xc.indexOf("spdy")==-1&&Xc.indexOf("quic")==-1&&Xc.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(lp(D,D.h),D.h=null))}if(g.D){let fp=ln.g?ln.g.getResponseHeader("X-HTTP-Session-Id"):null;fp&&(g.ya=fp,Se(g.I,g.D,fp))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-l.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var V=l;if(g.qa=Xw(g,g.J?g.ia:null,g.W),V.K){Sw(g.h,V);var Ie=V,st=g.L;st&&(Ie.I=st),Ie.B&&(sp(Ie),qc(Ie)),g.g=V}else Hw(g);0<f.i.length&&Qc(f)}else me[0]!="stop"&&me[0]!="close"||ci(f,7);else f.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?ci(f,7):up(f):me[0]!="noop"&&f.l&&f.l.ta(me),f.v=0)}}pa(4)}catch{}}var lP=class{constructor(l,h){this.g=l,this.map=h}};function bw(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tw(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Aw(l){return l.h?1:l.g?l.g.size:0}function ap(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function lp(l,h){l.g?l.g.add(h):l.h=h}function Sw(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}bw.prototype.cancel=function(){if(this.i=Rw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function Rw(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(let f of l.g.values())h=h.concat(f.D);return h}return k(l.i)}function cP(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],f=l.length,g=0;g<f;g++)h.push(l[g]);return h}h=[],f=0;for(g in l)h[f++]=l[g];return h}function uP(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var f=0;f<l;f++)h.push(f);return h}h=[],f=0;for(let g in l)h[f++]=g;return h}}}function Pw(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var f=uP(l),g=cP(l),b=g.length,D=0;D<b;D++)h.call(void 0,g[D],f&&f[D],l)}var Dw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hP(l,h){if(l){l=l.split("&");for(var f=0;f<l.length;f++){var g=l[f].indexOf("="),b=null;if(0<=g){var D=l[f].substring(0,g);b=l[f].substring(g+1)}else D=l[f];h(D,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function li(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof li){this.h=l.h,$c(this,l.j),this.o=l.o,this.g=l.g,zc(this,l.s),this.l=l.l;var h=l.i,f=new wa;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),xw(this,f),this.m=l.m}else l&&(h=String(l).match(Dw))?(this.h=!1,$c(this,h[1]||"",!0),this.o=ya(h[2]||""),this.g=ya(h[3]||"",!0),zc(this,h[4]),this.l=ya(h[5]||"",!0),xw(this,h[6]||"",!0),this.m=ya(h[7]||"")):(this.h=!1,this.i=new wa(null,this.h))}li.prototype.toString=function(){var l=[],h=this.j;h&&l.push(va(h,kw,!0),":");var f=this.g;return(f||h=="file")&&(l.push("//"),(h=this.o)&&l.push(va(h,kw,!0),"@"),l.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&l.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&l.push("/"),l.push(va(f,f.charAt(0)=="/"?pP:fP,!0))),(f=this.i.toString())&&l.push("?",f),(f=this.m)&&l.push("#",va(f,mP)),l.join("")};function Hn(l){return new li(l)}function $c(l,h,f){l.j=f?ya(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function zc(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function xw(l,h,f){h instanceof wa?(l.i=h,_P(l.i,l.h)):(f||(h=va(h,gP)),l.i=new wa(h,l.h))}function Se(l,h,f){l.i.set(h,f)}function Gc(l){return Se(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ya(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function va(l,h,f){return typeof l=="string"?(l=encodeURI(l).replace(h,dP),f&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function dP(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var kw=/[#\/\?@]/g,fP=/[#\?:]/g,pP=/[#\?]/g,gP=/[#\?@]/g,mP=/#/g;function wa(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function wr(l){l.g||(l.g=new Map,l.h=0,l.i&&hP(l.i,function(h,f){l.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}n=wa.prototype,n.add=function(l,h){wr(this),this.i=null,l=ps(this,l);var f=this.g.get(l);return f||this.g.set(l,f=[]),f.push(h),this.h+=1,this};function Mw(l,h){wr(l),h=ps(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Nw(l,h){return wr(l),h=ps(l,h),l.g.has(h)}n.forEach=function(l,h){wr(this),this.g.forEach(function(f,g){f.forEach(function(b){l.call(h,b,g,this)},this)},this)},n.na=function(){wr(this);let l=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let g=0;g<h.length;g++){let b=l[g];for(let D=0;D<b.length;D++)f.push(h[g])}return f},n.V=function(l){wr(this);let h=[];if(typeof l=="string")Nw(this,l)&&(h=h.concat(this.g.get(ps(this,l))));else{l=Array.from(this.g.values());for(let f=0;f<l.length;f++)h=h.concat(l[f])}return h},n.set=function(l,h){return wr(this),this.i=null,l=ps(this,l),Nw(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Fw(l,h,f){Mw(l,h),0<f.length&&(l.i=null,l.g.set(ps(l,h),k(f)),l.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var g=h[f];let D=encodeURIComponent(String(g)),V=this.V(g);for(g=0;g<V.length;g++){var b=D;V[g]!==""&&(b+="="+encodeURIComponent(String(V[g]))),l.push(b)}}return this.i=l.join("&")};function ps(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function _P(l,h){h&&!l.j&&(wr(l),l.i=null,l.g.forEach(function(f,g){var b=g.toLowerCase();g!=b&&(Mw(this,g),Fw(this,b,f))},l)),l.j=h}function yP(l,h){let f=new ma;if(a.Image){let g=new Image;g.onload=y(Cr,f,"TestLoadImage: loaded",!0,h,g),g.onerror=y(Cr,f,"TestLoadImage: error",!1,h,g),g.onabort=y(Cr,f,"TestLoadImage: abort",!1,h,g),g.ontimeout=y(Cr,f,"TestLoadImage: timeout",!1,h,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=l}else h(!1)}function vP(l,h){let f=new ma,g=new AbortController,b=setTimeout(()=>{g.abort(),Cr(f,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:g.signal}).then(D=>{clearTimeout(b),D.ok?Cr(f,"TestPingServer: ok",!0,h):Cr(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(b),Cr(f,"TestPingServer: error",!1,h)})}function Cr(l,h,f,g,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),g(f)}catch{}}function wP(){this.g=new nP}function CP(l,h,f){let g=f||"";try{Pw(l,function(b,D){let V=b;u(b)&&(V=Xf(b)),h.push(g+D+"="+encodeURIComponent(V))})}catch(b){throw h.push(g+"type="+encodeURIComponent("_badmap")),b}}function Ca(l){this.l=l.Ub||null,this.j=l.eb||!1}T(Ca,Zf),Ca.prototype.g=function(){return new Wc(this.l,this.j)},Ca.prototype.i=function(l){return function(){return l}}({});function Wc(l,h){ht.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Wc,ht),n=Wc.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Ia(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ea(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ia(this)),this.g&&(this.readyState=3,Ia(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ow(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ow(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Ea(this):Ia(this),this.readyState==3&&Ow(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Ea(this))},n.Qa=function(l){this.g&&(this.response=l,Ea(this))},n.ga=function(){this.g&&Ea(this)};function Ea(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ia(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,l.push(f[0]+": "+f[1]),f=h.next();return l.join(`\r
`)};function Ia(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Vw(l){let h="";return ie(l,function(f,g){h+=g,h+=":",h+=f,h+=`\r
`}),h}function cp(l,h,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=Vw(f),typeof l=="string"?f!=null&&encodeURIComponent(String(f)):Se(l,h,f))}function Le(l){ht.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(Le,ht);var EP=/^https?$/i,IP=["POST","PUT"];n=Le.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():np.g(),this.v=this.o?dw(this.o):dw(np),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(D){Uw(this,D);return}if(l=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var b in g)f.set(b,g[b]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let D of g.keys())f.set(D,g.get(D));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(D=>D.toLowerCase()=="content-type"),b=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(IP,h,void 0))||g||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[D,V]of f)this.g.setRequestHeader(D,V);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jw(this),this.u=!0,this.g.send(l),this.u=!1}catch(D){Uw(this,D)}};function Uw(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Lw(l),Hc(l)}function Lw(l){l.A||(l.A=!0,Ct(l,"complete"),Ct(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Ct(this,"complete"),Ct(this,"abort"),Hc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hc(this,!0)),Le.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Bw(this):this.bb())},n.bb=function(){Bw(this)};function Bw(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Kn(l)!=4||l.Z()!=2)){if(l.u&&Kn(l)==4)lw(l.Ea,0,l);else if(Ct(l,"readystatechange"),Kn(l)==4){l.h=!1;try{let V=l.Z();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var g;if(g=V===0){var b=String(l.D).match(Dw)[1]||null;!b&&a.self&&a.self.location&&(b=a.self.location.protocol.slice(0,-1)),g=!EP.test(b?b.toLowerCase():"")}f=g}if(f)Ct(l,"complete"),Ct(l,"success");else{l.m=6;try{var D=2<Kn(l)?l.g.statusText:""}catch{D=""}l.l=D+" ["+l.Z()+"]",Lw(l)}}finally{Hc(l)}}}}function Hc(l,h){if(l.g){jw(l);let f=l.g,g=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Ct(l,"ready");try{f.onreadystatechange=g}catch{}}}function jw(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function Kn(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<Kn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),tP(h)}};function qw(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function bP(l){let h={};l=(l.g&&2<=Kn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<l.length;g++){if(K(l[g]))continue;var f=I(l[g]);let b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let D=h[b]||[];h[b]=D,D.push(f)}C(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ba(l,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[l]||h}function $w(l){this.Aa=0,this.i=[],this.j=new ma,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ba("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ba("baseRetryDelayMs",5e3,l),this.cb=ba("retryDelaySeedMs",1e4,l),this.Wa=ba("forwardChannelMaxRetries",2,l),this.wa=ba("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new bw(l&&l.concurrentRequestLimit),this.Da=new wP,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$w.prototype,n.la=8,n.G=1,n.connect=function(l,h,f,g){Et(0),this.W=l,this.H=h||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=Xw(this,null,this.W),Qc(this)};function up(l){if(zw(l),l.G==3){var h=l.U++,f=Hn(l.I);if(Se(f,"SID",l.K),Se(f,"RID",h),Se(f,"TYPE","terminate"),Ta(l,f),h=new vr(l,l.j,h),h.L=2,h.v=Gc(Hn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=h.v,f=!0),f||(h.g=Zw(h.j,null),h.g.ea(h.v)),h.F=Date.now(),qc(h)}Jw(l)}function Kc(l){l.g&&(dp(l),l.g.cancel(),l.g=null)}function zw(l){Kc(l),l.u&&(a.clearTimeout(l.u),l.u=null),Yc(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Qc(l){if(!Tw(l.h)&&!l.s){l.s=!0;var h=l.Ga;la||nw(),ca||(la(),ca=!0),$f.add(h,l),l.B=0}}function TP(l,h){return Aw(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=ga(m(l.Ga,l,h),Yw(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let b=new vr(this,this.j,l),D=this.o;if(this.S&&(D?(D=_(D),E(D,this.S)):D=this.S),this.m!==null||this.O||(b.H=D,D=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=Ww(this,b,h),f=Hn(this.I),Se(f,"RID",l),Se(f,"CVER",22),this.D&&Se(f,"X-HTTP-Session-Id",this.D),Ta(this,f),D&&(this.O?h="headers="+encodeURIComponent(String(Vw(D)))+"&"+h:this.m&&cp(f,this.m,D)),lp(this.h,b),this.Ua&&Se(f,"TYPE","init"),this.P?(Se(f,"$req",h),Se(f,"SID","null"),b.T=!0,ip(b,f,null)):ip(b,f,h),this.G=2}}else this.G==3&&(l?Gw(this,l):this.i.length==0||Tw(this.h)||Gw(this))};function Gw(l,h){var f;h?f=h.l:f=l.U++;let g=Hn(l.I);Se(g,"SID",l.K),Se(g,"RID",f),Se(g,"AID",l.T),Ta(l,g),l.m&&l.o&&cp(g,l.m,l.o),f=new vr(l,l.j,f,l.B+1),l.m===null&&(f.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Ww(l,f,1e3),f.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),lp(l.h,f),ip(f,g,h)}function Ta(l,h){l.H&&ie(l.H,function(f,g){Se(h,g,f)}),l.l&&Pw({},function(f,g){Se(h,g,f)})}function Ww(l,h,f){f=Math.min(l.i.length,f);var g=l.l?m(l.l.Na,l.l,l):null;e:{var b=l.i;let D=-1;for(;;){let V=["count="+f];D==-1?0<f?(D=b[0].g,V.push("ofs="+D)):D=0:V.push("ofs="+D);let Ie=!0;for(let st=0;st<f;st++){let me=b[st].g,dt=b[st].map;if(me-=D,0>me)D=Math.max(0,b[st].g-100),Ie=!1;else try{CP(dt,V,"req"+me+"_")}catch{g&&g(dt)}}if(Ie){g=V.join("&");break e}}}return l=l.i.splice(0,f),h.D=l,g}function Hw(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;la||nw(),ca||(la(),ca=!0),$f.add(h,l),l.v=0}}function hp(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=ga(m(l.Fa,l),Yw(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,Kw(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=ga(m(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Et(10),Kc(this),Kw(this))};function dp(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Kw(l){l.g=new vr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Hn(l.qa);Se(h,"RID","rpc"),Se(h,"SID",l.K),Se(h,"AID",l.T),Se(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&Se(h,"TO",l.ja),Se(h,"TYPE","xmlhttp"),Ta(l,h),l.m&&l.o&&cp(h,l.m,l.o),l.L&&(l.g.I=l.L);var f=l.g;l=l.ia,f.L=1,f.v=Gc(Hn(h)),f.m=null,f.P=!0,Cw(f,l)}n.Za=function(){this.C!=null&&(this.C=null,Kc(this),hp(this),Et(19))};function Yc(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Qw(l,h){var f=null;if(l.g==h){Yc(l),dp(l),l.g=null;var g=2}else if(ap(l.h,h))f=h.D,Sw(l.h,h),g=1;else return;if(l.G!=0){if(h.o)if(g==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var b=l.B;g=Lc(),Ct(g,new _w(g,f)),Qc(l)}else Hw(l);else if(b=h.s,b==3||b==0&&0<h.X||!(g==1&&TP(l,h)||g==2&&hp(l)))switch(f&&0<f.length&&(h=l.h,h.i=h.i.concat(f)),b){case 1:ci(l,5);break;case 4:ci(l,10);break;case 3:ci(l,6);break;default:ci(l,2)}}}function Yw(l,h){let f=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(f*=2),f*h}function ci(l,h){if(l.j.info("Error code "+h),h==2){var f=m(l.fb,l),g=l.Xa;let b=!g;g=new li(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||$c(g,"https"),Gc(g),b?yP(g.toString(),f):vP(g.toString(),f)}else Et(2);l.G=0,l.l&&l.l.sa(h),Jw(l),zw(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function Jw(l){if(l.G=0,l.ka=[],l.l){let h=Rw(l.h);(h.length!=0||l.i.length!=0)&&(x(l.ka,h),x(l.ka,l.i),l.h.i.length=0,k(l.i),l.i.length=0),l.l.ra()}}function Xw(l,h,f){var g=f instanceof li?Hn(f):new li(f);if(g.g!="")h&&(g.g=h+"."+g.g),zc(g,g.s);else{var b=a.location;g=b.protocol,h=h?h+"."+b.hostname:b.hostname,b=+b.port;var D=new li(null);g&&$c(D,g),h&&(D.g=h),b&&zc(D,b),f&&(D.l=f),g=D}return f=l.D,h=l.ya,f&&h&&Se(g,f,h),Se(g,"VER",l.la),Ta(l,g),g}function Zw(l,h,f){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new Le(new Ca({eb:f})):new Le(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function eC(){}n=eC.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Jc(){}Jc.prototype.g=function(l,h){return new Nt(l,h)};function Nt(l,h){ht.call(this),this.g=new $w(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!K(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!K(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new gs(this)}T(Nt,ht),Nt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nt.prototype.close=function(){up(this.g)},Nt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var f={};f.__data__=l,l=f}else this.u&&(f={},f.__data__=Xf(l),l=f);h.i.push(new lP(h.Ya++,l)),h.G==3&&Qc(h)},Nt.prototype.N=function(){this.g.l=null,delete this.j,up(this.g),delete this.g,Nt.aa.N.call(this)};function tC(l){ep.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(let f in h){l=f;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}T(tC,ep);function nC(){tp.call(this),this.status=1}T(nC,tp);function gs(l){this.g=l}T(gs,eC),gs.prototype.ua=function(){Ct(this.g,"a")},gs.prototype.ta=function(l){Ct(this.g,new tC(l))},gs.prototype.sa=function(l){Ct(this.g,new nC)},gs.prototype.ra=function(){Ct(this.g,"b")},Jc.prototype.createWebChannel=Jc.prototype.g,Nt.prototype.send=Nt.prototype.o,Nt.prototype.open=Nt.prototype.m,Nt.prototype.close=Nt.prototype.close,Jm=ar.createWebChannelTransport=function(){return new Jc},Ym=ar.getStatEventTarget=function(){return Lc()},Qm=ar.Event=oi,Eh=ar.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bc.NO_ERROR=0,Bc.TIMEOUT=8,Bc.HTTP_ERROR=6,Pl=ar.ErrorCode=Bc,yw.COMPLETE="complete",Km=ar.EventType=yw,fw.EventType=fa,fa.OPEN="a",fa.CLOSE="b",fa.ERROR="c",fa.MESSAGE="d",ht.prototype.listen=ht.prototype.K,so=ar.WebChannel=fw,DN=ar.FetchXmlHttpFactory=Ca,Le.prototype.listenOnce=Le.prototype.L,Le.prototype.getLastError=Le.prototype.Ka,Le.prototype.getLastErrorCode=Le.prototype.Ba,Le.prototype.getStatus=Le.prototype.Z,Le.prototype.getResponseJson=Le.prototype.Oa,Le.prototype.getResponseText=Le.prototype.oa,Le.prototype.send=Le.prototype.ea,Le.prototype.setWithCredentials=Le.prototype.Ha,Hm=ar.XhrIo=Le}).apply(typeof Ch<"u"?Ch:typeof self<"u"?self:typeof window<"u"?window:{});var mT="@firebase/firestore",_T="4.7.11";var Ye=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ye.UNAUTHENTICATED=new Ye(null),Ye.GOOGLE_CREDENTIALS=new Ye("google-credentials-uid"),Ye.FIRST_PARTY=new Ye("first-party-uid"),Ye.MOCK_USER=new Ye("mock-user");var Go="11.6.1";var jr=new Rs("@firebase/firestore");function fo(){return jr.logLevel}function uv(n){jr.setLogLevel(n)}function N(n,...e){if(jr.logLevel<=Zt.DEBUG){let t=e.map(hv);jr.debug(`Firestore (${Go}): ${n}`,...t)}}function $e(n,...e){if(jr.logLevel<=Zt.ERROR){let t=e.map(hv);jr.error(`Firestore (${Go}): ${n}`,...t)}}function wn(n,...e){if(jr.logLevel<=Zt.WARN){let t=e.map(hv);jr.warn(`Firestore (${Go}): ${n}`,...t)}}function hv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function q(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,xA(n,r,t)}function xA(n,e,t){let r=`FIRESTORE (${Go}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw $e(r),new Error(r)}function H(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||xA(e,i,r)}function kA(n,e){n||q(57014,e)}function L(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends ZC{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Fh=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},s_=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ye.UNAUTHENTICATED))}shutdown(){}},o_=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},a_=class{constructor(e){this.t=e,this.currentUser=Ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new et,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>R(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new et)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(H(typeof r.accessToken=="string",31837,{l:r}),new Fh(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string",2055,{h:e}),new Ye(e)}},l_=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ye.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},c_=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new l_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Oh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},u_=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){H(this.o===void 0,3512);let r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,N("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Oh(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Oh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function xN(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function dv(){return new TextEncoder}var Vh=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=xN(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function h_(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return ee(r,i);{let s=dv(),o=kN(s.encode(yT(n,t)),s.encode(yT(e,t)));return o!==0?o:ee(r,i)}}t+=r>65535?2:1}return ee(n.length,e.length)}function yT(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function kN(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ee(n[t],e[t]);return ee(n.length,e.length)}function Eo(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function MA(n){return n+"\0"}var vT=-62135596800,wT=1e6,Ve=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*wT);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<vT)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wT}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-vT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Y=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ve(0,0))}static max(){return new n(new Ve(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var CT="__name__",Uh=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&q(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&q(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return ee(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):h_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return or.fromString(e.substring(4,e.length-2))}},pe=class n extends Uh{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},MN=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ze=class n extends Uh{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return MN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CT}static keyField(){return new n([CT])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};var Io=-1,bo=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function d_(n){return n.fields.find(e=>e.kind===2)}function Ni(n){return n.fields.filter(e=>e.kind!==2)}bo.UNKNOWN_ID=-1;var vo=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var ql=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,sn.min())}};function NA(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(r===1e9?new Ve(t+1,0):new Ve(t,r));return new sn(i,B.empty(),e)}function FA(n){return new sn(n.readTime,n.key,Io)}var sn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Y.min(),B.empty(),Io)}static max(){return new n(Y.max(),B.empty(),Io)}};function fv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}var OA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Xr(n){return R(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==OA)throw n;N("LocalStore","Unexpectedly lost primary lease")})}var S=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;t(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var $t="SimpleDb",Bh=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new qi(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new et,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new qi(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=pv(r.target.error);this.S.reject(new qi(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(N($t,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new p_(t)}},qr=class n{static delete(e){return N($t,"Removing database:",e),Oi(Mp().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!gu())return!1;if(n.F())return!0;let e=Fa(),t=n.M(e),r=0<t&&t<10,i=VA(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,n.M(Fa())===12.2&&$e("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}k(e){return R(this,null,function*(){return this.db||(N($t,"Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new qi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new M(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new M(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new qi(e,o))},i.onupgradeneeded=s=>{N($t,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;if(this.L!==null&&this.L!==s.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${s.oldVersion}, event.newVersion=${s.newVersion}, db.version=${o.version}`);this.B.q(o,i.transaction,s.oldVersion,this.version).next(()=>{N($t,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{let r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db})}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return R(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.k(e);let a=Bh.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.v(),u)).catch(u=>(a.abort(u),S.reject(u))).toPromise();return c.catch(()=>{}),yield a.D,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(N($t,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function VA(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var f_=class{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Oi(this.K.delete())}},qi=class extends M{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Zr(n){return n.name==="IndexedDbTransactionError"}var p_=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(N($t,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(N($t,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oi(r)}add(e){return N($t,"ADD",this.store.name,e,e),Oi(this.store.add(e))}get(e){return Oi(this.store.get(e)).next(t=>(t===void 0&&(t=null),N($t,"GET",this.store.name,e,t),t))}delete(e){return N($t,"DELETE",this.store.name,e),Oi(this.store.delete(e))}count(){return N($t,"COUNT",this.store.name),Oi(this.store.count())}J(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new S((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.Y(s,(a,c)=>{o.push(c)}).next(()=>o)}}Z(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new S((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}X(e,t){N($t,"DELETE ALL",this.store.name);let r=this.options(e,t);r.ee=!1;let i=this.cursor(r);return this.Y(i,(s,o,a)=>a.delete())}te(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.Y(i,t)}ne(e){let t=this.cursor({});return new S((r,i)=>{t.onerror=s=>{let o=pv(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}Y(e,t){let r=[];return new S((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new f_(a),u=t(a.primaryKey,a.value,c);if(u instanceof S){let d=u.catch(p=>(c.done(),S.reject(p)));r.push(d)}c.isDone?i():c.j===null?a.continue():a.continue(c.j)}}).next(()=>S.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Oi(n){return new S((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=pv(r.target.error);t(i)}})}var ET=!1;function pv(n){let e=qr.M(Fa());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ET||(ET=!0,setTimeout(()=>{throw r},0)),r}}return n}var Ol="IndexBackfiller",g_=class{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){N(Ol,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>R(this,null,function*(){this.task=null;try{let t=yield this.re.se();N(Ol,`Documents written: ${t}`)}catch(t){Zr(t)?N(Ol,"Ignoring IndexedDB error during index backfill: ",t):yield Xr(t)}yield this.ie(6e4)}))}},m_=class{constructor(e,t){this.localStore=e,this.persistence=t}se(e=50){return R(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))})}oe(e,t){let r=new Set,i=t,s=!0;return S.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return N(Ol,`Processing collection: ${o}`),this._e(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(i,s)).next(a=>(N(Ol,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}ae(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=FA(s);fv(o,r)>0&&(r=o)}),new sn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var zt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>r.writeSequenceNumber(i))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ce&&this.ce(t),t}}n.le=-1;return n})(),Lr=-1;function fc(n){return n==null}function $l(n){return n===0&&1/n==-1/0}function UA(n){return typeof n=="number"&&Number.isInteger(n)&&!$l(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var jh="";function wt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=IT(e)),e=NN(n.get(t),e);return IT(e)}function NN(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case jh:t+="";break;default:t+=s}}return t}function IT(n){return n+jh+""}function On(n){let e=n.length;if(H(e>=2,64408,{path:n}),e===2)return H(n.charAt(0)===jh&&n.charAt(1)==="",56145,{path:n}),pe.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf(jh,s);switch((o<0||o>t)&&q(50515,{path:n}),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:q(61167,{path:n})}s=o+2}return new pe(r)}var Fi="remoteDocuments",pc="owner",oo="owner",zl="mutationQueues",FN="userId",vn="mutations",bT="batchId",Bi="userMutationsIndex",TT=["userId","batchId"];function Rh(n,e){return[n,wt(e)]}function LA(n,e,t){return[n,wt(e),t]}var ON={},To="documentMutations",qh="remoteDocumentsV14",VN=["prefixPath","collectionGroup","readTime","documentId"],Ph="documentKeyIndex",UN=["prefixPath","collectionGroup","documentId"],BA="collectionGroupIndex",LN=["collectionGroup","readTime","prefixPath","documentId"],Gl="remoteDocumentGlobal",__="remoteDocumentGlobalKey",Ao="targets",jA="queryTargetsIndex",BN=["canonicalId","targetId"],So="targetDocuments",jN=["targetId","path"],gv="documentTargetsIndex",qN=["path","targetId"],$h="targetGlobalKey",$i="targetGlobal",Wl="collectionParents",$N=["collectionId","parent"],Ro="clientMetadata",zN="clientId",Bd="bundles",GN="bundleId",jd="namedQueries",WN="name",mv="indexConfiguration",HN="indexId",y_="collectionGroupIndex",KN="collectionGroup",zh="indexState",QN=["indexId","uid"],qA="sequenceNumberIndex",YN=["uid","sequenceNumber"],Gh="indexEntries",JN=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$A="documentKeyIndex",XN=["indexId","uid","orderedDocumentKey"],qd="documentOverlays",ZN=["userId","collectionPath","documentId"],v_="collectionPathOverlayIndex",e2=["userId","collectionPath","largestBatchId"],zA="collectionGroupOverlayIndex",t2=["userId","collectionGroup","largestBatchId"],_v="globals",n2="name",GA=[zl,vn,To,Fi,Ao,pc,$i,So,Ro,Gl,Wl,Bd,jd],r2=[...GA,qd],WA=[zl,vn,To,qh,Ao,pc,$i,So,Ro,Gl,Wl,Bd,jd,qd],HA=WA,yv=[...HA,mv,zh,Gh],i2=yv,s2=[...yv,_v];var Hl=class extends Lh{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}};function tt(n,e){let t=L(n);return qr.N(t.he,e)}function AT(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ei(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function KA(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var De=class n{constructor(e,t){this.comparator=e,this.root=t||Un.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Un.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yo(this.root,e,this.comparator,!1)}getReverseIterator(){return new yo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yo(this.root,e,this.comparator,!0)}},yo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Un=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw q(43730,{key:this.key,value:this.value});if(this.right.isRed())throw q(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw q(27949);return e+(this.isRed()?0:1)}};Un.EMPTY=null,Un.RED=!0,Un.BLACK=!1;Un.EMPTY=new class{constructor(){this.size=0}get key(){throw q(57766)}get value(){throw q(16141)}get color(){throw q(16727)}get left(){throw q(29726)}get right(){throw q(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ee=class n{constructor(e){this.comparator=e,this.data=new De(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wh(this.data.getIterator())}getIteratorFrom(e){return new Wh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Wh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ao(n){return n.hasNext()?n.getNext():void 0}var Gt=class n{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ee(ze.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Eo(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Hh=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function QA(){return typeof atob<"u"}var We=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Hh("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};We.EMPTY_BYTE_STRING=new We("");var o2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ur(n){if(H(!!n,39018),typeof n=="string"){let e=0,t=o2.exec(n);if(H(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ne(n.seconds),nanos:Ne(n.nanos)}}function Ne(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function hr(n){return typeof n=="string"?We.fromBase64String(n):We.fromUint8Array(n)}var YA="server_timestamp",JA="__type__",XA="__previous_value__",ZA="__local_write_time__";function $d(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[JA])===null||t===void 0?void 0:t.stringValue)===YA}function zd(n){let e=n.mapValue.fields[XA];return $d(e)?zd(e):e}function Kl(n){let e=ur(n.mapValue.fields[ZA].timestampValue);return new Ve(e.seconds,e.nanos)}var w_=class{constructor(e,t,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Kh="(default)",$r=class n{constructor(e,t){this.projectId=e,this.database=t||Kh}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Kh}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var vv="__type__",eS="__max__",Vr={mapValue:{fields:{__type__:{stringValue:eS}}}},wv="__vector__",Po="value",Dh={nullValue:"NULL_VALUE"};function zr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$d(n)?4:tS(n)?9007199254740991:Gd(n)?10:11:q(28295,{value:n})}function jn(n,e){if(n===e)return!0;let t=zr(n);if(t!==zr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kl(n).isEqual(Kl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=ur(i.timestampValue),a=ur(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return hr(i.bytesValue).isEqual(hr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ne(i.geoPointValue.latitude)===Ne(s.geoPointValue.latitude)&&Ne(i.geoPointValue.longitude)===Ne(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ne(i.integerValue)===Ne(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ne(i.doubleValue),a=Ne(s.doubleValue);return o===a?$l(o)===$l(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Eo(n.arrayValue.values||[],e.arrayValue.values||[],jn);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(AT(o)!==AT(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!jn(o[c],a[c])))return!1;return!0}(n,e);default:return q(52216,{left:n})}}function Ql(n,e){return(n.values||[]).find(t=>jn(t,e))!==void 0}function Gr(n,e){if(n===e)return 0;let t=zr(n),r=zr(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ne(s.integerValue||s.doubleValue),c=Ne(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return ST(n.timestampValue,e.timestampValue);case 4:return ST(Kl(n),Kl(e));case 5:return h_(n.stringValue,e.stringValue);case 6:return function(s,o){let a=hr(s),c=hr(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=ee(a[u],c[u]);if(d!==0)return d}return ee(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ee(Ne(s.latitude),Ne(o.latitude));return a!==0?a:ee(Ne(s.longitude),Ne(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return RT(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,u,d;let p=s.fields||{},m=o.fields||{},y=(a=p[Po])===null||a===void 0?void 0:a.arrayValue,T=(c=m[Po])===null||c===void 0?void 0:c.arrayValue,k=ee(((u=y?.values)===null||u===void 0?void 0:u.length)||0,((d=T?.values)===null||d===void 0?void 0:d.length)||0);return k!==0?k:RT(y,T)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Vr.mapValue&&o===Vr.mapValue)return 0;if(s===Vr.mapValue)return 1;if(o===Vr.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let p=0;p<c.length&&p<d.length;++p){let m=h_(c[p],d[p]);if(m!==0)return m;let y=Gr(a[c[p]],u[d[p]]);if(y!==0)return y}return ee(c.length,d.length)}(n.mapValue,e.mapValue);default:throw q(23264,{Pe:t})}}function ST(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=ur(n),r=ur(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function RT(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Gr(t[i],r[i]);if(s)return s}return ee(t.length,r.length)}function Do(n){return C_(n)}function C_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=ur(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return hr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=C_(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${C_(t.fields[o])}`;return i+"}"}(n.mapValue):q(61005,{value:n})}function xh(n){switch(zr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=zd(n);return e?16+xh(e):16;case 5:return 2*n.stringValue.length;case 6:return hr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+xh(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return ei(r.fields,(s,o)=>{i+=s.length+xh(o)}),i}(n.mapValue);default:throw q(13486,{value:n})}}function zi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function E_(n){return!!n&&"integerValue"in n}function Yl(n){return!!n&&"arrayValue"in n}function PT(n){return!!n&&"nullValue"in n}function DT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kh(n){return!!n&&"mapValue"in n}function Gd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[vv])===null||t===void 0?void 0:t.stringValue)===wv}function Vl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ei(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Vl(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function tS(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===eS}var nS={mapValue:{fields:{[vv]:{stringValue:wv},[Po]:{arrayValue:{}}}}};function a2(n){return"nullValue"in n?Dh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?zi($r.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Gd(n)?nS:{mapValue:{}}:q(35942,{value:n})}function l2(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?zi($r.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?nS:"mapValue"in n?Gd(n)?{mapValue:{}}:Vr:q(61959,{value:n})}function xT(n,e){let t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function kT(n,e){let t=Gr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var vt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!kh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vl(t)}setAll(e){let t=ze.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Vl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());kh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];kh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ei(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Vl(this.value))}};function rS(n){let e=[];return ei(n.fields,(t,r)=>{let i=new ze([t]);if(kh(r)){let s=rS(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Gt(e)}var Je=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Y.min(),Y.min(),Y.min(),vt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Y.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Y.min(),Y.min(),vt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Y.min(),Y.min(),vt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var qn=class{constructor(e,t){this.position=e,this.inclusive=t}};function MT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(o.referenceValue),t.key):r=Gr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function NT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!jn(n.position[t],e.position[t]))return!1;return!0}var Gi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function c2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Qh=class{},ce=class n extends Qh{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new T_(e,t,r):t==="array-contains"?new R_(e,r):t==="in"?new Yh(e,r):t==="not-in"?new P_(e,r):t==="array-contains-any"?new D_(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new A_(e,r):new S_(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Gr(t,this.value)):t!==null&&zr(this.value)===zr(t)&&this.matchesComparison(Gr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ve=class n extends Qh{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new n(e,t)}matches(e){return xo(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}};function xo(n){return n.op==="and"}function I_(n){return n.op==="or"}function Cv(n){return iS(n)&&xo(n)}function iS(n){for(let e of n.filters)if(e instanceof ve)return!1;return!0}function b_(n){if(n instanceof ce)return n.field.canonicalString()+n.op.toString()+Do(n.value);if(Cv(n))return n.filters.map(e=>b_(e)).join(",");{let e=n.filters.map(t=>b_(t)).join(",");return`${n.op}(${e})`}}function sS(n,e){return n instanceof ce?function(r,i){return i instanceof ce&&r.op===i.op&&r.field.isEqual(i.field)&&jn(r.value,i.value)}(n,e):n instanceof ve?function(r,i){return i instanceof ve&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&sS(o,i.filters[a]),!0):!1}(n,e):void q(19439)}function oS(n,e){let t=n.filters.concat(e);return ve.create(t,n.op)}function aS(n){return n instanceof ce?function(t){return`${t.field.canonicalString()} ${t.op} ${Do(t.value)}`}(n):n instanceof ve?function(t){return t.op.toString()+" {"+t.getFilters().map(aS).join(" ,")+"}"}(n):"Filter"}var T_=class extends ce{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},A_=class extends ce{constructor(e,t){super(e,"in",t),this.keys=lS("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},S_=class extends ce{constructor(e,t){super(e,"not-in",t),this.keys=lS("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function lS(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var R_=class extends ce{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Yl(t)&&Ql(t.arrayValue,this.value)}},Yh=class extends ce{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ql(this.value.arrayValue,t)}},P_=class extends ce{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ql(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ql(this.value.arrayValue,t)}},D_=class extends ce{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Yl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ql(this.value.arrayValue,r))}};var x_=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Ie=null}};function k_(n,e=null,t=[],r=[],i=null,s=null,o=null){return new x_(n,e,t,r,i,s,o)}function Wi(n){let e=L(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>b_(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),fc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Do(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Do(r)).join(",")),e.Ie=t}return e.Ie}function gc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!c2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!sS(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!NT(n.startAt,e.startAt)&&NT(n.endAt,e.endAt)}function Jh(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Xh(n,e){return n.filters.filter(t=>t instanceof ce&&t.field.isEqual(e))}function FT(n,e,t){let r=Dh,i=!0;for(let s of Xh(n,e)){let o=Dh,a=!0;switch(s.op){case"<":case"<=":o=a2(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Dh}xT({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];xT({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function OT(n,e,t){let r=Vr,i=!0;for(let s of Xh(n,e)){let o=Vr,a=!0;switch(s.op){case">=":case">":o=l2(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Vr}kT({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];kT({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Cn=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}};function cS(n,e,t,r,i,s,o,a){return new Cn(n,e,t,r,i,s,o,a)}function Wo(n){return new Cn(n)}function VT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ev(n){return n.collectionGroup!==null}function wo(n){let e=L(n);if(e.Ee===null){e.Ee=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ee(ze.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new Gi(s,r))}),t.has(ze.keyField().canonicalString())||e.Ee.push(new Gi(ze.keyField(),r))}return e.Ee}function At(n){let e=L(n);return e.de||(e.de=u2(e,wo(n))),e.de}function u2(n,e){if(n.limitType==="F")return k_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Gi(i.field,s)});let t=n.endAt?new qn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new qn(n.startAt.position,n.startAt.inclusive):null;return k_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function M_(n,e){let t=n.filters.concat([e]);return new Cn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Zh(n,e,t){return new Cn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function mc(n,e){return gc(At(n),At(e))&&n.limitType===e.limitType}function uS(n){return`${Wi(At(n))}|lt:${n.limitType}`}function po(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>aS(i)).join(", ")}]`),fc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Do(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Do(i)).join(",")),`Target(${r})`}(At(n))}; limitType=${n.limitType})`}function _c(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of wo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=MT(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,wo(r),i)||r.endAt&&!function(o,a,c){let u=MT(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,wo(r),i))}(n,e)}function hS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function dS(n){return(e,t)=>{let r=!1;for(let i of wo(n)){let s=h2(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function h2(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Gr(c,u):q(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return q(19790,{direction:n.dir})}}var En=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ei(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return KA(this.inner)}size(){return this.innerSize}};var d2=new De(B.comparator);function kt(){return d2}var fS=new De(B.comparator);function Nl(...n){let e=fS;for(let t of n)e=e.insert(t.key,t);return e}function pS(n){let e=fS;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Vn(){return Ul()}function gS(){return Ul()}function Ul(){return new En(n=>n.toString(),(n,e)=>n.isEqual(e))}var f2=new De(B.comparator),p2=new Ee(B.comparator);function ae(...n){let e=p2;for(let t of n)e=e.add(t);return e}var g2=new Ee(ee);function Iv(){return g2}function bv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$l(e)?"-0":e}}function mS(n){return{integerValue:""+n}}function _S(n,e){return UA(e)?mS(e):bv(n,e)}var ko=class{constructor(){this._=void 0}};function m2(n,e,t){return n instanceof Wr?function(i,s){let o={fields:{[JA]:{stringValue:YA},[ZA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&$d(s)&&(s=zd(s)),s&&(o.fields[XA]=s),{mapValue:o}}(t,e):n instanceof dr?vS(n,e):n instanceof fr?wS(n,e):function(i,s){let o=yS(i,s),a=UT(o)+UT(i.Re);return E_(o)&&E_(i.Re)?mS(a):bv(i.serializer,a)}(n,e)}function _2(n,e,t){return n instanceof dr?vS(n,e):n instanceof fr?wS(n,e):t}function yS(n,e){return n instanceof Hr?function(r){return E_(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Wr=class extends ko{},dr=class extends ko{constructor(e){super(),this.elements=e}};function vS(n,e){let t=CS(e);for(let r of n.elements)t.some(i=>jn(i,r))||t.push(r);return{arrayValue:{values:t}}}var fr=class extends ko{constructor(e){super(),this.elements=e}};function wS(n,e){let t=CS(e);for(let r of n.elements)t=t.filter(i=>!jn(i,r));return{arrayValue:{values:t}}}var Hr=class extends ko{constructor(e,t){super(),this.serializer=e,this.Re=t}};function UT(n){return Ne(n.integerValue||n.doubleValue)}function CS(n){return Yl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Hi=class{constructor(e,t){this.field=e,this.transform=t}};function y2(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof dr&&i instanceof dr||r instanceof fr&&i instanceof fr?Eo(r.elements,i.elements,jn):r instanceof Hr&&i instanceof Hr?jn(r.Re,i.Re):r instanceof Wr&&i instanceof Wr}(n.transform,e.transform)}var N_=class{constructor(e,t){this.version=e,this.transformResults=t}},je=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Mh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Mo=class{};function ES(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qr(n.key,je.none()):new Kr(n.key,n.data,je.none());{let t=n.data,r=vt.empty(),i=new Ee(ze.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new In(n.key,r,new Gt(i.toArray()),je.none())}}function v2(n,e,t){n instanceof Kr?function(i,s,o){let a=i.value.clone(),c=BT(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof In?function(i,s,o){if(!Mh(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=BT(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(IS(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Ll(n,e,t,r){return n instanceof Kr?function(s,o,a,c){if(!Mh(s.precondition,o))return a;let u=s.value.clone(),d=jT(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof In?function(s,o,a,c){if(!Mh(s.precondition,o))return a;let u=jT(s.fieldTransforms,c,o),d=o.data;return d.setAll(IS(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(s,o,a){return Mh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function w2(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=yS(r.transform,i||null);s!=null&&(t===null&&(t=vt.empty()),t.set(r.field,s))}return t||null}function LT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Eo(r,i,(s,o)=>y2(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Kr=class extends Mo{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},In=class extends Mo{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function IS(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function BT(n,e,t){let r=new Map;H(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,_2(o,a,t[i]))}return r}function jT(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,m2(s,o,e))}return r}var Qr=class extends Mo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Jl=class extends Mo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Xl=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&v2(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ll(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ll(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=gS();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=ES(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ae())}isEqual(e){return this.batchId===e.batchId&&Eo(this.mutations,e.mutations,(t,r)=>LT(t,r))&&Eo(this.baseMutations,e.baseMutations,(t,r)=>LT(t,r))}},F_=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){H(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return f2}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Zl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var O_=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ke,fe;function bS(n){switch(n){case P.OK:return q(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return q(15467,{code:n})}}function TS(n){if(n===void 0)return $e("GRPC error has no .code"),P.UNKNOWN;switch(n){case Ke.OK:return P.OK;case Ke.CANCELLED:return P.CANCELLED;case Ke.UNKNOWN:return P.UNKNOWN;case Ke.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Ke.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Ke.INTERNAL:return P.INTERNAL;case Ke.UNAVAILABLE:return P.UNAVAILABLE;case Ke.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Ke.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Ke.NOT_FOUND:return P.NOT_FOUND;case Ke.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Ke.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Ke.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Ke.ABORTED:return P.ABORTED;case Ke.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Ke.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Ke.DATA_LOSS:return P.DATA_LOSS;default:return q(39323,{code:n})}}(fe=Ke||(Ke={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var qT=null;var C2=new or([4294967295,4294967295],0);function $T(n){let e=dv().encode(n),t=new Wm;return t.update(e),new Uint8Array(t.digest())}function zT(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new or([t,r],0),new or([i,s],0)]}var V_=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ji(`Invalid padding: ${t}`);if(r<0)throw new ji(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ji(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ji(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=or.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(or.fromNumber(r)));return i.compare(C2)===1&&(i=new or([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;let t=$T(e),[r,i]=zT(t);for(let s=0;s<this.hashCount;s++){let o=this.we(r,i,s);if(!this.be(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.pe===0)return;let t=$T(e),[r,i]=zT(t);for(let s=0;s<this.hashCount;s++){let o=this.we(r,i,s);this.Se(o)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ji=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ec=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,tc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Y.min(),i,new De(ee),kt(),ae())}},tc=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ae(),ae(),ae())}};var Co=class{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}},ed=class{constructor(e,t){this.targetId=e,this.Ce=t}},td=class{constructor(e,t,r=We.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},nd=class{constructor(){this.Fe=0,this.Me=GT(),this.xe=We.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=ae(),t=ae(),r=ae();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:q(38017,{changeType:s})}}),new tc(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=GT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,H(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}},U_=class{constructor(e){this.ze=e,this.je=new Map,this.He=kt(),this.Je=Ih(),this.Ye=Ih(),this.Ze=new De(ee)}Xe(e){for(let t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(let t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{let r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:q(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){let t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){let s=i.target;if(Jh(s))if(r===0){let o=new B(s.path);this.tt(t,o,Je.newNoDocument(o,Y.min()))}else H(r===1,20013,{expectedCount:r});else{let o=this.ut(t);if(o!==r){let a=this.ct(e),c=a?this.lt(a,e,o):1;if(c!==0){this.st(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}qT?.ht(function(d,p,m,y,T){var k,x,W,K,F,X;let re={localCacheCount:d,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},ie=p.unchangedNames;return ie&&(re.bloomFilter={applied:T===0,hashCount:(k=ie?.hashCount)!==null&&k!==void 0?k:0,bitmapLength:(K=(W=(x=ie?.bits)===null||x===void 0?void 0:x.bitmap)===null||W===void 0?void 0:W.length)!==null&&K!==void 0?K:0,padding:(X=(F=ie?.bits)===null||F===void 0?void 0:F.padding)!==null&&X!==void 0?X:0,mightContain:C=>{var _;return(_=y?.mightContain(C))!==null&&_!==void 0&&_}}),re}(o,e.Ce,this.ze.Pt(),a,c))}}}}ct(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=hr(r).toUint8Array()}catch(c){if(c instanceof Hh)return wn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new V_(o,i,s)}catch(c){return wn(c instanceof ji?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.pe===0?null:a}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){let r=this.ze.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.tt(t,s,null),i++)}),i}It(e){let t=new Map;this.je.forEach((s,o)=>{let a=this._t(o);if(a){if(s.current&&Jh(a.target)){let c=new B(a.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Je.newNoDocument(c,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let r=ae();this.Ye.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));let i=new ec(e,t,this.Ze,this.He,r);return this.He=kt(),this.Je=Ih(),this.Ye=Ih(),this.Ze=new De(ee),i}et(e,t){if(!this.it(e))return;let r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;let i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){let t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new nd,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ee(ee),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ee(ee),this.Je=this.Je.insert(e,t)),t}it(e){let t=this._t(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}_t(e){let t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new nd),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}};function Ih(){return new De(B.comparator)}function GT(){return new De(B.comparator)}var E2={asc:"ASCENDING",desc:"DESCENDING"},I2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},b2={and:"AND",or:"OR"},L_=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function B_(n,e){return n.useProto3Json||fc(e)?e:{value:e}}function No(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function AS(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function T2(n,e){return No(n,e.toTimestamp())}function Ge(n){return H(!!n,49232),Y.fromTimestamp(function(t){let r=ur(t);return new Ve(r.seconds,r.nanos)}(n))}function Tv(n,e){return j_(n,e).canonicalString()}function j_(n,e){let t=function(i){return new pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function SS(n){let e=pe.fromString(n);return H(VS(e),10190,{key:e.toString()}),e}function nc(n,e){return Tv(n.databaseId,e.path)}function Ln(n,e){let t=SS(e);if(t.get(1)!==n.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(DS(t))}function RS(n,e){return Tv(n.databaseId,e)}function PS(n){let e=SS(n);return e.length===4?pe.emptyPath():DS(e)}function q_(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function DS(n){return H(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function WT(n,e,t){return{name:nc(n,e),fields:t.value.mapValue.fields}}function xS(n,e,t){let r=Ln(n,e.name),i=Ge(e.updateTime),s=e.createTime?Ge(e.createTime):Y.min(),o=new vt({mapValue:{fields:e.fields}}),a=Je.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function A2(n,e){return"found"in e?function(r,i){H(!!i.found,43571),i.found.name,i.found.updateTime;let s=Ln(r,i.found.name),o=Ge(i.found.updateTime),a=i.found.createTime?Ge(i.found.createTime):Y.min(),c=new vt({mapValue:{fields:i.found.fields}});return Je.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){H(!!i.missing,3894),H(!!i.readTime,22933);let s=Ln(r,i.missing),o=Ge(i.readTime);return Je.newNoDocument(s,o)}(n,e):q(7234,{result:e})}function S2(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:q(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(H(d===void 0||typeof d=="string",58123),We.fromBase64String(d||"")):(H(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),We.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let d=u.code===void 0?P.UNKNOWN:TS(u.code);return new M(d,u.message||"")}(o);t=new td(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ln(n,r.document.name),s=Ge(r.document.updateTime),o=r.document.createTime?Ge(r.document.createTime):Y.min(),a=new vt({mapValue:{fields:r.document.fields}}),c=Je.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new Co(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ln(n,r.document),s=r.readTime?Ge(r.readTime):Y.min(),o=Je.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Co([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ln(n,r.document),s=r.removedTargetIds||[];t=new Co([],s,i,null)}else{if(!("filter"in e))return q(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new O_(i,s),a=r.targetId;t=new ed(a,o)}}return t}function rc(n,e){let t;if(e instanceof Kr)t={update:WT(n,e.key,e.value)};else if(e instanceof Qr)t={delete:nc(n,e.key)};else if(e instanceof In)t={update:WT(n,e.key,e.data),updateMask:M2(e.fieldMask)};else{if(!(e instanceof Jl))return q(16599,{ft:e.type});t={verify:nc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Wr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof dr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof fr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Hr)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw q(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:T2(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q(27497)}(n,e.precondition)),t}function $_(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?je.updateTime(Ge(s.updateTime)):s.exists!==void 0?je.exists(s.exists):je.none()}(e.currentDocument):je.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)H(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Wr;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new dr(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new fr(d)}else"increment"in a?c=new Hr(o,a.increment):q(16584,{proto:a});let u=ze.fromServerFormat(a.fieldPath);return new Hi(u,c)}(n,i)):[];if(e.update){e.update.name;let i=Ln(n,e.update.name),s=new vt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new Gt(u.map(d=>ze.fromServerFormat(d)))}(e.updateMask);return new In(i,s,o,t,r)}return new Kr(i,s,t,r)}if(e.delete){let i=Ln(n,e.delete);return new Qr(i,t)}if(e.verify){let i=Ln(n,e.verify);return new Jl(i,t)}return q(1463,{proto:e})}function R2(n,e){return n&&n.length>0?(H(e!==void 0,14353),n.map(t=>function(i,s){let o=i.updateTime?Ge(i.updateTime):Ge(s);return o.isEqual(Y.min())&&(o=Ge(s)),new N_(o,i.transformResults||[])}(t,e))):[]}function kS(n,e){return{documents:[RS(n,e.path)]}}function MS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=RS(n,i);let s=function(u){if(u.length!==0)return OS(ve.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:go(m.field),direction:D2(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=B_(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:t,parent:i}}function NS(n){let e=PS(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){H(r===1,65062);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(p){let m=FS(p);return m instanceof ve&&Cv(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(m=>function(T){return new Gi(mo(T.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,fc(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,y=p.values||[];return new qn(y,m)}(t.startAt));let u=null;return t.endAt&&(u=function(p){let m=!p.before,y=p.values||[];return new qn(y,m)}(t.endAt)),cS(e,i,o,s,a,"F",c,u)}function P2(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function FS(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=mo(t.unaryFilter.field);return ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=mo(t.unaryFilter.field);return ce.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=mo(t.unaryFilter.field);return ce.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=mo(t.unaryFilter.field);return ce.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return q(61313);default:return q(60726)}}(n):n.fieldFilter!==void 0?function(t){return ce.create(mo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return q(58110);default:return q(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ve.create(t.compositeFilter.filters.map(r=>FS(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q(1026)}}(t.compositeFilter.op))}(n):q(30097,{filter:n})}function D2(n){return E2[n]}function x2(n){return I2[n]}function k2(n){return b2[n]}function go(n){return{fieldPath:n.canonicalString()}}function mo(n){return ze.fromServerFormat(n.fieldPath)}function OS(n){return n instanceof ce?function(t){if(t.op==="=="){if(DT(t.value))return{unaryFilter:{field:go(t.field),op:"IS_NAN"}};if(PT(t.value))return{unaryFilter:{field:go(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(DT(t.value))return{unaryFilter:{field:go(t.field),op:"IS_NOT_NAN"}};if(PT(t.value))return{unaryFilter:{field:go(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:go(t.field),op:x2(t.op),value:t.value}}}(n):n instanceof ve?function(t){let r=t.getFilters().map(i=>OS(i));return r.length===1?r[0]:{compositeFilter:{op:k2(t.op),filters:r}}}(n):q(54877,{filter:n})}function M2(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function VS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Fo=class n{constructor(e,t,r,i,s=Y.min(),o=Y.min(),a=We.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var rd=class{constructor(e){this.wt=e}};function N2(n,e){let t;if(e.document)t=xS(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=Qi(e.noDocument.readTime);t=Je.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return q(56709);{let r=B.fromSegments(e.unknownDocument.path),i=Qi(e.unknownDocument.version);t=Je.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Ve(i[0],i[1]);return Y.fromTimestamp(s)}(e.readTime)),t}function HT(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:id(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:nc(s,o.key),fields:o.data.value.mapValue.fields,updateTime:No(s,o.version.toTimestamp()),createTime:No(s,o.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ki(e.version)};else{if(!e.isUnknownDocument())return q(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ki(e.version)}}return r}function id(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ki(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Qi(n){let e=new Ve(n.seconds,n.nanoseconds);return Y.fromTimestamp(e)}function Vi(n,e){let t=(e.baseMutations||[]).map(s=>$_(n.wt,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>$_(n.wt,s)),i=Ve.fromMillis(e.localWriteTimeMs);return new Xl(e.batchId,i,t,r)}function Fl(n){let e=Qi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Qi(n.lastLimboFreeSnapshotVersion):Y.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){let o=s.documents.length;return H(o===1,1966,{count:o}),At(Wo(PS(s.documents[0])))}(n.query):function(s){return At(NS(s))}(n.query),new Fo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,We.fromBase64String(n.resumeToken))}function US(n,e){let t=Ki(e.snapshotVersion),r=Ki(e.lastLimboFreeSnapshotVersion),i;i=Jh(e.target)?kS(n.wt,e.target):MS(n.wt,e.target).gt;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Av(n){let e=NS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Zh(e,e.limit,"L"):e}function Xm(n,e){return new Zl(e.largestBatchId,$_(n.wt,e.overlayMutation))}function KT(n,e){let t=e.path.lastSegment();return[n,wt(e.path.popLast()),t]}function QT(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ki(r.readTime),documentKey:wt(r.documentKey.path),largestBatchId:r.largestBatchId}}var z_=class{getBundleMetadata(e,t){return YT(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Qi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return YT(e).put(function(i){return{bundleId:i.id,createTime:Ki(Ge(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return JT(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:Av(s.bundledQuery),readTime:Qi(s.readTime)}}(r)})}saveNamedQuery(e,t){return JT(e).put(function(i){return{name:i.name,readTime:Ki(Ge(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function YT(n){return tt(n,Bd)}function JT(n){return tt(n,jd)}var sd=class n{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Dl(e).get(KT(this.userId,t)).next(r=>r?Xm(this.serializer,r):null)}getOverlays(e,t){let r=Vn();return S.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Zl(t,o);i.push(this.St(e,a))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(wt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Dl(e).X(v_,a))}),S.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Vn(),s=wt(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Dl(e).J(v_,o).next(a=>{for(let c of a){let u=Xm(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=Vn(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Dl(e).te({index:zA,range:a},(c,u,d)=>{let p=Xm(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}St(e,t){return Dl(e).put(function(i,s,o){let[a,c,u]=KT(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:rc(i.wt,o.mutation)}}(this.serializer,this.userId,t))}};function Dl(n){return tt(n,qd)}var G_=class{Dt(e){return tt(e,_v)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{let r=t?.value;return r?We.fromUint8Array(r):We.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var lr=class{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(Ne(e.integerValue));else if("doubleValue"in e){let r=Ne(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),$l(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=ur(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(hr(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?tS(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Gd(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):q(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){let r=e.fields||{};this.Mt(t,55);for(let i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;let s=e.fields||{};this.Mt(t,53);let o=Po,a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(Ne(a)),this.Nt(o,t),this.Ct(s[o],t)}$t(e,t){let r=e.values||[];this.Mt(t,50);for(let i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),B.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}};lr.Wt=new lr;var lo=255;function F2(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function XT(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=F2(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var W_=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{let i=t.codePointAt(0);this.zt(240|i>>>18),this.zt(128|63&i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i)}}this.jt()}Xt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{let i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Yt()}en(e){let t=this.tn(e),r=XT(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}rn(e){let t=this.tn(e),r=XT(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}sn(){this._n(lo),this._n(255)}an(){this.un(lo),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}zt(e){let t=255&e;t===0?(this._n(0),this._n(255)):t===lo?(this._n(lo),this._n(0)):this._n(t)}Jt(e){let t=255&e;t===0?(this.un(0),this.un(255)):t===lo?(this.un(lo),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},H_=class{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}},K_=class{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}},Ui=class{constructor(){this.ln=new W_,this.hn=new H_(this.ln),this.Pn=new K_(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}};var Li=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}In(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Mr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=ZT(n.arrayValue,e.arrayValue),t!==0?t:(t=ZT(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function ZT(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var od=class{constructor(e){this.En=new Ee((t,r)=>ze.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.An=[];for(let t of e.filters){let r=t;r.isInequality()?this.En=this.En.add(r):this.An.push(r)}}get Rn(){return this.En.size>1}Vn(e){if(H(e.collectionGroup===this.collectionId,49279),this.Rn)return!1;let t=d_(e);if(t!==void 0&&!this.mn(t))return!1;let r=Ni(e),i=new Set,s=0,o=0;for(;s<r.length&&this.mn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.En.size>0){let a=this.En.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.fn(a,c)||!this.gn(this.dn[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.dn.length||!this.gn(this.dn[o++],a))return!1}return!0}pn(){if(this.Rn)return null;let e=new Ee(ze.comparator),t=[];for(let r of this.An)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new vo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new vo(r.field,0))}for(let r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new vo(r.field,r.dir==="asc"?0:1)));return new bo(bo.UNKNOWN_ID,this.collectionId,t,ql.empty())}mn(e){for(let t of this.An)if(this.fn(t,e))return!0;return!1}fn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}gn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function LS(n){var e,t;if(H(n instanceof ce||n instanceof ve,20012),n instanceof ce){if(n instanceof Yh){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ce.create(n.field,"==",s)))||[];return ve.create(i,"or")}return n}let r=n.filters.map(i=>LS(i));return ve.create(r,n.op)}function O2(n){if(n.getFilters().length===0)return[];let e=J_(LS(n));return H(BS(e),7391),Q_(e)||Y_(e)?[e]:e.getFilters()}function Q_(n){return n instanceof ce}function Y_(n){return n instanceof ve&&Cv(n)}function BS(n){return Q_(n)||Y_(n)||function(t){if(t instanceof ve&&I_(t)){for(let r of t.getFilters())if(!Q_(r)&&!Y_(r))return!1;return!0}return!1}(n)}function J_(n){if(H(n instanceof ce||n instanceof ve,34018),n instanceof ce)return n;if(n.filters.length===1)return J_(n.filters[0]);let e=n.filters.map(r=>J_(r)),t=ve.create(e,n.op);return t=ad(t),BS(t)?t:(H(t instanceof ve,64498),H(xo(t),40251),H(t.filters.length>1,57927),t.filters.reduce((r,i)=>Sv(r,i)))}function Sv(n,e){let t;return H(n instanceof ce||n instanceof ve,38388),H(e instanceof ce||e instanceof ve,25473),t=n instanceof ce?e instanceof ce?function(i,s){return ve.create([i,s],"and")}(n,e):eA(n,e):e instanceof ce?eA(e,n):function(i,s){if(H(i.filters.length>0&&s.filters.length>0,48005),xo(i)&&xo(s))return oS(i,s.getFilters());let o=I_(i)?i:s,a=I_(i)?s:i,c=o.filters.map(u=>Sv(u,a));return ve.create(c,"or")}(n,e),ad(t)}function eA(n,e){if(xo(e))return oS(e,n.getFilters());{let t=e.filters.map(r=>Sv(n,r));return ve.create(t,"or")}}function ad(n){if(H(n instanceof ce||n instanceof ve,11850),n instanceof ce)return n;let e=n.getFilters();if(e.length===1)return ad(e[0]);if(iS(n))return n;let t=e.map(i=>ad(i)),r=[];return t.forEach(i=>{i instanceof ce?r.push(i):i instanceof ve&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ve.create(r,n.op)}var X_=class{constructor(){this.yn=new ic}addToCollectionParentIndex(e,t){return this.yn.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(sn.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(sn.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}},ic=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ee(pe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ee(pe.comparator)).toArray()}};var tA="IndexedDbIndexManager",bh=new Uint8Array(0),Z_=class{constructor(e,t){this.databaseId=t,this.wn=new ic,this.bn=new En(r=>Wi(r),(r,i)=>gc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.wn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.wn.add(t)});let s={collectionId:r,parent:wt(i)};return nA(e).put(s)}return S.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[MA(t),""],!1,!0);return nA(e).J(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(On(o.parent))}return r})}addFieldIndex(e,t){let r=xl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=uo(e);return s.next(a=>{o.put(QT(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=xl(e),i=uo(e),s=co(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=xl(e),r=co(e),i=uo(e);return t.X().next(()=>r.X()).next(()=>i.X())}createTargetIndexes(e,t){return S.forEach(this.Sn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new od(r).pn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=co(e),i=!0,s=new Map;return S.forEach(this.Sn(t),o=>this.Dn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ae(),a=[];return S.forEach(s,(c,u)=>{N(tA,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(X=>`${X.fieldPath}:${X.kind}`).join(",")}`}(c)} to execute ${Wi(t)}`);let d=function(F,X){let re=d_(X);if(re===void 0)return null;for(let ie of Xh(F,re.fieldPath))switch(ie.op){case"array-contains-any":return ie.value.arrayValue.values||[];case"array-contains":return[ie.value]}return null}(u,c),p=function(F,X){let re=new Map;for(let ie of Ni(X))for(let C of Xh(F,ie.fieldPath))switch(C.op){case"==":case"in":re.set(ie.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return re.set(ie.fieldPath.canonicalString(),C.value),Array.from(re.values())}return null}(u,c),m=function(F,X){let re=[],ie=!0;for(let C of Ni(X)){let _=C.kind===0?FT(F,C.fieldPath,F.startAt):OT(F,C.fieldPath,F.startAt);re.push(_.value),ie&&(ie=_.inclusive)}return new qn(re,ie)}(u,c),y=function(F,X){let re=[],ie=!0;for(let C of Ni(X)){let _=C.kind===0?OT(F,C.fieldPath,F.endAt):FT(F,C.fieldPath,F.endAt);re.push(_.value),ie&&(ie=_.inclusive)}return new qn(re,ie)}(u,c),T=this.vn(c,u,m),k=this.vn(c,u,y),x=this.Cn(c,u,p),W=this.Fn(c.indexId,d,T,m.inclusive,k,y.inclusive,x);return S.forEach(W,K=>r.Z(K,t.limit).next(F=>{F.forEach(X=>{let re=B.fromSegments(X.documentKey);o.has(re)||(o=o.add(re),a.push(re))})}))}).next(()=>a)}return S.resolve(null)})}Sn(e){let t=this.bn.get(e);return t||(e.filters.length===0?t=[e]:t=O2(ve.create(e.filters,"and")).map(r=>k_(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.bn.set(e,t),t)}Fn(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),u=c/(t!=null?t.length:1),d=[];for(let p=0;p<c;++p){let m=t?this.Mn(t[p/u]):bh,y=this.xn(e,m,r[p%u],i),T=this.On(e,m,s[p%u],o),k=a.map(x=>this.xn(e,m,x,!0));d.push(...this.createRange(y,T,k))}return d}xn(e,t,r,i){let s=new Li(e,B.empty(),t,r);return i?s:s.In()}On(e,t,r,i){let s=new Li(e,B.empty(),t,r);return i?s.In():s}Dn(e,t){let r=new od(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.Vn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.Sn(t);return S.forEach(i,s=>this.Dn(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Ee(ze.comparator),d=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:u=u.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Nn(e,t){let r=new Ui;for(let i of Ni(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Tn(i.kind);lr.Wt.vt(s,o)}return r.cn()}Mn(e){let t=new Ui;return lr.Wt.vt(e,t.Tn(0)),t.cn()}Bn(e,t){let r=new Ui;return lr.Wt.vt(zi(this.databaseId,t),r.Tn(function(s){let o=Ni(s);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Cn(e,t,r){if(r===null)return[];let i=[];i.push(new Ui);let s=0;for(let o of Ni(e)){let a=r[s++];for(let c of i)if(this.Ln(t,o.fieldPath)&&Yl(a))i=this.kn(i,o,a);else{let u=c.Tn(o.kind);lr.Wt.vt(a,u)}}return this.qn(i)}vn(e,t,r){return this.Cn(e,t,r.position)}qn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}kn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Ui;c.seed(a.cn()),lr.Wt.vt(o,c.Tn(t.kind)),s.push(c)}return s}Ln(e,t){return!!e.filters.find(r=>r instanceof ce&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=xl(e),i=uo(e);return(t?r.J(y_,IDBKeyRange.bound(t,t)):r.J()).next(s=>{let o=[];return S.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,p){let m=p?new ql(p.sequenceNumber,new sn(Qi(p.readTime),new B(On(p.documentKey)),p.largestBatchId)):ql.empty(),y=d.fields.map(([T,k])=>new vo(ze.fromServerFormat(T),k));return new bo(d.indexId,d.collectionGroup,y,m)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ee(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=xl(e),s=uo(e);return this.Qn(e).next(o=>i.J(y_,IDBKeyRange.bound(t,t)).next(a=>S.forEach(a,c=>s.put(QT(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return S.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?S.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),S.forEach(a,c=>this.$n(e,i,c).next(u=>{let d=this.Un(s,c);return u.isEqual(d)?S.resolve():this.Kn(e,s,c,u,d)}))))})}Wn(e,t,r,i){return co(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Bn(r,t.key),documentKey:t.key.path.toArray()})}Gn(e,t,r,i){return co(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Bn(r,t.key),t.key.path.toArray()])}$n(e,t,r){let i=co(e),s=new Ee(Mr);return i.te({index:$A,range:IDBKeyRange.only([r.indexId,this.uid,this.Bn(r,t)])},(o,a)=>{s=s.add(new Li(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Un(e,t){let r=new Ee(Mr),i=this.Nn(t,e);if(i==null)return r;let s=d_(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Yl(o))for(let a of o.arrayValue.values||[])r=r.add(new Li(t.indexId,e.key,this.Mn(a),i))}else r=r.add(new Li(t.indexId,e.key,bh,i));return r}Kn(e,t,r,i,s){N(tA,"Updating index entries for document '%s'",t.key);let o=[];return function(c,u,d,p,m){let y=c.getIterator(),T=u.getIterator(),k=ao(y),x=ao(T);for(;k||x;){let W=!1,K=!1;if(k&&x){let F=d(k,x);F<0?K=!0:F>0&&(W=!0)}else k!=null?K=!0:W=!0;W?(p(x),x=ao(T)):K?(m(k),k=ao(y)):(k=ao(y),x=ao(T))}}(i,s,Mr,a=>{o.push(this.Wn(e,t,r,a))},a=>{o.push(this.Gn(e,t,r,a))}),S.waitFor(o)}Qn(e){let t=1;return uo(e).te({index:qA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Mr(o,a)).filter((o,a,c)=>!a||Mr(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Mr(o,e),c=Mr(o,t);if(a===0)i[0]=e.In();else if(a>0&&c<0)i.push(o),i.push(o.In());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.zn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,bh,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,bh,[]];s.push(IDBKeyRange.bound(a,c))}return s}zn(e,t){return Mr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(rA)}getMinOffset(e,t){return S.mapArray(this.Sn(t),r=>this.Dn(e,r).next(i=>i||q(44426))).next(rA)}};function nA(n){return tt(n,Wl)}function co(n){return tt(n,Gh)}function xl(n){return tt(n,mv)}function uo(n){return tt(n,zh)}function rA(n){H(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;fv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new sn(e.readTime,e.documentKey,t)}var iA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jS=41943040,xt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function qS(n,e,t){let r=n.store(vn),i=n.store(To),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.te({range:o},(d,p,m)=>(a++,m.delete()));s.push(c.next(()=>{H(a===1,47070,{batchId:t.batchId})}));let u=[];for(let d of t.mutations){let p=LA(e,d.key.path,t.batchId);s.push(i.delete(p)),u.push(d.key)}return S.waitFor(s).next(()=>u)}function ld(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw q(14731);e=n.noDocument}return JSON.stringify(e).length}xt.DEFAULT_COLLECTION_PERCENTILE=10,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xt.DEFAULT=new xt(jS,xt.DEFAULT_COLLECTION_PERCENTILE,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xt.DISABLED=new xt(-1,0,0);var cd=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.jn={}}static bt(e,t,r,i){H(e.uid!=="",64387);let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Nr(e).te({index:Bi,range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=_o(e),o=Nr(e);return o.add({}).next(a=>{H(typeof a=="number",49019);let c=new Xl(a,t,r,i),u=function(y,T,k){let x=k.baseMutations.map(K=>rc(y.wt,K)),W=k.mutations.map(K=>rc(y.wt,K));return{userId:T,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:x,mutations:W}}(this.serializer,this.userId,c),d=[],p=new Ee((m,y)=>ee(m.canonicalString(),y.canonicalString()));for(let m of i){let y=LA(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(u)),d.push(s.put(y,ON))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.jn[a]=c.keys()}),S.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return Nr(e).get(t).next(r=>r?(H(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Vi(this.serializer,r)):null)}Hn(e,t){return this.jn[t]?S.resolve(this.jn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.jn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Nr(e).te({index:Bi,range:i},(o,a,c)=>{a.userId===this.userId&&(H(a.batchId>=r,47524,{Jn:r}),s=Vi(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Lr;return Nr(e).te({index:Bi,range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Lr],[this.userId,Number.POSITIVE_INFINITY]);return Nr(e).J(Bi,t).next(r=>r.map(i=>Vi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Rh(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return _o(e).te({range:i},(o,a,c)=>{let[u,d,p]=o,m=On(d);if(u===this.userId&&t.path.isEqual(m))return Nr(e).get(p).next(y=>{if(!y)throw q(61480,{Yn:o,batchId:p});H(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:p}),s.push(Vi(this.serializer,y))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ee(ee),i=[];return t.forEach(s=>{let o=Rh(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=_o(e).te({range:a},(u,d,p)=>{let[m,y,T]=u,k=On(y);m===this.userId&&s.path.isEqual(k)?r=r.add(T):p.done()});i.push(c)}),S.waitFor(i).next(()=>this.Zn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Rh(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ee(ee);return _o(e).te({range:o},(c,u,d)=>{let[p,m,y]=c,T=On(m);p===this.userId&&r.isPrefixOf(T)?T.length===i&&(a=a.add(y)):d.done()}).next(()=>this.Zn(e,a))}Zn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Nr(e).get(s).next(o=>{if(o===null)throw q(35274,{batchId:s});H(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Vi(this.serializer,o))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return qS(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Xn(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Xn(e){delete this.jn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return _o(e).te({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=On(s[1]);i.push(c)}else a.done()}).next(()=>{H(i.length===0,56720,{er:i.map(s=>s.canonicalString())})})})}containsKey(e,t){return $S(e,this.userId,t)}tr(e){return zS(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Lr,lastStreamToken:""})}};function $S(n,e,t){let r=Rh(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return _o(n).te({range:s,ee:!0},(a,c,u)=>{let[d,p,m]=a;d===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function Nr(n){return tt(n,vn)}function _o(n){return tt(n,To)}function zS(n){return tt(n,zl)}var Oo=class n{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new n(0)}static ir(){return new n(-1)}};var ey=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.sr(e).next(t=>{let r=new Oo(t.highestTargetId);return t.highestTargetId=r.next(),this._r(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.sr(e).next(t=>Y.fromTimestamp(new Ve(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.sr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.sr(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this._r(e,i)))}addTargetData(e,t){return this.ar(e,t).next(()=>this.sr(e).next(r=>(r.targetCount+=1,this.ur(t,r),this._r(e,r))))}updateTargetData(e,t){return this.ar(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ho(e).delete(t.targetId)).next(()=>this.sr(e)).next(r=>(H(r.targetCount>0,8065),r.targetCount-=1,this._r(e,r)))}removeTargets(e,t,r){let i=0,s=[];return ho(e).te((o,a)=>{let c=Fl(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>S.waitFor(s)).next(()=>i)}forEachTarget(e,t){return ho(e).te((r,i)=>{let s=Fl(i);t(s)})}sr(e){return sA(e).get($h).next(t=>(H(t!==null,2888),t))}_r(e,t){return sA(e).put($h,t)}ar(e,t){return ho(e).put(US(this.serializer,t))}ur(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.sr(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Wi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return ho(e).te({range:i,index:jA},(o,a,c)=>{let u=Fl(a);gc(t,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Or(e);return t.forEach(o=>{let a=wt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),S.waitFor(i)}removeMatchingKeys(e,t,r){let i=Or(e);return S.forEach(t,s=>{let o=wt(s.path);return S.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Or(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Or(e),s=ae();return i.te({range:r,ee:!0},(o,a,c)=>{let u=On(o[1]),d=new B(u);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=wt(t.path),i=IDBKeyRange.bound([r],[MA(r)],!1,!0),s=0;return Or(e).te({index:gv,ee:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}Rt(e,t){return ho(e).get(t).next(r=>r?Fl(r):null)}};function ho(n){return tt(n,Ao)}function sA(n){return tt(n,$i)}function Or(n){return tt(n,So)}var oA="LruGarbageCollector",V2=1048576;function aA([n,e],[t,r]){let i=ee(n,t);return i===0?ee(e,r):i}var ty=class{constructor(e){this.cr=e,this.buffer=new Ee(aA),this.lr=0}hr(){return++this.lr}Pr(e){let t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();aA(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},ud=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){N(oA,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>R(this,null,function*(){this.Tr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Zr(t)?N(oA,"Ignoring IndexedDB error during garbage collection: ",t):yield Xr(t)}yield this.Ir(3e5)}))}},ny=class{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return S.resolve(zt.le);let r=new ty(t);return this.Er.forEachTarget(e,i=>r.Pr(i.sequenceNumber)).next(()=>this.Er.Ar(e,i=>r.Pr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Er.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(iA)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iA):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let r,i,s,o,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),fo()<=Zt.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function GS(n,e){return new ny(n,e)}var ry=class{constructor(e,t){this.db=e,this.garbageCollector=GS(this,t)}dr(e){let t=this.Vr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ar(e,t){return this.mr(e,(r,i)=>t(i))}addReference(e,t,r){return Th(e,r)}removeReference(e,t,r){return Th(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Th(e,t)}gr(e,t){return function(i,s){let o=!1;return zS(i).ne(a=>$S(i,a,s).next(c=>(c&&(o=!0),S.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.mr(e,(o,a)=>{if(a<=t){let c=this.gr(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Y.min()),Or(e).delete(function(p){return[0,wt(p.path)]}(o))))});i.push(c)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Th(e,t)}mr(e,t){let r=Or(e),i,s=zt.le;return r.te({index:gv},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==zt.le&&t(new B(On(i)),s),s=u,i=c):s=zt.le}).next(()=>{s!==zt.le&&t(new B(On(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Th(n,e){return Or(n).put(function(r,i){return{targetId:0,path:wt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var hd=class{constructor(){this.changes=new En(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Je.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var iy=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Mi(e).put(r)}removeEntry(e,t,r){return Mi(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],id(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.pr(e,r)))}getEntry(e,t){let r=Je.newInvalidDocument(t);return Mi(e).te({index:Ph,range:IDBKeyRange.only(kl(t))},(i,s)=>{r=this.yr(t,s)}).next(()=>r)}wr(e,t){let r={size:0,document:Je.newInvalidDocument(t)};return Mi(e).te({index:Ph,range:IDBKeyRange.only(kl(t))},(i,s)=>{r={document:this.yr(t,s),size:ld(s)}}).next(()=>r)}getEntries(e,t){let r=kt();return this.br(e,t,(i,s)=>{let o=this.yr(i,s);r=r.insert(i,o)}).next(()=>r)}Sr(e,t){let r=kt(),i=new De(B.comparator);return this.br(e,t,(s,o)=>{let a=this.yr(s,o);r=r.insert(s,a),i=i.insert(s,ld(o))}).next(()=>({documents:r,Dr:i}))}br(e,t,r){if(t.isEmpty())return S.resolve();let i=new Ee(uA);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(kl(i.first()),kl(i.last())),o=i.getIterator(),a=o.getNext();return Mi(e).te({index:Ph,range:s},(c,u,d)=>{let p=B.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&uA(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.H(kl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),id(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Mi(e).J(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let d=kt();for(let p of u){let m=this.yr(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(_c(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=kt(),o=cA(t,r),a=cA(t,sn.max());return Mi(e).te({index:BA,range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{let p=this.yr(B.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new sy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return lA(e).get(__).next(t=>(H(!!t,20021),t))}pr(e,t){return lA(e).put(__,t)}yr(e,t){if(t){let r=N2(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Y.min())))return r}return Je.newInvalidDocument(e)}};function WS(n){return new iy(n)}var sy=class extends hd{constructor(e,t){super(),this.vr=e,this.trackRemovals=t,this.Cr=new En(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ee((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.Cr.get(s);if(t.push(this.vr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=HT(this.vr.serializer,o);i=i.add(s.path.popLast());let u=ld(c);r+=u-a.size,t.push(this.vr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=HT(this.vr.serializer,o.convertToNoDocument(Y.min()));t.push(this.vr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.vr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.vr.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this.vr.wr(e,t).next(r=>(this.Cr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.vr.Sr(e,t).next(({documents:r,Dr:i})=>(i.forEach((s,o)=>{this.Cr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function lA(n){return tt(n,Gl)}function Mi(n){return tt(n,qh)}function kl(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cA(n,e){let t=e.documentKey.path.toArray();return[n,id(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function uA(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ee(t[s],r[s]),i)return i;return i=ee(t.length,r.length),i||(i=ee(t[t.length-2],r[r.length-2]),i||ee(t[t.length-1],r[r.length-1]))}var oy=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var dd=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ll(r.mutation,i,Gt.empty(),Ve.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ae()){let i=Vn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Nl();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Vn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ae()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=kt(),o=Ul(),a=function(){return Ul()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof In)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Ll(d.mutation,u,d.mutation.getFieldMask(),Ve.now())):o.set(u.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var p;return a.set(u,new oy(d,(p=o.get(u))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Ul(),i=new De((o,a)=>o-a),s=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||Gt.empty();d=a.applyToLocalView(u,d),r.set(c,d);let p=(i.get(a.batchId)||ae()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,p=gS();d.forEach(m=>{if(!s.has(m)){let y=ES(t.get(m),r.get(m));y!==null&&p.set(m,y),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return S.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return B.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ev(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):S.resolve(Vn()),a=Io,c=s;return o.next(u=>S.forEach(u,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?S.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,ae())).next(d=>({batchId:a,changes:pS(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=Nl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Nl();return this.indexManager.getCollectionParents(e,s).next(a=>S.forEach(a,c=>{let u=function(p,m){return new Cn(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,u)=>{let d=u.getKey();o.get(d)===null&&(o=o.insert(d,Je.newInvalidDocument(d)))});let a=Nl();return o.forEach((c,u)=>{let d=s.get(c);d!==void 0&&Ll(d.mutation,u,Gt.empty(),Ve.now()),_c(t,u)&&(a=a.insert(c,u))}),a})}};var ay=class{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return S.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ge(i.createTime)}}(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(i){return{name:i.name,query:Av(i.bundledQuery),readTime:Ge(i.readTime)}}(t)),S.resolve()}};var ly=class{constructor(){this.overlays=new De(B.comparator),this.Or=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Vn();return S.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),S.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Or.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Or.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){let i=Vn(),s=t.length+1,o=new B(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new De((u,d)=>u-d),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Vn(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=Vn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return S.resolve(a)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Or.get(i.largestBatchId).delete(r.key);this.Or.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Zl(t,r));let s=this.Or.get(t);s===void 0&&(s=ae(),this.Or.set(t,s)),this.Or.set(t,s.add(r.key))}};var cy=class{constructor(){this.sessionToken=We.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}};var sc=class{constructor(){this.Nr=new Ee(Qe.Br),this.Lr=new Ee(Qe.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){let r=new Qe(e,t);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Qr(new Qe(e,t))}$r(e,t){e.forEach(r=>this.removeReference(r,t))}Ur(e){let t=new B(new pe([])),r=new Qe(t,e),i=new Qe(t,e+1),s=[];return this.Lr.forEachInRange([r,i],o=>{this.Qr(o),s.push(o.key)}),s}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){let t=new B(new pe([])),r=new Qe(t,e),i=new Qe(t,e+1),s=ae();return this.Lr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Qe(e,0),r=this.Nr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Qe=class{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return B.comparator(e.key,t.key)||ee(e.Gr,t.Gr)}static kr(e,t){return ee(e.Gr,t.Gr)||B.comparator(e.key,t.key)}};var uy=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new Ee(Qe.Br)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Xl(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.zr=this.zr.add(new Qe(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return S.resolve(o)}lookupMutationBatch(e,t){return S.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Hr(r),s=i<0?0:i;return S.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?Lr:this.Jn-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Qe(t,0),i=new Qe(t,Number.POSITIVE_INFINITY),s=[];return this.zr.forEachInRange([r,i],o=>{let a=this.jr(o.Gr);s.push(a)}),S.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ee(ee);return t.forEach(i=>{let s=new Qe(i,0),o=new Qe(i,Number.POSITIVE_INFINITY);this.zr.forEachInRange([s,o],a=>{r=r.add(a.Gr)})}),S.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let o=new Qe(new B(s),0),a=new Ee(ee);return this.zr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Gr)),!0)},o),S.resolve(this.Jr(a))}Jr(e){let t=[];return e.forEach(r=>{let i=this.jr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return S.forEach(t.mutations,i=>{let s=new Qe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,t){let r=new Qe(t,0),i=this.zr.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){let t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var hy=class{constructor(e){this.Zr=e,this.docs=function(){return new De(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Zr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Je.newInvalidDocument(t))}getEntries(e,t){let r=kt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Je.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=kt(),o=t.path,a=new B(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||fv(FA(d),r)<=0||(i.has(d.key)||_c(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return S.resolve(s)}getAllFromCollectionGroup(e,t,r,i){q(9500)}Xr(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new dy(this)}getSize(e){return S.resolve(this.size)}},dy=class extends hd{constructor(e){super(),this.vr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.vr.addEntry(e,i)):this.vr.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}};var fy=class{constructor(e){this.persistence=e,this.ei=new En(t=>Wi(t),gc),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.ti=0,this.ni=new sc,this.targetCount=0,this.ri=Oo.rr()}forEachTarget(e,t){return this.ei.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ti&&(this.ti=t),S.resolve()}ar(e){this.ei.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ri=new Oo(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.ar(t),S.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ei.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ei.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),S.waitFor(s).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){let r=this.ei.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.ni.qr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.ni.$r(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),S.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),S.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ni.Wr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.ni.containsKey(t))}};var oc=class{constructor(e,t){this.ii={},this.overlays={},this.si=new zt(0),this.oi=!1,this.oi=!0,this._i=new cy,this.referenceDelegate=e(this),this.ai=new fy(this),this.indexManager=new X_,this.remoteDocumentCache=function(i){return new hy(i)}(r=>this.referenceDelegate.ui(r)),this.serializer=new rd(t),this.ci=new ay(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ly,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ii[e.toKey()];return r||(r=new uy(t,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);let i=new py(this.si.next());return this.referenceDelegate.li(),r(i).next(s=>this.referenceDelegate.hi(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Pi(e,t){return S.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,t)))}},py=class extends Lh{constructor(e){super(),this.currentSequenceNumber=e}},fd=class n{constructor(e){this.persistence=e,this.Ti=new sc,this.Ii=null}static Ei(e){return new n(e)}get di(){if(this.Ii)return this.Ii;throw q(60996)}addReference(e,t,r){return this.Ti.addReference(r,t),this.di.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Ti.removeReference(r,t),this.di.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),S.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.di,r=>{let i=B.fromPath(r);return this.Ai(e,i).next(s=>{s||t.removeEntry(i,Y.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return S.or([()=>S.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}},pd=class n{constructor(e,t){this.persistence=e,this.Ri=new En(r=>wt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=GS(this,t)}static Ei(e,t){return new n(e,t)}li(){}hi(e){return S.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Vr(e){let t=0;return this.Ar(e,r=>{t++}).next(()=>t)}Ar(e,t){return S.forEach(this.Ri,(r,i)=>this.gr(e,r,i).next(s=>s?S.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Xr(e,o=>this.gr(e,o,t).next(a=>{a||(r++,s.removeEntry(o,Y.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),S.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),S.resolve()}removeReference(e,t,r){return this.Ri.set(r,e.currentSequenceNumber),S.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),S.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xh(e.data.value)),t}gr(e,t,r){return S.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.Ri.get(t);return S.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var gy=class{constructor(e){this.serializer=e}q(e,t,r,i){let s=new Bh("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore(pc)}(e),function(c){c.createObjectStore(zl,{keyPath:FN}),c.createObjectStore(vn,{keyPath:bT,autoIncrement:!0}).createIndex(Bi,TT,{unique:!0}),c.createObjectStore(To)}(e),hA(e),function(c){c.createObjectStore(Fi)}(e));let o=S.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore(So),c.deleteObjectStore(Ao),c.deleteObjectStore($i)}(e),hA(e)),o=o.next(()=>function(c){let u=c.store($i),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return u.put($h,d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(vn).J().next(p=>{c.deleteObjectStore(vn),c.createObjectStore(vn,{keyPath:bT,autoIncrement:!0}).createIndex(Bi,TT,{unique:!0});let m=u.store(vn),y=p.map(T=>m.put(T));return S.waitFor(y)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore(Ro,{keyPath:zN})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Vi(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Gl)}(e),this.mi(s)))),r<7&&i>=7&&(o=o.next(()=>this.fi(s))),r<8&&i>=8&&(o=o.next(()=>this.gi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.pi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(Bd,{keyPath:GN})})(e),function(c){c.createObjectStore(jd,{keyPath:WN})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore(qd,{keyPath:ZN});u.createIndex(v_,e2,{unique:!1}),u.createIndex(zA,t2,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore(qh,{keyPath:VN});u.createIndex(Ph,UN),u.createIndex(BA,LN)}(e)).next(()=>this.yi(e,s)).next(()=>e.deleteObjectStore(Fi))),r<14&&i>=14&&(o=o.next(()=>this.wi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore(mv,{keyPath:HN,autoIncrement:!0}).createIndex(y_,KN,{unique:!1}),c.createObjectStore(zh,{keyPath:QN}).createIndex(qA,YN,{unique:!1}),c.createObjectStore(Gh,{keyPath:JN}).createIndex($A,XN,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore(zh).clear()}).next(()=>{t.objectStore(Gh).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(_v,{keyPath:n2})})(e)})),o}mi(e){let t=0;return e.store(Fi).te((r,i)=>{t+=ld(i)}).next(()=>{let r={byteSize:t};return e.store(Gl).put(__,r)})}Vi(e){let t=e.store(zl),r=e.store(vn);return t.J().next(i=>S.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,Lr],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Bi,o).next(a=>S.forEach(a,c=>{H(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let u=Vi(this.serializer,c);return qS(e,s.userId,u).next(()=>{})}))}))}fi(e){let t=e.store(So),r=e.store(Fi);return e.store($i).get($h).next(i=>{let s=[];return r.te((o,a)=>{let c=new pe(o),u=function(p){return[0,wt(p)]}(c);s.push(t.get(u).next(d=>d?S.resolve():(p=>t.put({targetId:0,path:wt(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>S.waitFor(s))})}gi(e,t){e.createObjectStore(Wl,{keyPath:$N});let r=t.store(Wl),i=new ic,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:wt(c)})}};return t.store(Fi).te({ee:!0},(o,a)=>{let c=new pe(o);return s(c.popLast())}).next(()=>t.store(To).te({ee:!0},([o,a,c],u)=>{let d=On(a);return s(d.popLast())}))}pi(e){let t=e.store(Ao);return t.te((r,i)=>{let s=Fl(i),o=US(this.serializer,s);return t.put(o)})}yi(e,t){let r=t.store(Fi),i=[];return r.te((s,o)=>{let a=t.store(qh),c=function(p){return p.document?new B(pe.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):q(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>S.waitFor(i))}wi(e,t){let r=t.store(vn),i=WS(this.serializer),s=new oc(fd.Ei,this.serializer.wt);return r.J().next(o=>{let a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:ae();Vi(this.serializer,c).keys().forEach(p=>d=d.add(p)),a.set(c.userId,d)}),S.forEach(a,(c,u)=>{let d=new Ye(u),p=sd.bt(this.serializer,d),m=s.getIndexManager(d),y=cd.bt(d,this.serializer,m,s.referenceDelegate);return new dd(i,y,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Hl(t,zt.le),c).next()})})}};function hA(n){n.createObjectStore(So,{keyPath:jN}).createIndex(gv,qN,{unique:!0}),n.createObjectStore(Ao,{keyPath:"targetId"}).createIndex(jA,BN,{unique:!0}),n.createObjectStore($i)}var Fr="IndexedDbPersistence",Zm=18e5,e_=5e3,t_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",HS="main",my=class n{constructor(e,t,r,i,s,o,a,c,u,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.bi=s,this.window=o,this.document=a,this.Si=u,this.Di=d,this.Ci=p,this.si=null,this.oi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fi=null,this.inForeground=!1,this.Mi=null,this.xi=null,this.Oi=Number.NEGATIVE_INFINITY,this.Ni=m=>Promise.resolve(),!n.C())throw new M(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ry(this,i),this.Bi=t+HS,this.serializer=new rd(c),this.Li=new qr(this.Bi,this.Ci,new gy(this.serializer)),this._i=new G_,this.ai=new ey(this.referenceDelegate,this.serializer),this.remoteDocumentCache=WS(this.serializer),this.ci=new z_,this.window&&this.window.localStorage?this.ki=this.window.localStorage:(this.ki=null,d===!1&&$e(Fr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.qi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(P.FAILED_PRECONDITION,t_);return this.Qi(),this.$i(),this.Ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ai.getHighestSequenceNumber(e))}).then(e=>{this.si=new zt(e,this.Si)}).then(()=>{this.oi=!0}).catch(e=>(this.Li&&this.Li.close(),Promise.reject(e)))}Ki(e){return this.Ni=t=>R(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Li.U(t=>R(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.bi.enqueueAndForget(()=>R(this,null,function*(){this.started&&(yield this.qi())})))}qi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ah(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Wi(e).next(t=>{t||(this.isPrimary=!1,this.bi.enqueueRetryable(()=>this.Ni(!1)))})}).next(()=>this.Gi(e)).next(t=>this.isPrimary&&!t?this.zi(e).next(()=>!1):!!t&&this.ji(e).next(()=>!0))).catch(e=>{if(Zr(e))return N(Fr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N(Fr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.bi.enqueueRetryable(()=>this.Ni(e)),this.isPrimary=e})}Wi(e){return Ml(e).get(oo).next(t=>S.resolve(this.Hi(t)))}Ji(e){return Ah(e).delete(this.clientId)}Yi(){return R(this,null,function*(){if(this.isPrimary&&!this.Zi(this.Oi,Zm)){this.Oi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=tt(t,Ro);return r.J().next(i=>{let s=this.Xi(i,Zm),o=i.filter(a=>s.indexOf(a)===-1);return S.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.ki)for(let t of e)this.ki.removeItem(this.es(t.clientId))}})}Ui(){this.xi=this.bi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.qi().then(()=>this.Yi()).then(()=>this.Ui()))}Hi(e){return!!e&&e.ownerId===this.clientId}Gi(e){return this.Di?S.resolve(!0):Ml(e).get(oo).next(t=>{if(t!==null&&this.Zi(t.leaseTimestampMs,e_)&&!this.ts(t.ownerId)){if(this.Hi(t)&&this.networkEnabled)return!0;if(!this.Hi(t)){if(!t.allowTabSynchronization)throw new M(P.FAILED_PRECONDITION,t_);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ah(e).J().next(r=>this.Xi(r,e_).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N(Fr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return R(this,null,function*(){this.oi=!1,this.ns(),this.xi&&(this.xi.cancel(),this.xi=null),this.rs(),this.ss(),yield this.Li.runTransaction("shutdown","readwrite",[pc,Ro],e=>{let t=new Hl(e,zt.le);return this.zi(t).next(()=>this.Ji(t))}),this.Li.close(),this._s()})}Xi(e,t){return e.filter(r=>this.Zi(r.updateTimeMs,t)&&!this.ts(r.clientId))}us(){return this.runTransaction("getActiveClients","readonly",e=>Ah(e).J().next(t=>this.Xi(t,Zm).map(r=>r.clientId)))}get started(){return this.oi}getGlobalsCache(){return this._i}getMutationQueue(e,t){return cd.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Z_(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return sd.bt(this.serializer,e)}getBundleCache(){return this.ci}runTransaction(e,t,r){N(Fr,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?s2:c===16?i2:c===15?yv:c===14?HA:c===13?WA:c===12?r2:c===11?GA:void q(60245)}(this.Ci),o;return this.Li.runTransaction(e,i,s,a=>(o=new Hl(a,this.si?this.si.next():zt.le),t==="readwrite-primary"?this.Wi(o).next(c=>!!c||this.Gi(o)).next(c=>{if(!c)throw $e(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.bi.enqueueRetryable(()=>this.Ni(!1)),new M(P.FAILED_PRECONDITION,OA);return r(o)}).next(c=>this.ji(o).next(()=>c)):this.cs(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}cs(e){return Ml(e).get(oo).next(t=>{if(t!==null&&this.Zi(t.leaseTimestampMs,e_)&&!this.ts(t.ownerId)&&!this.Hi(t)&&!(this.Di||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(P.FAILED_PRECONDITION,t_)})}ji(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ml(e).put(oo,t)}static C(){return qr.C()}zi(e){let t=Ml(e);return t.get(oo).next(r=>this.Hi(r)?(N(Fr,"Releasing primary lease."),t.delete(oo)):S.resolve())}Zi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||($e(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Qi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Mi=()=>{this.bi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.qi()))},this.document.addEventListener("visibilitychange",this.Mi),this.inForeground=this.document.visibilityState==="visible")}rs(){this.Mi&&(this.document.removeEventListener("visibilitychange",this.Mi),this.Mi=null)}$i(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Fi=()=>{this.ns();let t=/(?:Version|Mobile)\/1[456]/;Vp()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.bi.enterRestrictedMode(!0),this.bi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Fi))}ss(){this.Fi&&(this.window.removeEventListener("pagehide",this.Fi),this.Fi=null)}ts(e){var t;try{let r=((t=this.ki)===null||t===void 0?void 0:t.getItem(this.es(e)))!==null;return N(Fr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return $e(Fr,"Failed to get zombied client id.",r),!1}}ns(){if(this.ki)try{this.ki.setItem(this.es(this.clientId),String(Date.now()))}catch(e){$e("Failed to set zombie client id.",e)}}_s(){if(this.ki)try{this.ki.removeItem(this.es(this.clientId))}catch{}}es(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ml(n){return tt(n,pc)}function Ah(n){return tt(n,Ro)}function Rv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var _y=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ls=r,this.hs=i}static Ps(e,t){let r=ae(),i=ae();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var yy=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var gd=class{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return Vp()?8:VA(Fa())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Rs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Vs(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new yy;return this.fs(e,t,o).next(a=>{if(s.result=a,this.Is)return this.gs(e,t,o,a.size)})}).next(()=>s.result)}gs(e,t,r,i){return r.documentReadCount<this.Es?(fo()<=Zt.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",po(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),S.resolve()):(fo()<=Zt.DEBUG&&N("QueryEngine","Query:",po(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(fo()<=Zt.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",po(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,At(t))):S.resolve())}Rs(e,t){if(VT(t))return S.resolve(null);let r=At(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Zh(t,null,"F"),r=At(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ae(...s);return this.As.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.ps(t,a);return this.ys(t,u,o,c.readTime)?this.Rs(e,Zh(t,null,"F")):this.ws(e,u,t,c)}))})))}Vs(e,t,r,i){return VT(t)||i.isEqual(Y.min())?S.resolve(null):this.As.getDocuments(e,r).next(s=>{let o=this.ps(t,s);return this.ys(t,o,r,i)?S.resolve(null):(fo()<=Zt.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),po(t)),this.ws(e,o,t,NA(i,Io)).next(a=>a))})}ps(e,t){let r=new Ee(dS(e));return t.forEach((i,s)=>{_c(e,s)&&(r=r.add(s))}),r}ys(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}fs(e,t,r){return fo()<=Zt.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",po(t)),this.As.getDocumentsMatchingQuery(e,t,sn.min(),r)}ws(e,t,r,i){return this.As.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Pv="LocalStore",U2=3e8,vy=class{constructor(e,t,r,i){this.persistence=e,this.bs=t,this.serializer=i,this.Ss=new De(ee),this.Ds=new En(s=>Wi(s),gc),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dd(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}};function KS(n,e,t,r){return new vy(n,e,t,r)}function QS(n,e){return R(this,null,function*(){let t=L(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Fs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ae();for(let u of i){o.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of s){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({Ms:u,removedBatchIds:o,addedBatchIds:a}))})})})}function L2(n,e){let t=L(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Cs.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let p=u.batch,m=p.keys(),y=S.resolve();return m.forEach(T=>{y=y.next(()=>d.getEntry(c,T)).next(k=>{let x=u.docVersions.get(T);H(x!==null,48541),k.version.compareTo(x)<0&&(p.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),d.addEntry(k)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ae();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function YS(n){let e=L(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function B2(n,e){let t=L(n),r=e.snapshotVersion,i=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Cs.newChangeBuffer({trackRemovals:!0});i=t.Ss;let a=[];e.targetChanges.forEach((d,p)=>{let m=i.get(p);if(!m)return;a.push(t.ai.removeMatchingKeys(s,d.removedDocuments,p).next(()=>t.ai.addMatchingKeys(s,d.addedDocuments,p)));let y=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(We.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(p,y),function(k,x,W){return k.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=U2?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0}(m,y,d)&&a.push(t.ai.updateTargetData(s,y))});let c=kt(),u=ae();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(JS(s,o,e.documentUpdates).next(d=>{c=d.xs,u=d.Os})),!r.isEqual(Y.min())){let d=t.ai.getLastRemoteSnapshotVersion(s).next(p=>t.ai.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return S.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(t.Ss=i,s))}function JS(n,e,t){let r=ae(),i=ae();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=kt();return t.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Y.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):N(Pv,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{xs:o,Os:i}})}function j2(n,e){let t=L(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Lr),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Vo(n,e){let t=L(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.ai.getTargetData(r,e).next(s=>s?(i=s,S.resolve(i)):t.ai.allocateTargetId(r).next(o=>(i=new Fo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.ai.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(r.targetId,r),t.Ds.set(e,r.targetId)),r})}function Uo(n,e,t){return R(this,null,function*(){let r=L(n),i=r.Ss.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Zr(o))throw o;N(Pv,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(i.target)})}function md(n,e,t){let r=L(n),i=Y.min(),s=ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){let p=L(c),m=p.Ds.get(d);return m!==void 0?S.resolve(p.Ss.get(m)):p.ai.getTargetData(u,d)}(r,o,At(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.bs.getDocumentsMatchingQuery(o,e,t?i:Y.min(),t?s:ae())).next(a=>(eR(r,hS(e),a),{documents:a,Ns:s})))}function XS(n,e){let t=L(n),r=L(t.ai),i=t.Ss.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.Rt(s,e).next(o=>o?o.target:null))}function ZS(n,e){let t=L(n),r=t.vs.get(e)||Y.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Cs.getAllFromCollectionGroup(i,e,NA(r,Io),Number.MAX_SAFE_INTEGER)).then(i=>(eR(t,e,i),i))}function eR(n,e,t){let r=n.vs.get(e)||Y.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.vs.set(e,r)}function q2(n,e,t,r){return R(this,null,function*(){let i=L(n),s=ae(),o=kt();for(let u of t){let d=e.Bs(u.metadata.name);u.document&&(s=s.add(d));let p=e.Ls(u);p.setReadTime(e.ks(u.metadata.readTime)),o=o.insert(d,p)}let a=i.Cs.newChangeBuffer({trackRemovals:!0}),c=yield Vo(i,function(d){return At(Wo(pe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>JS(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.ai.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.ai.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.xs,d.Os)).next(()=>d.xs)))})}function $2(r,i){return R(this,arguments,function*(n,e,t=ae()){let s=yield Vo(n,At(Av(e.bundledQuery))),o=L(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Ge(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.ci.saveNamedQuery(a,e);let u=s.withResumeToken(We.EMPTY_BYTE_STRING,c);return o.Ss=o.Ss.insert(u.targetId,u),o.ai.updateTargetData(a,u).next(()=>o.ai.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.ai.addMatchingKeys(a,t,s.targetId)).next(()=>o.ci.saveNamedQuery(a,e))})})}var tR="firestore_clients";function dA(n,e){return`${tR}_${n}_${e}`}var nR="firestore_mutations";function fA(n,e,t){let r=`${nR}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var rR="firestore_targets";function n_(n,e){return`${rR}_${n}_${e}`}var Fn="SharedClientState",_d=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static qs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new M(i.error.code,i.error.message))),o?new n(e,t,i.state,s):($e(Fn,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Qs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Bl=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static qs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new M(r.error.code,r.error.message))),s?new n(e,r.state,i):($e(Fn,`Failed to parse target state for ID '${e}': ${t}`),null)}Qs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},yd=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static qs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Iv();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=UA(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):($e(Fn,`Failed to parse client data for instance '${e}': ${t}`),null)}},wy=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static qs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):($e(Fn,`Failed to parse online state: ${e}`),null)}},ac=class{constructor(){this.activeTargetIds=Iv()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},jl=class{constructor(e,t,r,i,s){this.window=e,this.bi=t,this.persistenceKey=r,this.Ks=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ws=this.Gs.bind(this),this.zs=new De(ee),this.started=!1,this.js=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Hs=dA(this.persistenceKey,this.Ks),this.Js=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.zs=this.zs.insert(this.Ks,new ac),this.Ys=new RegExp(`^${tR}_${o}_([^_]*)$`),this.Zs=new RegExp(`^${nR}_${o}_(\\d+)(?:_(.*))?$`),this.Xs=new RegExp(`^${rR}_${o}_(\\d+)$`),this.eo=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.no=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ws)}static C(e){return!(!e||!e.localStorage)}start(){return R(this,null,function*(){let e=yield this.syncEngine.us();for(let r of e){if(r===this.Ks)continue;let i=this.getItem(dA(this.persistenceKey,r));if(i){let s=yd.qs(r,i);s&&(this.zs=this.zs.insert(s.clientId,s))}}this.ro();let t=this.storage.getItem(this.eo);if(t){let r=this.io(t);r&&this.so(r)}for(let r of this.js)this.Gs(r);this.js=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Js,JSON.stringify(e))}getAllActiveQueryTargets(){return this.oo(this.zs)}isActiveQueryTarget(e){let t=!1;return this.zs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this._o(e,"pending")}updateMutationState(e,t,r){this._o(e,t,r),this.ao(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(n_(this.persistenceKey,e));if(i){let s=Bl.qs(e,i);s&&(r=s.state)}}return t&&this.uo.$s(e),this.ro(),r}removeLocalQueryTarget(e){this.uo.Us(e),this.ro()}isLocalQueryTarget(e){return this.uo.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(n_(this.persistenceKey,e))}updateQueryState(e,t,r){this.co(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.ao(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.lo(e)}notifyBundleLoaded(e){this.ho(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ws),this.removeItem(this.Hs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return N(Fn,"READ",e,t),t}setItem(e,t){N(Fn,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){N(Fn,"REMOVE",e),this.storage.removeItem(e)}Gs(e){let t=e;if(t.storageArea===this.storage){if(N(Fn,"EVENT",t.key,t.newValue),t.key===this.Hs)return void $e("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.bi.enqueueRetryable(()=>R(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ys.test(t.key)){if(t.newValue==null){let r=this.Po(t.key);return this.To(r,null)}{let r=this.Io(t.key,t.newValue);if(r)return this.To(r.clientId,r)}}else if(this.Zs.test(t.key)){if(t.newValue!==null){let r=this.Eo(t.key,t.newValue);if(r)return this.Ao(r)}}else if(this.Xs.test(t.key)){if(t.newValue!==null){let r=this.Ro(t.key,t.newValue);if(r)return this.Vo(r)}}else if(t.key===this.eo){if(t.newValue!==null){let r=this.io(t.newValue);if(r)return this.so(r)}}else if(t.key===this.Js){let r=function(s){let o=zt.le;if(s!=null)try{let a=JSON.parse(s);H(typeof a=="number",30636,{mo:s}),o=a}catch(a){$e(Fn,"Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==zt.le&&this.sequenceNumberHandler(r)}else if(t.key===this.no){let r=this.fo(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.po(i)))}}}else this.js.push(t)}))}}get uo(){return this.zs.get(this.Ks)}ro(){this.setItem(this.Hs,this.uo.Qs())}_o(e,t,r){let i=new _d(this.currentUser,e,t,r),s=fA(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Qs())}ao(e){let t=fA(this.persistenceKey,this.currentUser,e);this.removeItem(t)}lo(e){let t={clientId:this.Ks,onlineState:e};this.storage.setItem(this.eo,JSON.stringify(t))}co(e,t,r){let i=n_(this.persistenceKey,e),s=new Bl(e,t,r);this.setItem(i,s.Qs())}ho(e){let t=JSON.stringify(Array.from(e));this.setItem(this.no,t)}Po(e){let t=this.Ys.exec(e);return t?t[1]:null}Io(e,t){let r=this.Po(e);return yd.qs(r,t)}Eo(e,t){let r=this.Zs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return _d.qs(new Ye(s),i,t)}Ro(e,t){let r=this.Xs.exec(e),i=Number(r[1]);return Bl.qs(i,t)}io(e){return wy.qs(e)}fo(e){return JSON.parse(e)}Ao(e){return R(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.yo(e.batchId,e.state,e.error);N(Fn,`Ignoring mutation for non-active user ${e.user.uid}`)})}Vo(e){return this.syncEngine.wo(e.targetId,e.state,e.error)}To(e,t){let r=t?this.zs.insert(e,t):this.zs.remove(e),i=this.oo(this.zs),s=this.oo(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.bo(o,a).then(()=>{this.zs=r})}so(e){this.zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}oo(e){let t=Iv();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},vd=class{constructor(){this.So=new ac,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,r){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new ac,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Cy=class{vo(e){}shutdown(){}};var pA="ConnectivityMonitor",wd=class{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){N(pA,"Network connectivity changed: AVAILABLE");for(let e of this.Oo)e(0)}xo(){N(pA,"Network connectivity changed: UNAVAILABLE");for(let e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Sh=null;function Ey(){return Sh===null?Sh=function(){return 268435456+Math.round(2147483648*Math.random())}():Sh++,"0x"+Sh.toString(16)}var r_="RestConnection",z2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Iy=class{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${r}/databases/${i}`,this.qo=this.databaseId.database===Kh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Qo(e,t,r,i,s){let o=Ey(),a=this.$o(e,t.toUriEncodedString());N(r_,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};return this.Uo(c,i,s),this.Ko(e,a,c,r).then(u=>(N(r_,`Received RPC '${e}' ${o}: `,u),u),u=>{throw wn(r_,`RPC '${e}' ${o} failed with error: `,u,"url: ",a,"request:",r),u})}Wo(e,t,r,i,s,o){return this.Qo(e,t,r,i,s)}Uo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Go}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}$o(e,t){let r=z2[e];return`${this.Lo}/v1/${t}:${r}`}terminate(){}};var by=class{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}};var yt="WebChannelConnection",Ty=class extends Iy{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,r,i){let s=Ey();return new Promise((o,a)=>{let c=new Hm;c.setWithCredentials(!0),c.listenOnce(Km.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Pl.NO_ERROR:let d=c.getResponseJson();N(yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Pl.TIMEOUT:N(yt,`RPC '${e}' ${s} timed out`),a(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case Pl.HTTP_ERROR:let p=c.getStatus();if(N(yt,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let y=m?.error;if(y&&y.status&&y.message){let T=function(x){let W=x.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(W)>=0?W:P.UNKNOWN}(y.status);a(new M(T,y.message))}else a(new M(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new M(P.UNAVAILABLE,"Connection failed."));break;default:q(9055,{s_:e,streamId:s,o_:c.getLastErrorCode(),__:c.getLastError()})}}finally{N(yt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);N(yt,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",u,r,15)})}a_(e,t,r){let i=Ey(),s=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jm(),a=Ym(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Uo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");N(yt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let p=o.createWebChannel(d,c),m=!1,y=!1,T=new by({Go:x=>{y?N(yt,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(m||(N(yt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),N(yt,`RPC '${e}' stream ${i} sending:`,x),p.send(x))},zo:()=>p.close()}),k=(x,W,K)=>{x.listen(W,F=>{try{K(F)}catch(X){setTimeout(()=>{throw X},0)}})};return k(p,so.EventType.OPEN,()=>{y||(N(yt,`RPC '${e}' stream ${i} transport opened.`),T.t_())}),k(p,so.EventType.CLOSE,()=>{y||(y=!0,N(yt,`RPC '${e}' stream ${i} transport closed`),T.r_())}),k(p,so.EventType.ERROR,x=>{y||(y=!0,wn(yt,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),T.r_(new M(P.UNAVAILABLE,"The operation could not be completed")))}),k(p,so.EventType.MESSAGE,x=>{var W;if(!y){let K=x.data[0];H(!!K,16349);let F=K,X=F?.error||((W=F[0])===null||W===void 0?void 0:W.error);if(X){N(yt,`RPC '${e}' stream ${i} received error:`,X);let re=X.status,ie=function(w){let E=Ke[w];if(E!==void 0)return TS(E)}(re),C=X.message;ie===void 0&&(ie=P.INTERNAL,C="Unknown error status: "+re+" with message "+X.message),y=!0,T.r_(new M(ie,C)),p.close()}else N(yt,`RPC '${e}' stream ${i} received:`,K),T.i_(K)}}),k(a,Qm.STAT_EVENT,x=>{x.stat===Eh.PROXY?N(yt,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Eh.NOPROXY&&N(yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.n_()},0),T}};function iR(){return typeof window<"u"?window:null}function Nh(){return typeof document<"u"?document:null}function yc(n){return new L_(n,!0)}var lc=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.bi=e,this.timerId=t,this.u_=r,this.c_=i,this.l_=s,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();let t=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,i,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}};var gA="PersistentStream",Cd=class{constructor(e,t,r,i,s,o,a,c){this.bi=e,this.R_=r,this.V_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new lc(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}stop(){return R(this,null,function*(){this.w_()&&(yield this.close(0))})}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}C_(){return R(this,null,function*(){if(this.b_())return this.close(0)})}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}close(e,t){return R(this,null,function*(){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?($e(t.toString()),$e("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Zo(t)})}O_(){}auth(){this.state=1;let e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.m_===t&&this.B_(r,i)},r=>{e(()=>{let i=new M(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(i)})})}B_(e,t){let r=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(i=>{r(()=>this.L_(i))}),this.stream.onMessage(i=>{r(()=>++this.p_==1?this.q_(i):this.onNext(i))})}S_(){this.state=5,this.y_.E_(()=>R(this,null,function*(){this.state=0,this.start()}))}L_(e){return N(gA,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(N(gA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ay=class extends Cd{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();let t=S2(this.serializer,e),r=function(s){if(!("targetChange"in s))return Y.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?Ge(o.readTime):Y.min()}(e);return this.listener.Q_(t,r)}U_(e){let t={};t.database=q_(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=Jh(c)?{documents:kS(s,c)}:{query:MS(s,c).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=AS(s,o.resumeToken);let u=B_(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Y.min())>0){a.readTime=No(s,o.snapshotVersion.toTimestamp());let u=B_(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=P2(this.serializer,e);r&&(t.labels=r),this.F_(t)}K_(e){let t={};t.database=q_(this.serializer),t.removeTarget=e,this.F_(t)}},Sy=class extends Cd{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return H(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){H(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();let t=R2(e.writeResults,e.commitTime),r=Ge(e.commitTime);return this.listener.j_(r,t)}H_(){let e={};e.database=q_(this.serializer),this.F_(e)}G_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>rc(this.serializer,r))};this.F_(t)}};var Ry=class{},Py=class extends Ry{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.J_=!1}Y_(){if(this.J_)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,r,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Qo(e,j_(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(P.UNKNOWN,s.toString())})}Wo(e,t,r,i,s){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,j_(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(P.UNKNOWN,o.toString())})}terminate(){this.J_=!0,this.connection.terminate()}},Dy=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?($e(t),this.ea=!1):N("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}};var Yi="RemoteStore",xy=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=s,this.ca.vo(o=>{r.enqueueAndForget(()=>R(this,null,function*(){ti(this)&&(N(Yi,"Restarting streams for network reachability change."),yield function(c){return R(this,null,function*(){let u=L(c);u.aa.add(4),yield Ho(u),u.la.set("Unknown"),u.aa.delete(4),yield vc(u)})}(this))}))}),this.la=new Dy(r,i)}};function vc(n){return R(this,null,function*(){if(ti(n))for(let e of n.ua)yield e(!0)})}function Ho(n){return R(this,null,function*(){for(let e of n.ua)yield e(!1)})}function Wd(n,e){let t=L(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),kv(t)?xv(t):Qo(t).b_()&&Dv(t,e))}function Lo(n,e){let t=L(n),r=Qo(t);t._a.delete(e),r.b_()&&sR(t,e),t._a.size===0&&(r.b_()?r.v_():ti(t)&&t.la.set("Unknown"))}function Dv(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Qo(n).U_(e)}function sR(n,e){n.ha.Ke(e),Qo(n).K_(e)}function xv(n){n.ha=new U_({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Qo(n).start(),n.la.ta()}function kv(n){return ti(n)&&!Qo(n).w_()&&n._a.size>0}function ti(n){return L(n).aa.size===0}function oR(n){n.ha=void 0}function G2(n){return R(this,null,function*(){n.la.set("Online")})}function W2(n){return R(this,null,function*(){n._a.forEach((e,t)=>{Dv(n,e)})})}function H2(n,e){return R(this,null,function*(){oR(n),kv(n)?(n.la.ia(e),xv(n)):n.la.set("Unknown")})}function K2(n,e,t){return R(this,null,function*(){if(n.la.set("Online"),e instanceof td&&e.state===2&&e.cause)try{yield function(i,s){return R(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i._a.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i._a.delete(a),i.ha.removeTarget(a))})}(n,e)}catch(r){N(Yi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ed(n,r)}else if(e instanceof Co?n.ha.Xe(e):e instanceof ed?n.ha.ot(e):n.ha.nt(e),!t.isEqual(Y.min()))try{let r=yield YS(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.ha.It(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=s._a.get(u);d&&s._a.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let d=s._a.get(c);if(!d)return;s._a.set(c,d.withResumeToken(We.EMPTY_BYTE_STRING,d.snapshotVersion)),sR(s,c);let p=new Fo(d.target,c,u,d.sequenceNumber);Dv(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){N(Yi,"Failed to raise snapshot:",r),yield Ed(n,r)}})}function Ed(n,e,t){return R(this,null,function*(){if(!Zr(e))throw e;n.aa.add(1),yield Ho(n),n.la.set("Offline"),t||(t=()=>YS(n.localStore)),n.asyncQueue.enqueueRetryable(()=>R(this,null,function*(){N(Yi,"Retrying IndexedDB access"),yield t(),n.aa.delete(1),yield vc(n)}))})}function aR(n,e){return e().catch(t=>Ed(n,t,e))}function Ko(n){return R(this,null,function*(){let e=L(n),t=Yr(e),r=e.oa.length>0?e.oa[e.oa.length-1].batchId:Lr;for(;Q2(e);)try{let i=yield j2(e.localStore,r);if(i===null){e.oa.length===0&&t.v_();break}r=i.batchId,Y2(e,i)}catch(i){yield Ed(e,i)}lR(e)&&cR(e)})}function Q2(n){return ti(n)&&n.oa.length<10}function Y2(n,e){n.oa.push(e);let t=Yr(n);t.b_()&&t.W_&&t.G_(e.mutations)}function lR(n){return ti(n)&&!Yr(n).w_()&&n.oa.length>0}function cR(n){Yr(n).start()}function J2(n){return R(this,null,function*(){Yr(n).H_()})}function X2(n){return R(this,null,function*(){let e=Yr(n);for(let t of n.oa)e.G_(t.mutations)})}function Z2(n,e,t){return R(this,null,function*(){let r=n.oa.shift(),i=F_.from(r,e,t);yield aR(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ko(n)})}function eF(n,e){return R(this,null,function*(){e&&Yr(n).W_&&(yield function(r,i){return R(this,null,function*(){if(function(o){return bS(o)&&o!==P.ABORTED}(i.code)){let s=r.oa.shift();Yr(r).D_(),yield aR(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Ko(r)}})}(n,e)),lR(n)&&cR(n)})}function mA(n,e){return R(this,null,function*(){let t=L(n);t.asyncQueue.verifyOperationInProgress(),N(Yi,"RemoteStore received new credentials");let r=ti(t);t.aa.add(3),yield Ho(t),r&&t.la.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),yield vc(t)})}function ky(n,e){return R(this,null,function*(){let t=L(n);e?(t.aa.delete(2),yield vc(t)):e||(t.aa.add(2),yield Ho(t),t.la.set("Unknown"))})}function Qo(n){return n.Pa||(n.Pa=function(t,r,i){let s=L(t);return s.Y_(),new Ay(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{jo:G2.bind(null,n),Jo:W2.bind(null,n),Zo:H2.bind(null,n),Q_:K2.bind(null,n)}),n.ua.push(e=>R(this,null,function*(){e?(n.Pa.D_(),kv(n)?xv(n):n.la.set("Unknown")):(yield n.Pa.stop(),oR(n))}))),n.Pa}function Yr(n){return n.Ta||(n.Ta=function(t,r,i){let s=L(t);return s.Y_(),new Sy(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:J2.bind(null,n),Zo:eF.bind(null,n),z_:X2.bind(null,n),j_:Z2.bind(null,n)}),n.ua.push(e=>R(this,null,function*(){e?(n.Ta.D_(),yield Ko(n)):(yield n.Ta.stop(),n.oa.length>0&&(N(Yi,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))}))),n.Ta}var My=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Yo(n,e){if($e("AsyncQueue",`${e}: ${n}`),Zr(n))return new M(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Id=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=Nl(),this.sortedSet=new De(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var bd=class{constructor(){this.Ia=new De(B.comparator)}track(e){let t=e.doc.key,r=this.Ia.get(t);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(t):e.type===1&&r.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):q(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(t,e)}da(){let e=[];return this.Ia.inorderTraversal((t,r)=>{e.push(r)}),e}},Bo=class n{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Id.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Ny=class{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}},Fy=class{constructor(){this.queries=_A(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,r){let i=L(t),s=i.queries;i.queries=_A(),s.forEach((o,a)=>{for(let c of a.Ra)c.onError(r)})})(this,new M(P.ABORTED,"Firestore shutting down"))}};function _A(){return new En(n=>uS(n),mc)}function Mv(n,e){return R(this,null,function*(){let t=L(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Va()&&e.ma()&&(r=2):(s=new Ny,r=e.ma()?0:1);try{switch(r){case 0:s.Aa=yield t.onListen(i,!0);break;case 1:s.Aa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Yo(o,`Initialization of query '${po(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.Ra.push(e),e.ga(t.onlineState),s.Aa&&e.pa(s.Aa)&&Fv(t)})}function Nv(n,e){return R(this,null,function*(){let t=L(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.Ra.indexOf(e);o>=0&&(s.Ra.splice(o,1),s.Ra.length===0?i=e.ma()?0:1:!s.Va()&&e.ma()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function tF(n,e){let t=L(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.Ra)a.pa(i)&&(r=!0);o.Aa=i}}r&&Fv(t)}function nF(n,e,t){let r=L(n),i=r.queries.get(e);if(i)for(let s of i.Ra)s.onError(t);r.queries.delete(e)}function Fv(n){n.fa.forEach(e=>{e.next()})}var Oy,yA;(yA=Oy||(Oy={})).ya="default",yA.Cache="cache";var cc=class{constructor(e,t,r){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Bo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;let r=t!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;let t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=Bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==Oy.Cache}};var Vy=class{constructor(e,t){this.Ma=e,this.byteLength=t}xa(){return"metadata"in this.Ma}};var Td=class{constructor(e){this.serializer=e}Bs(e){return Ln(this.serializer,e)}Ls(e){return e.metadata.exists?xS(this.serializer,e.document,!1):Je.newNoDocument(this.Bs(e.metadata.name),this.ks(e.metadata.readTime))}ks(e){return Ge(e)}},Uy=class{constructor(e,t,r){this.Oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=uR(e)}Na(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Ma.namedQuery)this.queries.push(e.Ma.namedQuery);else if(e.Ma.documentMetadata){this.documents.push({metadata:e.Ma.documentMetadata}),e.Ma.documentMetadata.exists||++t;let r=pe.fromString(e.Ma.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Ma.document&&(this.documents[this.documents.length-1].document=e.Ma.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ba(e){let t=new Map,r=new Td(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Bs(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ae()).add(s);t.set(o,a)}}return t}complete(){return R(this,null,function*(){let e=yield q2(this.localStore,new Td(this.serializer),this.documents,this.Oa.id),t=this.Ba(this.documents);for(let r of this.queries)yield $2(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,La:this.collectionGroups,ka:e}})}};function uR(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ad=class{constructor(e){this.key=e}},Sd=class{constructor(e){this.key=e}},Rd=class{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=ae(),this.mutatedKeys=ae(),this.Ua=dS(e),this.Ka=new Id(this.Ua)}get Wa(){return this.qa}Ga(e,t){let r=t?t.za:new bd,i=t?t.Ka:this.Ka,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{let m=i.get(d),y=_c(this.query,p)?p:null,T=!!m&&this.mutatedKeys.has(m.key),k=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),x=!1;m&&y?m.data.isEqual(y.data)?T!==k&&(r.track({type:3,doc:y}),x=!0):this.ja(m,y)||(r.track({type:2,doc:y}),x=!0,(c&&this.Ua(y,c)>0||u&&this.Ua(y,u)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),x=!0):m&&!y&&(r.track({type:1,doc:m}),x=!0,(c||u)&&(a=!0)),x&&(y?(o=o.add(y),s=k?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ka:o,za:r,ys:a,mutatedKeys:s}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;let o=e.za.da();o.sort((d,p)=>function(y,T){let k=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q(20277,{Vt:x})}};return k(y)-k(T)}(d.type,p.type)||this.Ua(d.doc,p.doc)),this.Ha(r),i=i!=null&&i;let a=t&&!i?this.Ja():[],c=this.$a.size===0&&this.current&&!i?1:0,u=c!==this.Qa;return this.Qa=c,o.length!==0||u?{snapshot:new Bo(this.query,e.Ka,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:a}:{Ya:a}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new bd,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];let e=this.$a;this.$a=ae(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});let t=[];return e.forEach(r=>{this.$a.has(r)||t.push(new Sd(r))}),this.$a.forEach(r=>{e.has(r)||t.push(new Ad(r))}),t}Xa(e){this.qa=e.Ns,this.$a=ae();let t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return Bo.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}},ni="SyncEngine",Ly=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},By=class{constructor(e){this.key=e,this.tu=!1}},jy=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.nu={},this.ru=new En(a=>uS(a),mc),this.iu=new Map,this.su=new Set,this.ou=new De(B.comparator),this._u=new Map,this.au=new sc,this.uu={},this.cu=new Map,this.lu=Oo.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}};function rF(n,e,t=!0){return R(this,null,function*(){let r=Hd(n),i,s=r.ru.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.eu()):i=yield hR(r,e,t,!0),i})}function iF(n,e){return R(this,null,function*(){let t=Hd(n);yield hR(t,e,!0,!1)})}function hR(n,e,t,r){return R(this,null,function*(){let i=yield Vo(n.localStore,At(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield Ov(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Wd(n.remoteStore,i),a})}function Ov(n,e,t,r,i){return R(this,null,function*(){n.Pu=(p,m,y)=>function(k,x,W,K){return R(this,null,function*(){let F=x.view.Ga(W);F.ys&&(F=yield md(k.localStore,x.query,!1).then(({documents:C})=>x.view.Ga(C,F)));let X=K&&K.targetChanges.get(x.targetId),re=K&&K.targetMismatches.get(x.targetId)!=null,ie=x.view.applyChanges(F,k.isPrimaryClient,X,re);return qy(k,x.targetId,ie.Ya),ie.snapshot})}(n,p,m,y);let s=yield md(n.localStore,e,!0),o=new Rd(e,s.Ns),a=o.Ga(s.documents),c=tc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);qy(n,t,u.Ya);let d=new Ly(e,t,o);return n.ru.set(e,d),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),u.snapshot})}function sF(n,e,t){return R(this,null,function*(){let r=L(n),i=r.ru.get(e),s=r.iu.get(i.targetId);if(s.length>1)return r.iu.set(i.targetId,s.filter(o=>!mc(o,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Uo(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Lo(r.remoteStore,i.targetId),jo(r,i.targetId)}).catch(Xr))):(jo(r,i.targetId),yield Uo(r.localStore,i.targetId,!0))})}function oF(n,e){return R(this,null,function*(){let t=L(n),r=t.ru.get(e),i=t.iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Lo(t.remoteStore,r.targetId))})}function aF(n,e,t){return R(this,null,function*(){let r=Bv(n);try{let i=yield function(o,a){let c=L(o),u=Ve.now(),d=a.reduce((y,T)=>y.add(T.key),ae()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=kt(),k=ae();return c.Cs.getEntries(y,d).next(x=>{T=x,T.forEach((W,K)=>{K.isValidDocument()||(k=k.add(W))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,T)).next(x=>{p=x;let W=[];for(let K of a){let F=w2(K,p.get(K.key).overlayedDocument);F!=null&&W.push(new In(K.key,F,rS(F.value.mapValue),je.exists(!0)))}return c.mutationQueue.addMutationBatch(y,u,W,a)}).next(x=>{m=x;let W=x.applyToLocalDocumentSet(p,k);return c.documentOverlayCache.saveOverlays(y,x.batchId,W)})}).then(()=>({batchId:m.batchId,changes:pS(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.uu[o.currentUser.toKey()];u||(u=new De(ee)),u=u.insert(a,c),o.uu[o.currentUser.toKey()]=u}(r,i.batchId,t),yield mr(r,i.changes),yield Ko(r.remoteStore)}catch(i){let s=Yo(i,"Failed to persist write");t.reject(s)}})}function dR(n,e){return R(this,null,function*(){let t=L(n);try{let r=yield B2(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t._u.get(s);o&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.tu=!0:i.modifiedDocuments.size>0?H(o.tu,14607):i.removedDocuments.size>0&&(H(o.tu,42227),o.tu=!1))}),yield mr(t,r,e)}catch(r){yield Xr(r)}})}function vA(n,e,t){let r=L(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ru.forEach((s,o)=>{let a=o.view.ga(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=L(o);c.onlineState=a;let u=!1;c.queries.forEach((d,p)=>{for(let m of p.Ra)m.ga(a)&&(u=!0)}),u&&Fv(c)}(r.eventManager,e),i.length&&r.nu.Q_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function lF(n,e,t){return R(this,null,function*(){let r=L(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r._u.get(e),s=i&&i.key;if(s){let o=new De(B.comparator);o=o.insert(s,Je.newNoDocument(s,Y.min()));let a=ae().add(s),c=new ec(Y.min(),new Map,new De(ee),o,a);yield dR(r,c),r.ou=r.ou.remove(s),r._u.delete(e),Lv(r)}else yield Uo(r.localStore,e,!1).then(()=>jo(r,e,t)).catch(Xr)})}function cF(n,e){return R(this,null,function*(){let t=L(n),r=e.batch.batchId;try{let i=yield L2(t.localStore,e);Uv(t,r,null),Vv(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield mr(t,i)}catch(i){yield Xr(i)}})}function uF(n,e,t){return R(this,null,function*(){let r=L(n);try{let i=yield function(o,a){let c=L(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(p=>(H(p!==null,37113),d=p.keys(),c.mutationQueue.removeMutationBatch(u,p))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Uv(r,e,t),Vv(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield mr(r,i)}catch(i){yield Xr(i)}})}function hF(n,e){return R(this,null,function*(){let t=L(n);ti(t.remoteStore)||N(ni,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=L(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===Lr)return void e.resolve();let i=t.cu.get(r)||[];i.push(e),t.cu.set(r,i)}catch(r){let i=Yo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Vv(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function Uv(n,e,t){let r=L(n),i=r.uu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.uu[r.currentUser.toKey()]=i}}function jo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.iu.get(e))n.ru.delete(r),t&&n.nu.Tu(r,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(r=>{n.au.containsKey(r)||fR(n,r)})}function fR(n,e){n.su.delete(e.path.canonicalString());let t=n.ou.get(e);t!==null&&(Lo(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),Lv(n))}function qy(n,e,t){for(let r of t)r instanceof Ad?(n.au.addReference(r.key,e),dF(n,r)):r instanceof Sd?(N(ni,"Document no longer in limbo: "+r.key),n.au.removeReference(r.key,e),n.au.containsKey(r.key)||fR(n,r.key)):q(19791,{Iu:r})}function dF(n,e){let t=e.key,r=t.path.canonicalString();n.ou.get(t)||n.su.has(r)||(N(ni,"New document in limbo: "+t),n.su.add(r),Lv(n))}function Lv(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){let e=n.su.values().next().value;n.su.delete(e);let t=new B(pe.fromString(e)),r=n.lu.next();n._u.set(r,new By(t)),n.ou=n.ou.insert(t,r),Wd(n.remoteStore,new Fo(At(Wo(t.path)),r,"TargetPurposeLimboResolution",zt.le))}}function mr(n,e,t){return R(this,null,function*(){let r=L(n),i=[],s=[],o=[];r.ru.isEmpty()||(r.ru.forEach((a,c)=>{o.push(r.Pu(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){let p=u?!u.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(u){i.push(u);let p=_y.Ps(c.targetId,u);s.push(p)}}))}),yield Promise.all(o),r.nu.Q_(i),yield function(c,u){return R(this,null,function*(){let d=L(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(u,m=>S.forEach(m.ls,y=>d.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>S.forEach(m.hs,y=>d.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Zr(p))throw p;N(Pv,"Failed to update sequence numbers: "+p)}for(let p of u){let m=p.targetId;if(!p.fromCache){let y=d.Ss.get(m),T=y.snapshotVersion,k=y.withLastLimboFreeSnapshotVersion(T);d.Ss=d.Ss.insert(m,k)}}})}(r.localStore,s))})}function fF(n,e){return R(this,null,function*(){let t=L(n);if(!t.currentUser.isEqual(e)){N(ni,"User change. New user:",e.toKey());let r=yield QS(t.localStore,e);t.currentUser=e,function(s,o){s.cu.forEach(a=>{a.forEach(c=>{c.reject(new M(P.CANCELLED,o))})}),s.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield mr(t,r.Ms)}})}function pF(n,e){let t=L(n),r=t._u.get(e);if(r&&r.tu)return ae().add(r.key);{let i=ae(),s=t.iu.get(e);if(!s)return i;for(let o of s){let a=t.ru.get(o);i=i.unionWith(a.view.Wa)}return i}}function gF(n,e){return R(this,null,function*(){let t=L(n),r=yield md(t.localStore,e.query,!0),i=e.view.Xa(r);return t.isPrimaryClient&&qy(t,e.targetId,i.Ya),i})}function mF(n,e){return R(this,null,function*(){let t=L(n);return ZS(t.localStore,e).then(r=>mr(t,r))})}function _F(n,e,t,r){return R(this,null,function*(){let i=L(n),s=yield function(a,c){let u=L(a),d=L(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",p=>d.Hn(p,c).next(m=>m?u.localDocuments.getDocuments(p,m):S.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Ko(i.remoteStore):t==="acknowledged"||t==="rejected"?(Uv(i,e,r||null),Vv(i,e),function(a,c){L(L(a).mutationQueue).Xn(c)}(i.localStore,e)):q(6720,"Unknown batchState",{Eu:t}),yield mr(i,s)):N(ni,"Cannot apply mutation batch with id: "+e)})}function yF(n,e){return R(this,null,function*(){let t=L(n);if(Hd(t),Bv(t),e===!0&&t.hu!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield wA(t,r.toArray());t.hu=!0,yield ky(t.remoteStore,!0);for(let s of i)Wd(t.remoteStore,s)}else if(e===!1&&t.hu!==!1){let r=[],i=Promise.resolve();t.iu.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(jo(t,o),Uo(t.localStore,o,!0))),Lo(t.remoteStore,o)}),yield i,yield wA(t,r),function(o){let a=L(o);a._u.forEach((c,u)=>{Lo(a.remoteStore,u)}),a.au.Kr(),a._u=new Map,a.ou=new De(B.comparator)}(t),t.hu=!1,yield ky(t.remoteStore,!1)}})}function wA(n,e,t){return R(this,null,function*(){let r=L(n),i=[],s=[];for(let o of e){let a,c=r.iu.get(o);if(c&&c.length!==0){a=yield Vo(r.localStore,At(c[0]));for(let u of c){let d=r.ru.get(u),p=yield gF(r,d);p.snapshot&&s.push(p.snapshot)}}else{let u=yield XS(r.localStore,o);a=yield Vo(r.localStore,u),yield Ov(r,pR(u),o,!1,a.resumeToken)}i.push(a)}return r.nu.Q_(s),i})}function pR(n){return cS(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function vF(n){return function(t){return L(L(t).persistence).us()}(L(n).localStore)}function wF(n,e,t,r){return R(this,null,function*(){let i=L(n);if(i.hu)return void N(ni,"Ignoring unexpected query state notification.");let s=i.iu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield ZS(i.localStore,hS(s[0])),a=ec.createSynthesizedRemoteEventForCurrentChange(e,t==="current",We.EMPTY_BYTE_STRING);yield mr(i,o,a);break}case"rejected":yield Uo(i.localStore,e,!0),jo(i,e,r);break;default:q(64155,t)}})}function CF(n,e,t){return R(this,null,function*(){let r=Hd(n);if(r.hu){for(let i of e){if(r.iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){N(ni,"Adding an already active target "+i);continue}let s=yield XS(r.localStore,i),o=yield Vo(r.localStore,s);yield Ov(r,pR(s),o.targetId,!1,o.resumeToken),Wd(r.remoteStore,o)}for(let i of t)r.iu.has(i)&&(yield Uo(r.localStore,i,!1).then(()=>{Lo(r.remoteStore,i),jo(r,i)}).catch(Xr))}})}function Hd(n){let e=L(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lF.bind(null,e),e.nu.Q_=tF.bind(null,e.eventManager),e.nu.Tu=nF.bind(null,e.eventManager),e}function Bv(n){let e=L(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uF.bind(null,e),e}function EF(n,e,t){let r=L(n);(function(s,o,a){return R(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(y,T){let k=L(y),x=Ge(T.createTime);return k.persistence.runTransaction("hasNewerBundle","readonly",W=>k.ci.getBundleMetadata(W,T.id)).then(W=>!!W&&W.createTime.compareTo(x)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(uR(c));let u=new Uy(c,s.localStore,o.serializer),d=yield o.du();for(;d;){let m=yield u.Na(d);m&&a._updateProgress(m),d=yield o.du()}let p=yield u.complete();return yield mr(s,p.ka,void 0),yield function(y,T){let k=L(y);return k.persistence.runTransaction("Save bundle","readwrite",x=>k.ci.saveBundleMetadata(x,T))}(s.localStore,c),a._completeWith(p.progress),Promise.resolve(p.La)}catch(c){return wn(ni,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var jv=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return R(this,null,function*(){this.serializer=yc(t.databaseInfo.databaseId),this.sharedClientState=this.Au(t),this.persistence=this.Ru(t),yield this.persistence.start(),this.localStore=this.Vu(t),this.gcScheduler=this.mu(t,this.localStore),this.indexBackfillerScheduler=this.fu(t,this.localStore)})}mu(t,r){return null}fu(t,r){return null}Vu(t){return KS(this.persistence,new gd,t.initialUser,this.serializer)}Ru(t){return new oc(fd.Ei,this.serializer)}Au(t){return new vd}terminate(){return R(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),$y=class extends jv{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){H(this.persistence.referenceDelegate instanceof pd,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new ud(r,e.asyncQueue,t)}Ru(e){let t=this.cacheSizeBytes!==void 0?xt.withCacheSize(this.cacheSizeBytes):xt.DEFAULT;return new oc(r=>pd.Ei(r,t),this.serializer)}},Pd=class n extends jv{constructor(e,t,r){super(),this.gu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return R(this,null,function*(){yield pp(n.prototype,this,"initialize").call(this,e),yield this.gu.initialize(this,e),yield Bv(this.gu.syncEngine),yield Ko(this.gu.remoteStore),yield this.persistence.Ki(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}Vu(e){return KS(this.persistence,new gd,e.initialUser,this.serializer)}mu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new ud(r,e.asyncQueue,t)}fu(e,t){let r=new m_(t,this.persistence);return new g_(e.asyncQueue,r)}Ru(e){let t=Rv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?xt.withCacheSize(this.cacheSizeBytes):xt.DEFAULT;return new my(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,iR(),Nh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Au(e){return new vd}},zy=class n extends Pd{constructor(e,t){super(e,t,!1),this.gu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return R(this,null,function*(){yield pp(n.prototype,this,"initialize").call(this,e);let t=this.gu.syncEngine;this.sharedClientState instanceof jl&&(this.sharedClientState.syncEngine={yo:_F.bind(null,t),wo:wF.bind(null,t),bo:CF.bind(null,t),us:vF.bind(null,t),po:mF.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Ki(r=>R(this,null,function*(){yield yF(this.gu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Au(e){let t=iR();if(!jl.C(t))throw new M(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Rv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jl(t,e.asyncQueue,r,e.clientId,e.initialUser)}},qv=(()=>{class n{initialize(t,r){return R(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>vA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=fF.bind(null,this.syncEngine),yield ky(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Fy}()}createDatastore(t){let r=yc(t.databaseInfo.databaseId),i=function(o){return new Ty(o)}(t.databaseInfo);return function(o,a,c,u){return new Py(o,a,c,u)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,a,c){return new xy(i,s,o,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>vA(this.syncEngine,r,0),function(){return wd.C()?new wd:new Cy}())}createSyncEngine(t,r){return function(s,o,a,c,u,d,p){let m=new jy(s,o,a,c,u,d);return p&&(m.hu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return R(this,null,function*(){var t,r;yield function(s){return R(this,null,function*(){let o=L(s);N(Yi,"RemoteStore shutting down."),o.aa.add(5),yield Ho(o),o.ca.shutdown(),o.la.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function CA(n,e=10240){let t=0;return{read(){return R(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return R(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var qo=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):$e("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Gy=class{constructor(e,t){this.wu=e,this.serializer=t,this.metadata=new et,this.buffer=new Uint8Array,this.bu=function(){return new TextDecoder("utf-8")}(),this.Su().then(r=>{r&&r.xa()?this.metadata.resolve(r.Ma.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Ma)}`))},r=>this.metadata.reject(r))}close(){return this.wu.cancel()}getMetadata(){return R(this,null,function*(){return this.metadata.promise})}du(){return R(this,null,function*(){return yield this.getMetadata(),this.Su()})}Su(){return R(this,null,function*(){let e=yield this.Du();if(e===null)return null;let t=this.bu.decode(e),r=Number(t);isNaN(r)&&this.vu(`length string (${t}) is not valid number`);let i=yield this.Cu(r);return new Vy(JSON.parse(i),e.length+r)})}Fu(){return this.buffer.findIndex(e=>e===123)}Du(){return R(this,null,function*(){for(;this.Fu()<0&&!(yield this.Mu()););if(this.buffer.length===0)return null;let e=this.Fu();e<0&&this.vu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Cu(e){return R(this,null,function*(){for(;this.buffer.length<e;)(yield this.Mu())&&this.vu("Reached the end of bundle when more is expected.");let t=this.bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}vu(e){throw this.wu.cancel(),new Error(`Invalid bundle format: ${e}`)}Mu(){return R(this,null,function*(){let e=yield this.wu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Wy=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return R(this,null,function*(){let o=L(i),a={documents:s.map(p=>nc(o.serializer,p))},c=yield o.Wo("BatchGetDocuments",o.serializer.databaseId,pe.emptyPath(),a,s.length),u=new Map;c.forEach(p=>{let m=A2(o.serializer,p);u.set(m.key.toString(),m)});let d=[];return s.forEach(p=>{let m=u.get(p.toString());H(!!m,55234,{key:p}),d.push(m)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Qr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new Jl(i,this.precondition(i)))}),yield function(r,i){return R(this,null,function*(){let s=L(r),o={writes:i.map(a=>rc(s.serializer,a))};yield s.Qo("Commit",s.serializer.databaseId,pe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw q(50498,{xu:e.constructor.name});t=Y.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new M(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Y.min())?je.exists(!1):je.updateTime(t):je.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Y.min()))throw new M(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return je.updateTime(t)}return je.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Hy=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Ou=r.maxAttempts,this.y_=new lc(this.asyncQueue,"transaction_retry")}Nu(){this.Ou-=1,this.Bu()}Bu(){this.y_.E_(()=>R(this,null,function*(){let e=new Wy(this.datastore),t=this.Lu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ku(i)}))}).catch(r=>{this.ku(r)})}))}Lu(e){try{let t=this.updateFunction(e);return!fc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ku(e){this.Ou>0&&this.qu(e)?(this.Ou-=1,this.asyncQueue.enqueueAndForget(()=>(this.Bu(),Promise.resolve()))):this.deferred.reject(e)}qu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!bS(t)}return!1}};var Jr="FirestoreClient",Ky=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ye.UNAUTHENTICATED,this.clientId=Vh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>R(this,null,function*(){N(Jr,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(N(Jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Yo(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function i_(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),N(Jr,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>R(this,null,function*(){r.isEqual(i)||(yield QS(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function EA(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield $v(n);N(Jr,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>mA(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>mA(e.remoteStore,i)),n._onlineComponents=e})}function $v(n){return R(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N(Jr,"Using user provided OfflineComponentProvider");try{yield i_(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;wn("Error using user provided cache. Falling back to memory cache: "+t),yield i_(n,new jv)}}else N(Jr,"Using default OfflineComponentProvider"),yield i_(n,new $y(void 0));return n._offlineComponents})}function Kd(n){return R(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(N(Jr,"Using user provided OnlineComponentProvider"),yield EA(n,n._uninitializedComponentsProvider._online)):(N(Jr,"Using default OnlineComponentProvider"),yield EA(n,new qv))),n._onlineComponents})}function gR(n){return $v(n).then(e=>e.persistence)}function zv(n){return $v(n).then(e=>e.localStore)}function mR(n){return Kd(n).then(e=>e.remoteStore)}function Gv(n){return Kd(n).then(e=>e.syncEngine)}function IF(n){return Kd(n).then(e=>e.datastore)}function $o(n){return R(this,null,function*(){let e=yield Kd(n),t=e.eventManager;return t.onListen=rF.bind(null,e.syncEngine),t.onUnlisten=sF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=iF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=oF.bind(null,e.syncEngine),t})}function bF(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield gR(n),t=yield mR(n);return e.setNetworkEnabled(!0),function(i){let s=L(i);return s.aa.delete(0),vc(s)}(t)}))}function TF(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield gR(n),t=yield mR(n);return e.setNetworkEnabled(!1),function(i){return R(this,null,function*(){let s=L(i);s.aa.add(0),yield Ho(s),s.la.set("Offline")})}(t)}))}function AF(n,e){let t=new et;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s,o){return R(this,null,function*(){try{let a=yield function(u,d){let p=L(u);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new M(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Yo(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield zv(n),e,t)})),t.promise}function _R(n,e,t={}){let r=new et;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(s,o,a,c,u){let d=new qo({next:m=>{d.yu(),o.enqueueAndForget(()=>Nv(s,p));let y=m.docs.has(a);!y&&m.fromCache?u.reject(new M(P.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?u.reject(new M(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new cc(Wo(a.path),d,{includeMetadataChanges:!0,Fa:!0});return Mv(s,p)}(yield $o(n),n.asyncQueue,e,t,r)})),r.promise}function SF(n,e){let t=new et;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s,o){return R(this,null,function*(){try{let a=yield md(i,s,!0),c=new Rd(s,a.Ns),u=c.Ga(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){let c=Yo(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield zv(n),e,t)})),t.promise}function yR(n,e,t={}){let r=new et;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(s,o,a,c,u){let d=new qo({next:m=>{d.yu(),o.enqueueAndForget(()=>Nv(s,p)),m.fromCache&&c.source==="server"?u.reject(new M(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new cc(a,d,{includeMetadataChanges:!0,Fa:!0});return Mv(s,p)}(yield $o(n),n.asyncQueue,e,t,r)})),r.promise}function RF(n,e){let t=new qo(e);return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s){L(i).fa.add(s),s.next()}(yield $o(n),t)})),()=>{t.yu(),n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s){L(i).fa.delete(s)}(yield $o(n),t)}))}}function PF(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?dv().encode(o):o,function(d,p){return new Gy(d,p)}(function(d,p){if(d instanceof Uint8Array)return CA(d,p);if(d instanceof ArrayBuffer)return CA(new Uint8Array(d),p);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,yc(e));n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){EF(yield Gv(n),i,r)}))}function DF(n,e){return n.asyncQueue.enqueue(()=>R(this,null,function*(){return function(r,i){let s=L(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.ci.getNamedQuery(o,i))}(yield zv(n),e)}))}function vR(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var IA=new Map;function Wv(n,e,t){if(!t)throw new M(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Hv(n,e,t,r){if(e===!0&&r===!0)throw new M(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bA(n){if(!B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function TA(n){if(B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Qd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":q(12329,{type:typeof n})}function ge(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Qd(n);throw new M(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function wR(n,e){if(e<=0)throw new M(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var CR="firestore.googleapis.com",AA=!0,Dd=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=CR,this.ssl=AA}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:AA;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<V2)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Hv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ji=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dd(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new s_;switch(r.type){case"firstParty":return new c_(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return R(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=IA.get(t);r&&(N("ComponentProvider","Removing Datastore"),IA.delete(t),r.terminate())}(this),Promise.resolve()}};function Yd(n,e,t,r={}){var i;let s=(n=ge(n,Ji))._getSettings(),o=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;s.host!==CR&&s.host!==a&&wn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=Object.assign(Object.assign({},s),{host:a,ssl:!1,emulatorOptions:r});if(!Va(c,o)&&(n._setSettings(c),r.mockUserToken)){let u,d;if(typeof r.mockUserToken=="string")u=r.mockUserToken,d=Ye.MOCK_USER;else{u=Fp(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ye(p)}n._authCredentials=new o_(new Fh(u,d))}}var lt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ae=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Bn=class n extends lt{constructor(e,t,r){super(e,t,Wo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ae(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Jd(n,e,...t){if(n=Re(n),Wv("collection","path",e),n instanceof Ji){let r=pe.fromString(e,...t);return TA(r),new Bn(n,null,r)}{if(!(n instanceof Ae||n instanceof Bn))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return TA(r),new Bn(n.firestore,null,r)}}function Kv(n,e){if(n=ge(n,Ji),Wv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new lt(n,null,function(r){return new Cn(pe.emptyPath(),r)}(e))}function ts(n,e,...t){if(n=Re(n),arguments.length===1&&(e=Vh.newId()),Wv("doc","path",e),n instanceof Ji){let r=pe.fromString(e,...t);return bA(r),new Ae(n,null,new B(r))}{if(!(n instanceof Ae||n instanceof Bn))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return bA(r),new Ae(n.firestore,n instanceof Bn?n.converter:null,new B(r))}}function Xd(n,e){return n=Re(n),e=Re(e),(n instanceof Ae||n instanceof Bn)&&(e instanceof Ae||e instanceof Bn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Zd(n,e){return n=Re(n),e=Re(e),n instanceof lt&&e instanceof lt&&n.firestore===e.firestore&&mc(n._query,e._query)&&n.converter===e.converter}var SA="AsyncQueue",xd=class{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new lc(this,"async_queue_retry"),this.ju=()=>{let r=Nh();r&&N(SA,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;let t=Nh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;let t=Nh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});let t=new et;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}Zu(){return R(this,null,function*(){if(this.Qu.length!==0){try{yield this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!Zr(e))throw e;N(SA,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}})}Yu(e){let t=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,$e("INTERNAL UNHANDLED ERROR: ",RA(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=t,t}enqueueAfterDelay(e,t,r){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);let i=My.createAndSchedule(this,e,t,r,s=>this.Xu(s));return this.Uu.push(i),i}Ju(){this.Ku&&q(47125,{ec:RA(this.Ku)})}verifyOperationInProgress(){}tc(){return R(this,null,function*(){let e;do e=this.Hu,yield e;while(e!==this.Hu)})}nc(e){for(let t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){let t=this.Uu.indexOf(e);this.Uu.splice(t,1)}};function RA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Qy(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Yy=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var ER=-1,Ue=class extends Ji{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new xd,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return R(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xd(e),this._firestoreClient=void 0,yield e}})}};function IR(n,e){let t=typeof n=="object"?n:Ps(),r=typeof n=="string"?n:e||Kh,i=_u(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Np("firestore");s&&Yd(i,...s)}return i}function ct(n){if(n._terminated)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bR(n),n._firestoreClient}function bR(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,u,d){return new w_(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,vR(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Ky(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}function Qv(n,e){wn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return TR(n,qv.provider,{build:r=>new Pd(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Yv(n){return R(this,null,function*(){wn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();TR(n,qv.provider,{build:t=>new zy(t,e.cacheSizeBytes)})})}function TR(n,e,t){if((n=ge(n,Ue))._firestoreClient||n._terminated)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new M(P.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},bR(n)}function Jv(n){if(n._initialized&&!n._terminated)throw new M(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new et;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{yield function(r){return R(this,null,function*(){if(!qr.C())return Promise.resolve();let i=r+HS;yield qr.delete(i)})}(Rv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function Xv(n){return function(t){let r=new et;return t.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return hF(yield Gv(t),r)})),r.promise}(ct(n=ge(n,Ue)))}function Zv(n){return bF(ct(n=ge(n,Ue)))}function e0(n){return TF(ct(n=ge(n,Ue)))}function t0(n,e){let t=ct(n=ge(n,Ue)),r=new Yy;return PF(t,n._databaseId,e,r),r}function n0(n,e){return DF(ct(n=ge(n,Ue)),e).then(t=>t?new lt(n,null,t.query):null)}var $n=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(We.fromBase64String(e))}catch(t){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(We.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var bn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var pr=class{constructor(e){this._methodName=e}};var Xi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var uc=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var xF=/^__.*__$/,Jy=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new In(e,this.data,this.fieldMask,t,this.fieldTransforms):new Kr(e,this.data,t,this.fieldTransforms)}},kd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new In(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function AR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q(40011,{oc:n})}}var Md=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this._c(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i.lc(e),i}hc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ac({path:r,cc:!1});return i._c(),i}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Nd(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(AR(this.oc)&&xF.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}},Xy=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yc(e)}dc(e,t,r,i=!1){return new Md({oc:e,methodName:t,Ec:r,path:ze.emptyPath(),cc:!1,Ic:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ns(n){let e=n._freezeSettings(),t=yc(n._databaseId);return new Xy(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ef(n,e,t,r,i,s={}){let o=n.dc(s.merge||s.mergeFields?2:0,e,t,i);s0("Data must be an object, but it was:",o,r);let a=PR(r,o),c,u;if(s.merge)c=new Gt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let p of s.mergeFields){let m=rv(e,p,t);if(!o.contains(m))throw new M(P.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);xR(d,m)||d.push(m)}c=new Gt(d),u=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,u=o.fieldTransforms;return new Jy(new vt(a),c,u)}var hc=class n extends pr{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function SR(n,e,t){return new Md({oc:3,Ec:e.settings.Ec,methodName:n._methodName,cc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Zy=class n extends pr{_toFieldTransform(e){return new Hi(e.path,new Wr)}isEqual(e){return e instanceof n}},ev=class n extends pr{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=SR(this,e,!0),r=this.Ac.map(s=>rs(s,t)),i=new dr(r);return new Hi(e.path,i)}isEqual(e){return e instanceof n&&Va(this.Ac,e.Ac)}},tv=class n extends pr{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){let t=SR(this,e,!0),r=this.Ac.map(s=>rs(s,t)),i=new fr(r);return new Hi(e.path,i)}isEqual(e){return e instanceof n&&Va(this.Ac,e.Ac)}},nv=class n extends pr{constructor(e,t){super(e),this.Rc=t}_toFieldTransform(e){let t=new Hr(e.serializer,_S(e.serializer,this.Rc));return new Hi(e.path,t)}isEqual(e){return e instanceof n&&this.Rc===e.Rc}};function r0(n,e,t,r){let i=n.dc(1,e,t);s0("Data must be an object, but it was:",i,r);let s=[],o=vt.empty();ei(r,(c,u)=>{let d=o0(e,c,t);u=Re(u);let p=i.hc(d);if(u instanceof hc)s.push(d);else{let m=rs(u,p);m!=null&&(s.push(d),o.set(d,m))}});let a=new Gt(s);return new kd(o,a,i.fieldTransforms)}function i0(n,e,t,r,i,s){let o=n.dc(1,e,t),a=[rv(e,r,t)],c=[i];if(s.length%2!=0)throw new M(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(rv(e,s[m])),c.push(s[m+1]);let u=[],d=vt.empty();for(let m=a.length-1;m>=0;--m)if(!xR(u,a[m])){let y=a[m],T=c[m];T=Re(T);let k=o.hc(y);if(T instanceof hc)u.push(y);else{let x=rs(T,k);x!=null&&(u.push(y),d.set(y,x))}}let p=new Gt(u);return new kd(d,p,o.fieldTransforms)}function RR(n,e,t,r=!1){return rs(t,n.dc(r?4:3,e))}function rs(n,e){if(DR(n=Re(n)))return s0("Unsupported field value:",e,n),PR(n,e);if(n instanceof pr)return function(r,i){if(!AR(i.oc))throw i.Tc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Tc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=rs(a,i.Pc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Re(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return _S(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ve.fromDate(r);return{timestampValue:No(i.serializer,s)}}if(r instanceof Ve){let s=new Ve(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:No(i.serializer,s)}}if(r instanceof Xi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $n)return{bytesValue:AS(i.serializer,r._byteString)};if(r instanceof Ae){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Tc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof uc)return function(o,a){return{mapValue:{fields:{[vv]:{stringValue:wv},[Po]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Tc("VectorValues must only contain numeric values.");return bv(a.serializer,u)})}}}}}}(r,i);throw i.Tc(`Unsupported field value: ${Qd(r)}`)}(n,e)}function PR(n,e){let t={};return KA(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ei(n,(r,i)=>{let s=rs(i,e.uc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function DR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ve||n instanceof Xi||n instanceof $n||n instanceof Ae||n instanceof pr||n instanceof uc)}function s0(n,e,t){if(!DR(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Qd(t);throw r==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+r)}}function rv(n,e,t){if((e=Re(e))instanceof bn)return e._internalPath;if(typeof e=="string")return o0(n,e);throw Nd("Field path arguments must be of type string or ",n,!1,void 0,t)}var kF=new RegExp("[~\\*/\\[\\]]");function o0(n,e,t){if(e.search(kF)>=0)throw Nd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bn(...e.split("."))._internalPath}catch{throw Nd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Nd(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new M(P.INVALID_ARGUMENT,a+n+c)}function xR(n,e){return n.some(t=>t.isEqual(e))}var Zi=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ae(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new iv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(tf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},iv=class extends Zi{data(){return super.data()}};function tf(n,e){return typeof e=="string"?o0(n,e):e instanceof bn?e._internalPath:e._delegate._internalPath}function kR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var dc=class{},es=class extends dc{};function zn(n,e,...t){let r=[];e instanceof dc&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof sv).length,a=s.filter(c=>c instanceof Fd).length;if(o>1||o>0&&a>0)throw new M(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Fd=class n extends es{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return NR(e._query,t),new lt(e.firestore,e.converter,M_(e._query,t))}_parse(e){let t=ns(e.firestore);return function(s,o,a,c,u,d,p){let m;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new M(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){DA(p,d);let T=[];for(let k of p)T.push(PA(c,s,k));m={arrayValue:{values:T}}}else m=PA(c,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||DA(p,d),m=RR(a,o,p,d==="in"||d==="not-in");return ce.create(u,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function a0(n,e,t){let r=e,i=tf("where",n);return Fd._create(i,r,t)}var sv=class n extends dc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ve.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)NR(o,c),o=M_(o,c)}(e._query,t),new lt(e.firestore,e.converter,M_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var ov=class n extends es{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Gi(s,o)}(e._query,this._field,this._direction);return new lt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Cn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function l0(n,e="asc"){let t=e,r=tf("orderBy",n);return ov._create(r,t)}var Od=class n extends es{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new lt(e.firestore,e.converter,Zh(e._query,this._limit,this._limitType))}};function c0(n){return wR("limit",n),Od._create("limit",n,"F")}function u0(n){return wR("limitToLast",n),Od._create("limitToLast",n,"L")}var Vd=class n extends es{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=MR(e,this.type,this._docOrFields,this._inclusive);return new lt(e.firestore,e.converter,function(i,s){return new Cn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function h0(...n){return Vd._create("startAt",n,!0)}function d0(...n){return Vd._create("startAfter",n,!1)}var Ud=class n extends es{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=MR(e,this.type,this._docOrFields,this._inclusive);return new lt(e.firestore,e.converter,function(i,s){return new Cn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function f0(...n){return Ud._create("endBefore",n,!1)}function p0(...n){return Ud._create("endAt",n,!0)}function MR(n,e,t,r){if(t[0]=Re(t[0]),t[0]instanceof Zi)return function(s,o,a,c,u){if(!c)throw new M(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let p of wo(s))if(p.field.isKeyField())d.push(zi(o,c.key));else{let m=c.data.field(p.field);if($d(m))throw new M(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let y=p.field.canonicalString();throw new M(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(m)}return new qn(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=ns(n.firestore);return function(o,a,c,u,d,p){let m=o.explicitOrderBy;if(d.length>m.length)throw new M(P.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let T=0;T<d.length;T++){let k=d[T];if(m[T].field.isKeyField()){if(typeof k!="string")throw new M(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof k}`);if(!Ev(o)&&k.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${k}' contains a slash.`);let x=o.path.child(pe.fromString(k));if(!B.isDocumentKey(x))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);let W=new B(x);y.push(zi(a,W))}else{let x=RR(c,u,k);y.push(x)}}return new qn(y,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function PA(n,e,t){if(typeof(t=Re(t))=="string"){if(t==="")throw new M(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ev(e)&&t.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pe.fromString(t));if(!B.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return zi(n,new B(r))}if(t instanceof Ae)return zi(n,t._key);throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qd(t)}.`)}function DA(n,e){if(!Array.isArray(n)||n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NR(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var zo=class{convertValue(e,t="none"){switch(zr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw q(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ei(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Po].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ne(o.doubleValue));return new uc(s)}convertGeoPoint(e){return new Xi(Ne(e.latitude),Ne(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=zd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Kl(e));default:return null}}convertTimestamp(e){let t=ur(e);return new Ve(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pe.fromString(e);H(VS(r),9688,{name:e});let i=new $r(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||$e(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function nf(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var av=class extends zo{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};var cr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},on=class extends Zi{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Br(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(tf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Br=class extends on{data(e={}){return super.data(e)}},Tn=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new cr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Br(this._firestore,this._userDataWriter,r.key,r,new cr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Br(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Br(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:MF(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function MF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q(61501,{type:n})}}function rf(n,e){return n instanceof on&&e instanceof on?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Tn&&e instanceof Tn&&n._firestore===e._firestore&&Zd(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function g0(n){n=ge(n,Ae);let e=ge(n.firestore,Ue);return _R(ct(e),n._key).then(t=>b0(e,n,t))}var gr=class extends zo{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};function m0(n){n=ge(n,Ae);let e=ge(n.firestore,Ue),t=ct(e),r=new gr(e);return AF(t,n._key).then(i=>new on(e,r,n._key,i,new cr(i!==null&&i.hasLocalMutations,!0),n.converter))}function _0(n){n=ge(n,Ae);let e=ge(n.firestore,Ue);return _R(ct(e),n._key,{source:"server"}).then(t=>b0(e,n,t))}function y0(n){n=ge(n,lt);let e=ge(n.firestore,Ue),t=ct(e),r=new gr(e);return kR(n._query),yR(t,n._query).then(i=>new Tn(e,r,n,i))}function v0(n){n=ge(n,lt);let e=ge(n.firestore,Ue),t=ct(e),r=new gr(e);return SF(t,n._query).then(i=>new Tn(e,r,n,i))}function w0(n){n=ge(n,lt);let e=ge(n.firestore,Ue),t=ct(e),r=new gr(e);return yR(t,n._query,{source:"server"}).then(i=>new Tn(e,r,n,i))}function wc(n,e,t){n=ge(n,Ae);let r=ge(n.firestore,Ue),i=nf(n.converter,e,t);return Jo(r,[ef(ns(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,je.none())])}function sf(n,e,t,...r){n=ge(n,Ae);let i=ge(n.firestore,Ue),s=ns(i),o;return o=typeof(e=Re(e))=="string"||e instanceof bn?i0(s,"updateDoc",n._key,e,t,r):r0(s,"updateDoc",n._key,e),Jo(i,[o.toMutation(n._key,je.exists(!0))])}function C0(n){return Jo(ge(n.firestore,Ue),[new Qr(n._key,je.none())])}function E0(n,e){let t=ge(n.firestore,Ue),r=ts(n),i=nf(n.converter,e);return Jo(t,[ef(ns(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,je.exists(!1))]).then(()=>r)}function of(n,...e){var t,r,i;n=Re(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Qy(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Qy(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,u,d;if(n instanceof Ae)u=ge(n.firestore,Ue),d=Wo(n._key.path),c={next:p=>{e[o]&&e[o](b0(u,n,p))},error:e[o+1],complete:e[o+2]};else{let p=ge(n,lt);u=ge(p.firestore,Ue),d=p._query;let m=new gr(u);c={next:y=>{e[o]&&e[o](new Tn(u,m,p,y))},error:e[o+1],complete:e[o+2]},kR(n._query)}return function(m,y,T,k){let x=new qo(k),W=new cc(y,x,T);return m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Mv(yield $o(m),W)})),()=>{x.yu(),m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Nv(yield $o(m),W)}))}}(ct(u),d,a,c)}function I0(n,e){return RF(ct(n=ge(n,Ue)),Qy(e)?e:{next:e})}function Jo(n,e){return function(r,i){let s=new et;return r.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return aF(yield Gv(r),i,s)})),s.promise}(ct(n),e)}function b0(n,e,t){let r=t.docs.get(e._key),i=new gr(n);return new on(n,i,e._key,r,new cr(t.hasPendingWrites,t.fromCache),e.converter)}var NF={maxAttempts:5};var Ld=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ns(e)}set(e,t,r){this._verifyNotCommitted();let i=Ur(e,this._firestore),s=nf(i.converter,t,r),o=ef(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,je.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Ur(e,this._firestore),o;return o=typeof(t=Re(t))=="string"||t instanceof bn?i0(this._dataReader,"WriteBatch.update",s._key,t,r,i):r0(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,je.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ur(e,this._firestore);return this._mutations=this._mutations.concat(new Qr(t._key,je.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ur(n,e){if((n=Re(n)).firestore!==e)throw new M(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var lv=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ns(e)}get(e){let t=Ur(e,this._firestore),r=new av(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return q(24041);let s=i[0];if(s.isFoundDocument())return new Zi(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Zi(this._firestore,r,t._key,null,t.converter);throw q(18433,{doc:s})})}set(e,t,r){let i=Ur(e,this._firestore),s=nf(i.converter,t,r),o=ef(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){let s=Ur(e,this._firestore),o;return o=typeof(t=Re(t))=="string"||t instanceof bn?i0(this._dataReader,"Transaction.update",s._key,t,r,i):r0(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=Ur(e,this._firestore);return this._transaction.delete(t._key),this}};var cv=class extends lv{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ur(e,this._firestore),r=new gr(this._firestore);return super.get(e).then(i=>new on(this._firestore,r,t._key,i._document,new cr(!1,!1),t.converter))}};function T0(n,e,t){n=ge(n,Ue);let r=Object.assign(Object.assign({},NF),t);return function(s){if(s.maxAttempts<1)throw new M(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new et;return s.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let u=yield IF(s);new Hy(s.asyncQueue,u,a,o,c).Nu()})),c.promise}(ct(n),i=>e(new cv(n,i)),r)}function A0(){return new hc("deleteField")}function af(){return new Zy("serverTimestamp")}function FR(...n){return new ev("arrayUnion",n)}function OR(...n){return new tv("arrayRemove",n)}function S0(n){return new nv("increment",n)}(function(e,t=!0){(function(i){Go=i})(vu),_i(new tr("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ue(new a_(r.getProvider("auth-internal")),new u_(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $r(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ze(mT,_T,e),Ze(mT,_T,"esm2017")})();var FF="@firebase/firestore-compat",OF="0.3.46";function M0(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new M("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function VR(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function UR(){if(!QA())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}var lf=class n{constructor(e){this._delegate=e}static fromBase64String(e){return UR(),new n($n.fromBase64String(e))}static fromUint8Array(e){return VR(),new n($n.fromUint8Array(e))}toBase64(){return UR(),this._delegate.toBase64()}toUint8Array(){return VR(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function R0(n){return VF(n,["next","error","complete"])}function VF(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var P0=class{enableIndexedDbPersistence(e,t){return Qv(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Yv(e._delegate)}clearIndexedDbPersistence(e){return Jv(e._delegate)}},cf=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof $r||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&wn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){Yd(this._delegate,e,t,r)}enableNetwork(){return Zv(this._delegate)}disableNetwork(){return e0(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Hv("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Xv(this._delegate)}onSnapshotsInSync(e){return I0(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ea(this,Jd(this._delegate,e))}catch(t){throw St(t,"collection()","Firestore.collection()")}}doc(e){try{return new Gn(this,ts(this._delegate,e))}catch(t){throw St(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new as(this,Kv(this._delegate,e))}catch(t){throw St(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return T0(this._delegate,t=>e(new uf(this,t)))}batch(){return ct(this._delegate),new hf(new Ld(this._delegate,e=>Jo(this._delegate,e)))}loadBundle(e){return t0(this._delegate,e)}namedQuery(e){return n0(this._delegate,e).then(t=>t?new as(this,t):null)}},Xo=class extends zo{constructor(e){super(),this.firestore=e}convertBytes(e){return new lf(new $n(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Gn.forKey(t,this.firestore,null)}};function UF(n){uv(n)}var uf=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Xo(e)}get(e){let t=is(e);return this._delegate.get(t).then(r=>new ss(this._firestore,new on(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=is(e);return r?(M0("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=is(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=is(e);return this._delegate.delete(t),this}},hf=class{constructor(e){this._delegate=e}set(e,t,r){let i=is(e);return r?(M0("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=is(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=is(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Zo=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Br(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new os(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Xo(e),t),i.set(t,s)),s}};Zo.INSTANCES=new WeakMap;var Gn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Xo(e)}static forPath(e,t,r){if(e.length%2!==0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Ae(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new Ae(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ea(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ea(this.firestore,Jd(this._delegate,e))}catch(t){throw St(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Re(e),e instanceof Ae?Xd(this._delegate,e):!1}set(e,t){t=M0("DocumentReference.set",t);try{return t?wc(this._delegate,e,t):wc(this._delegate,e)}catch(r){throw St(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?sf(this._delegate,e):sf(this._delegate,e,t,...r)}catch(i){throw St(i,"updateDoc()","DocumentReference.update()")}}delete(){return C0(this._delegate)}onSnapshot(...e){let t=LR(e),r=BR(e,i=>new ss(this.firestore,new on(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return of(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=m0(this._delegate):e?.source==="server"?t=_0(this._delegate):t=g0(this._delegate),t.then(r=>new ss(this.firestore,new on(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Zo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function St(n,e,t){return n.message=n.message.replace(e,t),n}function LR(n){for(let e of n)if(typeof e=="object"&&!R0(e))return e;return{}}function BR(n,e){var t,r;let i;return R0(n[0])?i=n[0]:R0(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ss=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Gn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return rf(this._delegate,e._delegate)}},os=class extends ss{data(e){let t=this._delegate.data(e);return this._delegate._converter||kA(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},as=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Xo(e)}where(e,t,r){try{return new n(this.firestore,zn(this._delegate,a0(e,t,r)))}catch(i){throw St(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,zn(this._delegate,l0(e,t)))}catch(r){throw St(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,zn(this._delegate,c0(e)))}catch(t){throw St(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,zn(this._delegate,u0(e)))}catch(t){throw St(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,zn(this._delegate,h0(...e)))}catch(t){throw St(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,zn(this._delegate,d0(...e)))}catch(t){throw St(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,zn(this._delegate,f0(...e)))}catch(t){throw St(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,zn(this._delegate,p0(...e)))}catch(t){throw St(t,"endAt()","Query.endAt()")}}isEqual(e){return Zd(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=v0(this._delegate):e?.source==="server"?t=w0(this._delegate):t=y0(this._delegate),t.then(r=>new Cc(this.firestore,new Tn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=LR(e),r=BR(e,i=>new Cc(this.firestore,new Tn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return of(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Zo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},D0=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new os(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Cc=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new as(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new os(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new D0(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new os(this._firestore,r))})}isEqual(e){return rf(this._delegate,e._delegate)}},ea=class n extends as{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Gn(this.firestore,e):null}doc(e){try{return e===void 0?new Gn(this.firestore,ts(this._delegate)):new Gn(this.firestore,ts(this._delegate,e))}catch(t){throw St(t,"doc()","CollectionReference.doc()")}}add(e){return E0(this._delegate,e).then(t=>new Gn(this.firestore,t))}isEqual(e){return Xd(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Zo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function is(n){return ge(n,Ae)}var x0=class n{constructor(...e){this._delegate=new bn(...e)}static documentId(){return new n(ze.keyField().canonicalString())}isEqual(e){return e=Re(e),e instanceof bn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var k0=class n{static serverTimestamp(){let e=af();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=A0();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=FR(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=OR(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=S0(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var LF={Firestore:cf,GeoPoint:Xi,Timestamp:Ve,Blob:lf,Transaction:uf,WriteBatch:hf,DocumentReference:Gn,DocumentSnapshot:ss,Query:as,QueryDocumentSnapshot:os,QuerySnapshot:Cc,CollectionReference:ea,FieldPath:x0,FieldValue:k0,setLogLevel:UF,CACHE_SIZE_UNLIMITED:ER};function BF(n,e){n.INTERNAL.registerComponent(new tr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},LF)))}function jF(n){BF(n,(e,t)=>new cf(e,t,new P0)),n.registerVersion(FF,OF)}jF(bt);function qF(n,e=Zc){return new Wt(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function jR(n,e){return qF(n,e)}function $F(n,e){return jR(n,e).pipe(ws(void 0),tu(),te(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function O0(n,e){return jR(n,e).pipe(te(t=>({payload:t,type:"query"})))}var df=class{ref;afs;injector=Q(Ot);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:s}=zR(r,t);return new pf(i,s,this.afs)}snapshotChanges(){return $F(this.ref,this.afs.schedulers.outsideAngular).pipe(at(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(te(({payload:t})=>e.idField?ye($({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Fe(this.ref.get(e)).pipe(at(this.injector))}};function ff(n,e){return O0(n,e).pipe(ws(void 0),tu(),te(t=>{let[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(p=>p.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function qR(n,e,t){return ff(n,t).pipe(vs((r,i)=>zF(r,i.map(s=>s.payload),e),[]),hC(),te(r=>r.map(i=>({type:i.type,payload:i}))))}function zF(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=GF(n,r))}),n}function N0(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function GF(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return N0(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return N0(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return N0(n,e.oldIndex,1);break}return n}function $R(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var pf=class{ref;query;afs;injector=Q(Ot);constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=ff(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(te(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ws(void 0),tu(),cn(([r,i])=>i.length>0||!r),te(([,r])=>r),at(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(vs((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=$R(e);return qR(this.query,t,this.afs.schedulers.outsideAngular).pipe(at(this.injector))}valueChanges(e={}){return O0(this.query,this.afs.schedulers.outsideAngular).pipe(te(t=>t.payload.docs.map(r=>e.idField?ye($({},r.data()),{[e.idField]:r.id}):r.data())),at(this.injector))}get(e){return Fe(this.query.get(e)).pipe(at(this.injector))}add(e){return this.ref.add(e)}doc(e){return new df(this.ref.doc(e),this.afs)}},F0=class{query;afs;injector=Q(Ot);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?ff(this.query,this.afs.schedulers.outsideAngular).pipe(at(this.injector)):ff(this.query,this.afs.schedulers.outsideAngular).pipe(te(t=>t.filter(r=>e.indexOf(r.type)>-1)),cn(t=>t.length>0),at(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(vs((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=$R(e);return qR(this.query,t,this.afs.schedulers.outsideAngular).pipe(at(this.injector))}valueChanges(e={}){return O0(this.query,this.afs.schedulers.outsideAngular).pipe(te(r=>r.payload.docs.map(i=>e.idField?$({[e.idField]:i.id},i.data()):i.data())),at(this.injector))}get(e){return Fe(this.query.get(e)).pipe(at(this.injector))}},WF=new ne("angularfire2.enableFirestorePersistence"),HF=new ne("angularfire2.firestore.persistenceSettings"),KF=new ne("angularfire2.firestore.settings"),QF=new ne("angularfire2.firestore.use-emulator");function zR(n,e=t=>t){return{query:e(n),ref:n}}var GR=(()=>{class n{schedulers;firestore;persistenceEnabled$;ngZone=Q(xe);constructor(t,r,i,s,o,a,c,u,d,p,m,y,T,k,x,W,K){this.schedulers=c;let F=Rl(t,a,r),X=d;p&&Gm(F,a,m,T,k,x,y,W),[this.firestore,this.persistenceEnabled$]=wh(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let re=a.runOutsideAngular(()=>F.firestore());if(s&&re.settings(s),X&&re.useEmulator(...X),i&&!gi(o)){let ie=()=>{try{return Fe(re.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(C){return typeof console<"u"&&console.warn(C),J(!1)}};return[re,a.runOutsideAngular(ie)]}else return[re,J(!1)]},[s,X,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=zR(i,r),a=this.ngZone.run(()=>s);return new pf(a,o,this)}collectionGroup(t,r){let i=r||(o=>o),s=this.firestore.collectionGroup(t);return new F0(i(s),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.ngZone.run(()=>r);return new df(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(z(ro),z(io,8),z(WF,8),z(KF,8),z(Ut),z(xe),z(rn),z(HF,8),z(QF,8),z(fT,8),z(Lm,8),z(Bm,8),z(jm,8),z(qm,8),z($m,8),z(zm,8),z(Nn,8))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();function KR(n){return new Wt(function(e){var t=Cu(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var QR="auth",ls=class{constructor(e){return e}},Ec=class{constructor(){return no(QR)}};var V0=new ne("angularfire2.auth-instances");function $O(n,e){let t=Tl(QR,n,e);return t&&new ls(t)}function zO(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ls(r)}}var GO={provide:Ec,deps:[[new Rt,V0]]},WO={provide:ls,useFactory:$O,deps:[[new Rt,V0],sr]};function YR(n,...e){return Ze("angularfire",_n.full,"auth"),Ir([WO,GO,{provide:V0,useFactory:zO(n),multi:!0,deps:[xe,Qt,rn,ki,[new Rt,Nn],...e]}])}var U0=qt(KR,!0);var JR=qt(Lp,!0,2);var XR=qt(qp,!0);var ZR=qt(Bp,!0,2);var e1=qt(jp,!0,2);var cs=class{constructor(e){return e}},t1="firestore",L0=class{constructor(){return no(t1)}};var B0=new ne("angularfire2.firestore-instances");function KO(n,e){let t=Tl(t1,n,e);return t&&new cs(t)}function QO(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new cs(r)}}var YO={provide:L0,deps:[[new Rt,B0]]},JO={provide:cs,useFactory:KO,deps:[[new Rt,B0],sr]};function n1(n,...e){return Ze("angularfire",_n.full,"fst"),Ir([JO,YO,{provide:B0,useFactory:QO(n),multi:!0,deps:[xe,Qt,rn,ki,[new Rt,Ec],[new Rt,Nn],...e]}])}var r1=qt(ts,!0,2);var i1=qt(IR,!0);var s1=qt(wc,!0,2);var gf=class n{getError(e){return{"auth/claims-too-large":"La carga \xFAtil de la reclamaci\xF3n que se entreg\xF3 a setCustomUserClaims() supera el tama\xF1o m\xE1ximo de 1,000 bytes.","auth/email-already-exists":"Otro usuario ya est\xE1 utilizando el correo electr\xF3nico proporcionado. Cada usuario debe tener un correo electr\xF3nico \xFAnico.","auth/email-already-in-use":"Otro usuario ya est\xE1 utilizando el correo electr\xF3nico proporcionado.","auth/id-token-expired":"El token de ID de Firebase que se proporcion\xF3 est\xE1 vencido.","auth/id-token-revoked":"Se revoc\xF3 el token de ID de Firebase.","auth/insufficient-permission":"La credencial que se us\xF3 para inicializar el SDK de Admin no tiene permisos suficientes a fin de acceder al recurso de autenticaci\xF3n solicitado. Consulta c\xF3mo configurar un proyecto de Firebase para ver la documentaci\xF3n sobre c\xF3mo generar una credencial con los permisos apropiados y usarla en la autenticaci\xF3n de los SDK de Admin.","auth/internal-error":"El servidor de autenticaci\xF3n encontr\xF3 un error inesperado cuando se intentaba procesar la solicitud. Para obtener informaci\xF3n adicional, revisa la respuesta del servidor de autenticaci\xF3n, que deber\xEDa estar incluida en el mensaje de error. Si el error persiste, av\xEDsanos mediante nuestro canal de asistencia de informe de errores.","auth/invalid-argument":"Se proporcion\xF3 un argumento no v\xE1lido para un m\xE9todo de autenticaci\xF3n. El mensaje de error debe incluir informaci\xF3n adicional.","auth/invalid-claims":"Los atributos personalizados del reclamo que se entregaron a setCustomUserClaims() no son v\xE1lidos.","auth/invalid-continue-uri":"La URL de continuaci\xF3n debe ser una string de URL v\xE1lida.","auth/invalid-creation-time":"La hora de creaci\xF3n debe ser una string de fecha en formato UTC v\xE1lida.","auth/invalid-credential":"La credencial que se usa en la autenticaci\xF3n de los SDK de Admin no se puede emplear para realizar la acci\xF3n deseada. Algunos m\xE9todos de autenticaci\xF3n, como createCustomToken() y verifyIdToken(), requieren que los SDK se inicialicen con una credencial de certificado en lugar de un token de actualizaci\xF3n o una credencial predeterminada de la aplicaci\xF3n. Consulta Inicializa el SDK para ver documentaci\xF3n sobre c\xF3mo autenticar el SDK de Admin con una credencial de certificado.","auth/invalid-disabled-field":"El valor que se proporcion\xF3 para la propiedad del usuario disabled no es v\xE1lido. Debe ser un booleano.","auth/invalid-display-name":"El valor que se proporcion\xF3 para la propiedad del usuario displayName no es v\xE1lido. Debe ser una string que no est\xE9 vac\xEDa.","auth/invalid-dynamic-link-domain":"El dominio del v\xEDnculo din\xE1mico proporcionado no se configur\xF3 o no se autoriz\xF3 para el proyecto actual.","auth/invalid-email":"	La direcci\xF3n de correo electr\xF3nico ingresada no es valida.","auth/invalid-email-verified":"El valor que se proporcion\xF3 para la propiedad del usuario emailVerified no es v\xE1lido. Debe ser un booleano.","auth/invalid-hash-algorithm":"El algoritmo de hash debe coincidir con las strings de la lista de algoritmos compatibles.","auth/invalid-hash-block-size":"El tama\xF1o del conjunto de hash debe ser un n\xFAmero v\xE1lido.","auth/invalid-hash-derived-key-length":"La longitud de la clave derivada de hash debe ser un n\xFAmero v\xE1lido.","auth/invalid-hash-key":"La clave de hash debe ser un b\xFAfer de bytes v\xE1lido.","auth/invalid-hash-memory-cost":"El costo de la memoria de hash debe ser un n\xFAmero v\xE1lido.","auth/invalid-hash-parallelization":"La paralelizaci\xF3n de hash debe ser un n\xFAmero v\xE1lido.","auth/invalid-hash-rounds":"Las rondas de hash deben ser un n\xFAmero v\xE1lido.","auth/invalid-hash-salt-separator":"El campo del separador de sal del algoritmo de hash debe ser un b\xFAfer de bytes v\xE1lido.","auth/invalid-id-token":"El token de ID que se proporcion\xF3 no es un token de ID de Firebase v\xE1lido.","auth/invalid-last-sign-in-time":"La hora del \xFAltimo acceso debe ser una string de fecha en formato UTC v\xE1lida.","auth/invalid-page-token":"El token de p\xE1gina siguiente que se entreg\xF3 en listUsers() no es v\xE1lido. Debe ser una string v\xE1lida que no est\xE9 vac\xEDa.","auth/invalid-password":"El valor que se proporcion\xF3 para la propiedad del usuario password no es v\xE1lido. Debe ser una string con al menos seis caracteres.","auth/invalid-password-hash":"El hash de contrase\xF1as debe ser un b\xFAfer de bytes v\xE1lidos.","auth/invalid-password-salt":"La contrase\xF1a con sal debe ser un b\xFAfer de bytes v\xE1lido.","auth/invalid-phone-number":"El valor que se proporcion\xF3 para phoneNumber no es v\xE1lido. Debe ser una string de identificador que no est\xE9 vac\xEDa y que cumpla con el est\xE1ndar E.164.","auth/invalid-photo-url":"El valor que se proporcion\xF3 para la propiedad del usuario photoURL no es v\xE1lido. Debe ser una URL de string.","auth/invalid-provider-data":"providerData debe ser una serie de objetos UserInfo.","auth/invalid-provider-id":"providerId debe ser una string del identificador del proveedor compatible v\xE1lida.","auth/invalid-session-cookie-duration":"La duraci\xF3n de las cookies de la sesi\xF3n debe ser un n\xFAmero v\xE1lido en milisegundos que vaya entre los 5 minutos y las 2 semanas.","auth/invalid-uid":"El uid proporcionado debe ser una string no vac\xEDa con un m\xE1ximo de 128 caracteres.","auth/invalid-user-import":"El registro de usuarios para importar no es v\xE1lido.","auth/maximum-user-count-exceeded":"Se excedi\xF3 la cantidad m\xE1xima de usuarios permitidos para importar.","auth/missing-android-pkg-name":"Si es obligatorio instalar la app para Android, debe proporcionarse un nombre de paquete de Android.","auth/missing-continue-uri":"Se debe proporcionar una URL de continuaci\xF3n v\xE1lida en la solicitud.","auth/missing-hash-algorithm":"Para importar usuarios con hash de contrase\xF1as, es necesario proporcionar el algoritmo de hash y sus par\xE1metros.","auth/missing-ios-bundle-id":"La solicitud debe contener un ID del paquete de iOS.","auth/missing-uid":"Se requiere un identificador uid para la operaci\xF3n actual.","auth/operation-not-allowed":"El proveedor de acceso proporcionado est\xE1 inhabilitado para tu proyecto de Firebase. Habil\xEDtalo en la secci\xF3n M\xE9todo de acceso de Firebase console.","auth/phone-number-already-exists":"Otro usuario ya utiliza el phoneNumber proporcionado. Cada usuario debe tener un phoneNumber \xFAnico.","auth/project-not-found":"No se encontr\xF3 ning\xFAn proyecto de Firebase correspondiente a la credencial que se us\xF3 para inicializar los SDK de administrador. Consulta c\xF3mo configurar un proyecto de Firebase para ver la documentaci\xF3n sobre c\xF3mo generar una credencial para tu proyecto y usarla en la autenticaci\xF3n de los SDK de Admin.","auth/reserved-claims":"Uno o m\xE1s de los reclamos personalizados de usuarios que se entregaron a setCustomUserClaims() est\xE1n reservados. Por ejemplo, no deben usarse reclamos espec\xEDficos de OIDC (p. ej., sub, iat, iss, exp, aud o auth_time) como claves para reclamos personalizados.","auth/session-cookie-expired":"La cookie proporcionada de la sesi\xF3n de Firebase venci\xF3.","auth/session-cookie-revoked":"Se revocaron las cookies de la sesi\xF3n de Firebase.","auth/uid-already-exists":"Otro usuario ya utiliza el uid proporcionado. Cada usuario debe tener un uid \xFAnico.","auth/unauthorized-continue-uri":"El dominio de la URL de continuaci\xF3n no est\xE1 en la lista blanca. Incl\xFAyelo en la lista en Firebase console.","auth/wrong-password":"Contrase\xF1a err\xF3nea","auth/user-not-found":"El correo electr\xF3nico proporcionado no corresponde a un usuario activo"}[e]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var an=class n{constructor(e,t,r){this.auth=e;this.firestore=t;this.error=r;this.user$=U0(this.auth),this.usuario$=U0(this.auth).pipe(te(i=>i?(console.log(i),i):J(null)))}user$;usuario$;registro(e,t){return R(this,null,function*(){try{return yield JR(this.auth,e,t)}catch(r){throw console.log(r.message),console.log(r.code),new Error(this.error.getError(r.code))}})}login(e,t){return R(this,null,function*(){try{let r=yield ZR(this.auth,e,t);return this.updateLogUser(e),r}catch(r){throw new Error(this.error.getError(r.code))}})}logout(){return e1(this.auth)}getUsuarioFire(){return this.auth.currentUser}updateLogUser(e){return R(this,null,function*(){let t=this.auth.currentUser;try{return yield s1(r1(this.firestore,"userlog"),{email:e,fechaIngreso:af()}),!0}catch(r){return console.log(r),r}})}static \u0275fac=function(t){return new(t||n)(z(ls),z(cs),z(gf))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var mf=class n{constructor(e,t,r){this.afs=e;this.authSvc=t;this.router=r;this.getUseMail()}mail;addChatMessage(e){return this.getUseMail(),this.afs.collection("messages").add({msg:e,from:this.mail,createdAt:bt.firestore.FieldValue.serverTimestamp()})}getChatMessages(){let e=[];return this.getUseMail(),this.getUsers().pipe(Xe(t=>(e=t,this.afs.collection("messages",r=>r.orderBy("createdAt","desc")).valueChanges({idField:"id"}))),te(t=>{for(let r of t)r.fromName=this.getUserForMsg(r.from,e),r.myMsg=this.mail===r.from;return t}))}getUsers(){return this.afs.collection("user").valueChanges({idField:"uid"})}getUseMail(){return R(this,null,function*(){(yield this.authSvc.getUsuarioFire())?this.mail=this.authSvc.getUsuarioFire()?.email:this.mail="usuario anonimo"})}getUserForMsg(e,t){this.getUseMail(),console.log("users mail",this.mail);for(let r of t)if(console.log("users usr.email",r.email),console.log("msgFromId",e),this.mail==e)return r.email;return"no reconocido"}static \u0275fac=function(t){return new(t||n)(z(GR),z(an),z(Tt))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var g1=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Z(di),Z(hi))};static \u0275dir=qe({type:n})}return n})(),H0=(()=>{class n extends g1{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275dir=qe({type:n,features:[Jt]})}return n})(),Rc=new ne("");var eV={provide:Rc,useExisting:Yn(()=>ii),multi:!0};function tV(){let n=Tr()?Tr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var nV=new ne(""),ii=(()=>{class n extends g1{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!tV())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Z(di),Z(hi),Z(nV,8))};static \u0275dir=qe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&Me("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},standalone:!1,features:[Zn([eV]),Jt]})}return n})();function K0(n){return n==null||Q0(n)===0}function Q0(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Pc=new ne(""),Y0=new ne(""),rV=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Mt=class{static min(e){return iV(e)}static max(e){return sV(e)}static required(e){return m1(e)}static requiredTrue(e){return oV(e)}static email(e){return aV(e)}static minLength(e){return _1(e)}static maxLength(e){return lV(e)}static pattern(e){return cV(e)}static nullValidator(e){return yf()}static compose(e){return I1(e)}static composeAsync(e){return T1(e)}};function iV(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function sV(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function m1(n){return K0(n.value)?{required:!0}:null}function oV(n){return n.value===!0?null:{required:!0}}function aV(n){return K0(n.value)||rV.test(n.value)?null:{email:!0}}function _1(n){return e=>{let t=e.value?.length??Q0(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function lV(n){return e=>{let t=e.value?.length??Q0(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function cV(n){if(!n)return yf;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(K0(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function yf(n){return null}function y1(n){return n!=null}function v1(n){return ou(n)?Fe(n):n}function w1(n){let e={};return n.forEach(t=>{e=t!=null?$($({},e),t):e}),Object.keys(e).length===0?null:e}function C1(n,e){return e.map(t=>t(n))}function uV(n){return!n.validate}function E1(n){return n.map(e=>uV(e)?e:t=>e.validate(t))}function I1(n){if(!n)return null;let e=n.filter(y1);return e.length==0?null:function(t){return w1(C1(t,e))}}function b1(n){return n!=null?I1(E1(n)):null}function T1(n){if(!n)return null;let e=n.filter(y1);return e.length==0?null:function(t){let r=C1(t,e).map(v1);return cC(r).pipe(te(w1))}}function A1(n){return n!=null?T1(E1(n)):null}function o1(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function S1(n){return n._rawValidators}function R1(n){return n._rawAsyncValidators}function j0(n){return n?Array.isArray(n)?n:[n]:[]}function vf(n,e){return Array.isArray(n)?n.includes(e):n===e}function a1(n,e){let t=j0(e);return j0(n).forEach(i=>{vf(t,i)||t.push(i)}),t}function l1(n,e){return j0(e).filter(t=>!vf(n,t))}var wf=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=b1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=A1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},us=class extends wf{name;get formDirective(){return null}get path(){return null}},hs=class extends wf{_parent=null;name=null;valueAccessor=null},Cf=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},hV={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},eq=ye($({},hV),{"[class.ng-submitted]":"isSubmitted"}),ia=(()=>{class n extends Cf{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Z(hs,2))};static \u0275dir=qe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Pp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Jt]})}return n})(),Af=(()=>{class n extends Cf{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Z(us,10))};static \u0275dir=qe({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Pp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Jt]})}return n})();var bc="VALID",_f="INVALID",ta="PENDING",Tc="DISABLED",ri=class{},Ef=class extends ri{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Ac=class extends ri{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Sc=class extends ri{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},na=class extends ri{status;source;constructor(e,t){super(),this.status=e,this.source=t}},q0=class extends ri{source;constructor(e){super(),this.source=e}},$0=class extends ri{source;constructor(e){super(),this.source=e}};function J0(n){return(Sf(n)?n.validators:n)||null}function dV(n){return Array.isArray(n)?b1(n):n||null}function X0(n,e){return(Sf(e)?e.asyncValidators:n)||null}function fV(n){return Array.isArray(n)?A1(n):n||null}function Sf(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function P1(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Te(1e3,"");if(!r[t])throw new Te(1001,"")}function D1(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Te(1002,"")})}var ra=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return er(this.statusReactive)}set status(e){er(()=>this.statusReactive.set(e))}_status=bs(()=>this.statusReactive());statusReactive=Cs(void 0);get valid(){return this.status===bc}get invalid(){return this.status===_f}get pending(){return this.status==ta}get disabled(){return this.status===Tc}get enabled(){return this.status!==Tc}errors;get pristine(){return er(this.pristineReactive)}set pristine(e){er(()=>this.pristineReactive.set(e))}_pristine=bs(()=>this.pristineReactive());pristineReactive=Cs(!0);get dirty(){return!this.pristine}get touched(){return er(this.touchedReactive)}set touched(e){er(()=>this.touchedReactive.set(e))}_touched=bs(()=>this.touchedReactive());touchedReactive=Cs(!1);get untouched(){return!this.touched}_events=new Ft;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(a1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(a1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(l1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(l1(e,this._rawAsyncValidators))}hasValidator(e){return vf(this._rawValidators,e)}hasAsyncValidator(e){return vf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ye($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Sc(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Sc(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ye($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Ac(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Ac(!0,r))}markAsPending(e={}){this.status=ta;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new na(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ye($({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Tc,this.errors=null,this._forEachChild(i=>{i.disable(ye($({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ef(this.value,r)),this._events.next(new na(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ye($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=bc,this._forEachChild(r=>{r.enable(ye($({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ye($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===bc||this.status===ta)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ef(this.value,t)),this._events.next(new na(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ye($({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Tc:bc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=ta,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=v1(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new na(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Yt,this.statusChanges=new Yt}_calculateStatus(){return this._allControlsDisabled()?Tc:this.errors?_f:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ta)?ta:this._anyControlsHaveStatus(_f)?_f:bc}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Ac(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Sc(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Sf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=dV(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=fV(this._rawAsyncValidators)}},If=class extends ra{constructor(e,t,r){super(J0(t),X0(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){D1(this,!0,e),Object.keys(e).forEach(r=>{P1(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var z0=class extends If{};var Rf=new ne("",{providedIn:"root",factory:()=>Pf}),Pf="always";function x1(n,e){return[...e.path,n]}function G0(n,e,t=Pf){Z0(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),gV(n,e),_V(n,e),mV(n,e),pV(n,e)}function c1(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Tf(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function bf(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function pV(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Z0(n,e){let t=S1(n);e.validator!==null?n.setValidators(o1(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=R1(n);e.asyncValidator!==null?n.setAsyncValidators(o1(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();bf(e._rawValidators,i),bf(e._rawAsyncValidators,i)}function Tf(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=S1(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=R1(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return bf(e._rawValidators,r),bf(e._rawAsyncValidators,r),t}function gV(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&k1(n,e)})}function mV(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&k1(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function k1(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function _V(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function yV(n,e){n==null,Z0(n,e)}function vV(n,e){return Tf(n,e)}function M1(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function wV(n){return Object.getPrototypeOf(n.constructor)===H0}function CV(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function N1(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===ii?t=s:wV(s)?r=s:i=s}),i||r||t||null}function EV(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function u1(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function h1(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var _r=class extends ra{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(J0(t),X0(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Sf(t)&&(t.nonNullable||t.initialValueIsDefault)&&(h1(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){u1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){u1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){h1(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var IV=n=>n instanceof _r;var bV={provide:hs,useExisting:Yn(()=>Dc)},d1=Promise.resolve(),Dc=(()=>{class n extends hs{_changeDetectorRef;callSetDisabledState;control=new _r;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Yt;constructor(t,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=N1(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),M1(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){G0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){d1.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&pi(r);d1.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?x1(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(Z(us,9),Z(Pc,10),Z(Y0,10),Z(Rc,10),Z(Na,8),Z(Rf,8))};static \u0275dir=qe({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Zn([bV]),Jt,Jn]})}return n})();var Df=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=qe({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var F1=new ne("");var TV={provide:us,useExisting:Yn(()=>xc)},xc=(()=>{class n extends us{callSetDisabledState;get submitted(){return er(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=bs(()=>this._submittedReactive());_submittedReactive=Cs(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Yt;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Tf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return G0(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){c1(t.control||null,t,!1),EV(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),CV(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new q0(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new $0(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(c1(r||null,t),IV(i)&&(G0(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);yV(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&vV(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Z0(this.form,this),this._oldForm&&Tf(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(Z(Pc,10),Z(Y0,10),Z(Rf,8))};static \u0275dir=qe({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&Me("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Zn([TV]),Jt,Jn]})}return n})();var AV={provide:hs,useExisting:Yn(()=>kc)},kc=(()=>{class n extends hs{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new Yt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=N1(this,s)}ngOnChanges(t){this._added||this._setUpControl(),M1(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return x1(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(Z(us,13),Z(Pc,10),Z(Y0,10),Z(Rc,10),Z(F1,8))};static \u0275dir=qe({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Zn([AV]),Jt,Jn]})}return n})();var SV={provide:Rc,useExisting:Yn(()=>xf),multi:!0};function O1(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function RV(n){return n.split(":")[0]}var xf=(()=>{class n extends H0{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=O1(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=RV(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275dir=qe({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&Me("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Zn([SV]),Jt]})}return n})(),V1=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(O1(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Z(hi),Z(di),Z(xf,9))};static \u0275dir=qe({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),PV={provide:Rc,useExisting:Yn(()=>U1),multi:!0};function f1(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function DV(n){return n.split(":")[0]}var U1=(()=>{class n extends H0{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(s=>this._getOptionId(s));r=(s,o)=>{s._setSelected(i.indexOf(o.toString())>-1)}}else r=(i,s)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],s=r.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let c=o[a],u=this._getOptionValue(c.value);i.push(u)}}else{let o=r.options;for(let a=0;a<o.length;a++){let c=o[a];if(c.selected){let u=this._getOptionValue(c.value);i.push(u)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=DV(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275dir=qe({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&Me("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Zn([PV]),Jt]})}return n})(),L1=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(f1(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(f1(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Z(hi),Z(di),Z(U1,9))};static \u0275dir=qe({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function xV(n){return typeof n=="number"?n:parseInt(n,10)}var B1=(()=>{class n{_validator=yf;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):yf,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=qe({type:n,features:[Jn]})}return n})();var kV={provide:Pc,useExisting:Yn(()=>Mc),multi:!0};var Mc=(()=>{class n extends B1{required;inputName="required";normalizeInput=pi;createValidator=t=>m1;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275dir=qe({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&Da("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Zn([kV]),Jt]})}return n})();var MV={provide:Pc,useExisting:Yn(()=>ew),multi:!0},ew=(()=>{class n extends B1{minlength;inputName="minlength";normalizeInput=t=>xV(t);createValidator=t=>_1(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Xn(n)))(i||n)}})();static \u0275dir=qe({type:n,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&Da("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},standalone:!1,features:[Zn([MV]),Jt]})}return n})();var j1=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=hn({type:n});static \u0275inj=un({})}return n})(),W0=class extends ra{constructor(e,t,r){super(J0(t),X0(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){D1(this,!1,e),e.forEach((r,i)=>{P1(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function p1(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var kf=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return p1(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new If(i,s)}record(t,r=null){let i=this._reduceControls(t);return new z0(i,r)}control(t,r,i){let s={};return this.useNonNullable?(p1(r)?s=r:(s.validators=r,s.asyncValidators=i),new _r(t,ye($({},s),{nonNullable:!0}))):new _r(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new W0(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof _r)return t;if(t instanceof ra)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var sa=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Rf,useValue:t.callSetDisabledState??Pf}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=hn({type:n});static \u0275inj=un({imports:[j1]})}return n})(),Mf=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:F1,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Rf,useValue:t.callSetDisabledState??Pf}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=hn({type:n});static \u0275inj=un({imports:[j1]})}return n})();var NV=[".container"],FV=(n,e)=>({"messages__item--operator":n,"messages__item--visitor":e});function OV(n,e){if(n&1&&(O(0,"div")(1,"div",14)(2,"b"),G(3),U(),we(4,"br"),O(5,"span"),G(6),U(),O(7,"span",15),we(8,"br"),G(9),fi(10,"date"),U()()()),n&2){let t=e.$implicit;se(),ke("ngClass",NC(7,FV,t.myMsg,!t.myMsg)),se(2),dn(t.fromName),se(3),Ma("",t.msg," "),se(3),dn(FC(10,4,t.createdAt==null?null:t.createdAt.toMillis(),"short"))}}var Nf=class n{content;chatSer=Q(mf);router=Q(Tt);state;icons;args;chatBoxContent;chatboxStatus;messages;newMsg="";constructor(){this.state=!1}ngOnInit(){this.messages=this.chatSer.getChatMessages()}toggleState(){this.state=!this.state,this.showOrHideChatBox()}showOrHideChatBox(){this.state?this.chatboxStatus="chatbox--active":this.state||(this.chatboxStatus="chatbox--inactive")}sendMessage(){this.chatSer.addChatMessage(this.newMsg).then(()=>{this.newMsg=""})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=He({type:n,selectors:[["app-chat"]],viewQuery:function(t,r){if(t&1&&kC(NV,5),t&2){let i;Dp(i=xp())&&(r.content=i.first)}},decls:18,vars:7,consts:[[1,"container"],[1,"chatbox"],[1,"chatbox__header"],[1,"chatbox__image--header"],[1,"chatbox__content--header"],[1,"chatbox__heading--header"],[1,"chatbox__messages"],[4,"ngFor","ngForOf"],[1,"chatbox__footer"],["type","text","placeholder","Escriba un mensaje...","maxLength","500",3,"ngModelChange","keydown.enter","ngModel"],[1,"chatbox__send--footer",3,"click"],[1,"chatbox__button"],[3,"click"],["src","../../../assets/imagenes/chat/chatbox-icon.svg"],[1,"messages__item",3,"ngClass"],[1,"time"]],template:function(t,r){t&1&&(O(0,"div",0)(1,"div",1)(2,"div")(3,"div",2),we(4,"div",3),O(5,"div",4)(6,"h4",5),G(7,"Chat"),U()()(),O(8,"div",6),ot(9,OV,11,10,"div",7),fi(10,"async"),U(),O(11,"div",8)(12,"input",9),uu("ngModelChange",function(s){return cu(r.newMsg,s)||(r.newMsg=s),s}),Me("keydown.enter",function(){return r.sendMessage()}),U(),O(13,"p",10),Me("click",function(){return r.sendMessage()}),G(14,"Enviar"),U()()(),O(15,"div",11)(16,"button",12),Me("click",function(){return r.toggleState()}),we(17,"img",13),U()()()()),t&2&&(se(2),xa("chatbox__support ",r.chatboxStatus,""),se(7),ke("ngForOf",Es(10,5,r.messages)),se(3),lu("ngModel",r.newMsg))},dependencies:[It,$C,fu,Ts,zC,sa,ii,ia,Dc],styles:['*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0}.container[_ngcontent-%COMP%]{--primaryGradient: linear-gradient(93.12deg, #581b98 .52%, #9c1de7 100%);--secondaryGradient: linear-gradient(268.91deg, #581b98 -2.14%, #9c1de7 99.69%);--primaryBoxShadow: 0px 10px 15px rgba(0, 0, 0, .1);--secondaryBoxShadow: 0px -10px 15px rgba(0, 0, 0, .1);--light: 300;--regular: 400;--semiBold: 600;--extraLight: 300;--italic: 300;--primary: #581b98;font-family:Nunito,sans-serif;font-weight:400;font-size:100%;background:#f1f1f1;z-index:20}body[_ngcontent-%COMP%]{font-family:Nunito,sans-serif;font-weight:400;font-size:100%;background:#f1f1f1;z-index:20}.chatbox__header[_ngcontent-%COMP%]{background:var(--primaryGradient);display:flex;flex-direction:row;align-items:center;justify-content:center;padding:15px 20px;border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:var(--primaryBoxShadow)}.chatbox__image--header[_ngcontent-%COMP%]{margin-right:10px}.chatbox__heading--header[_ngcontent-%COMP%]{font-size:1.2rem;color:#fff}.chatbox__description--header[_ngcontent-%COMP%]{font-size:.9rem;color:#fff}.chatbox__messages[_ngcontent-%COMP%]{padding:0 20px}.messages__item[_ngcontent-%COMP%]{margin-top:10px;background:#e0e0e0;padding:8px 12px;max-width:70%}.messages__item--visitor[_ngcontent-%COMP%], .messages__item--typing[_ngcontent-%COMP%]{border-top-left-radius:20px;border-top-right-radius:20px;border-bottom-right-radius:20px}.messages__item--operator[_ngcontent-%COMP%]{border-top-left-radius:20px;border-top-right-radius:20px;border-bottom-left-radius:20px;background:var(--primary);color:#fff}.chatbox__footer[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:20px;background:var(--secondaryGradient);box-shadow:var(--secondaryBoxShadow);border-bottom-right-radius:10px;border-bottom-left-radius:10px;margin-top:20px}.chatbox__footer[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;padding:10px;border-radius:30px;text-align:center}.chatbox__send--footer[_ngcontent-%COMP%]{color:#fff;font-weight:400}.chatbox__button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .chatbox__button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .chatbox__button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:visited{padding:10px;background:#fff;border:none;outline:none;border-top-left-radius:50px;border-top-right-radius:50px;border-bottom-left-radius:50px;box-shadow:0 10px 15px #0000001a;cursor:pointer}.chatbox[_ngcontent-%COMP%]{position:absolute;bottom:30px;right:30px}.chatbox__support[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#eee;z-index:-123456;opacity:0;position:relative;transition:all .5s ease-in-out;height:10px;width:10px}.chatbox__support[_ngcontent-%COMP%]{background:#f9f9f9;box-shadow:0 0 15px #0000001a;border-top-left-radius:20px;border-top-right-radius:20px}.chatbox--active[_ngcontent-%COMP%]{transform:translateY(-40px);z-index:123456;opacity:1;height:450px;width:350px}.chatbox--inactive[_ngcontent-%COMP%]{z-index:-123456}.chatbox__button[_ngcontent-%COMP%]{text-align:right}.chatbox__header[_ngcontent-%COMP%]{position:sticky;top:0;background:linear-gradient(93.12deg,#581b98 .52%,#9c1de7)}.chatbox__messages[_ngcontent-%COMP%]{margin-top:auto;display:flex;flex-direction:column;overflow-y:scroll;flex-direction:column-reverse}.messages__item[_ngcontent-%COMP%]{background:linear-gradient(93.12deg,#581b98 .52%,#9c1de7);max-width:80.6%;width:fit-content;height:fit-content;display:table}.messages__item--operator[_ngcontent-%COMP%]{margin-left:auto;color:#fff}.messages__item--visitor[_ngcontent-%COMP%]{margin-right:auto;background:linear-gradient(93.12deg,#d9bbf8 .52%,#c997e6)}.chatbox__footer[_ngcontent-%COMP%]{position:sticky;bottom:0}.messages__item--typing[_ngcontent-%COMP%]{will-change:transform;width:auto;border-top-right-radius:20px;border-top-left-radius:20px;border-bottom-right-radius:20px;padding:15px 20px;display:table;margin-right:auto;position:relative;animation:2s _ngcontent-%COMP%_bulge infinite ease-out}.messages__item--typing[_ngcontent-%COMP%]:before, .messages__item--typing[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-2px;left:-2px;height:10px;width:10px;border-radius:50%}.messages__item--typing[_ngcontent-%COMP%]:after{height:10px;width:10px;left:-10px;bottom:-10px}span.messages__dot[_ngcontent-%COMP%]{height:8px;width:8px;float:left;margin:0 1px;background-color:#9e9ea1;display:block;border-radius:50%;opacity:.4;animation:1s _ngcontent-%COMP%_blink infinite}@keyframes _ngcontent-%COMP%_blink{50%{opacity:1}}@keyframes _ngcontent-%COMP%_bulge{50%{transform:scale(1.05)}}.message[_ngcontent-%COMP%]{padding:10px!important;border-radius:10px!important;margin-bottom:4px!important;white-space:pre-wrap}.time[_ngcontent-%COMP%]{color:#fff;float:right;font-size:small}.my-message[_ngcontent-%COMP%]{background:var(--ion-color-tertiary);color:#fff}.other-message[_ngcontent-%COMP%]{background:var(--ion-color-secondary);color:#fff}']})};function VV(n,e){n&1&&we(0,"app-chat")}var Nc=class n{constructor(e){this.authSvc=e}user$;ngOnInit(){this.user$=this.authSvc.user$}static \u0275fac=function(t){return new(t||n)(Z(an))};static \u0275cmp=He({type:n,selectors:[["app-home"]],decls:14,vars:3,consts:[[1,"body"],[1,"background-one"],[1,"link-container"],["routerLink","/listados",1,"link-one"],[1,"background-two","link-container"],["routerLink","/juegos",1,"link-two"],[1,"background-three","link-container"],["routerLink","/encuesta",1,"link-three"],[1,"chat"],[4,"ngIfUser","ngIf"]],template:function(t,r){t&1&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),G(4,"Listado Resultados"),U()()(),O(5,"div",4)(6,"a",5),G(7,"Juegos"),U()(),O(8,"div",6)(9,"a",7),G(10,"Encuesta"),U()(),O(11,"div",8),ot(12,VV,1,0,"app-chat",9),fi(13,"async"),U()()),t&2&&(se(12),ke("ngIf",Es(13,1,r.user$)))},dependencies:[Nf,It,Sn,Ts,Pr],styles:['.body[_ngcontent-%COMP%]{margin:0;height:100vh;display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:1fr}.background-one[_ngcontent-%COMP%], .background-two[_ngcontent-%COMP%], .background-three[_ngcontent-%COMP%]{background-color:#1f293a}.link-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;position:relative;z-index:0}a[_ngcontent-%COMP%]{font-family:Bungee,cursive;font-size:2.5em}.link-one[_ngcontent-%COMP%]{color:#53d9d1;transition:color 1s cubic-bezier(.32,0,.67,0);line-height:1em}.link-one[_ngcontent-%COMP%]:hover{color:#1f293a;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-one[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-1;width:100%;height:100%;top:0;right:0;background-color:#53d9d1;clip-path:circle(0% at 50% 50%);transition:clip-path 1s cubic-bezier(.65,0,.35,1)}.link-one[_ngcontent-%COMP%]:hover:before{clip-path:circle(100% at 50% 50%)}.link-one[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:100%;height:100%;top:0;right:0;background-color:#1f293a;clip-path:polygon(40% 0%,60% 0%,60% 0%,40% 0%,40% 100%,60% 100%,60% 100%,40% 100%);transition:clip-path 1s cubic-bezier(.65,0,.35,1)}.link-one[_ngcontent-%COMP%]:hover:after{clip-path:polygon(40% 10%,60% 10%,60% 35%,40% 35%,40% 90%,60% 90%,60% 65%,40% 65%)}.link-two[_ngcontent-%COMP%]{color:#f27b9b;transition:color 1s cubic-bezier(.32,0,.67,0)}.link-two[_ngcontent-%COMP%]:hover{color:#1f293a;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-two[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-2;width:100%;height:100%;top:0;right:0;clip-path:polygon(0% -20%,100% -30%,100% -10%,0% 0%,0% 130%,100% 120%,100% 100%,0% 110%);background-color:#f27b9b;transition:clip-path 1s cubic-bezier(.25,1,.5,1)}.link-two[_ngcontent-%COMP%]:hover:before{clip-path:polygon(0% 10%,100% 0%,100% 20%,0% 30%,0% 100%,100% 90%,100% 70%,0% 80%)}.link-two[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:5ch;height:5ch;top:50%;right:50%;transform:translate(50%,-50%) rotate(0) scale(0);transition:transform 1s ease;background-color:#f27b9b}.link-two[_ngcontent-%COMP%]:hover:after{transform:translate(50%,-50%) rotate(135deg) scale(1)}.link-three[_ngcontent-%COMP%]{color:#eb7132;transition:color 1s cubic-bezier(.32,0,.67,0)}.link-three[_ngcontent-%COMP%]:hover{color:#f8f7b2;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-three[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:50.1%;height:100%;top:0%;left:0%;transform:translateY(-50%) scaleY(0);transition:transform 1s ease;mix-blend-mode:difference;clip-path:polygon(20% 60%,100% 60%,100% 40%,20% 40%,20% 0%,60% 0%,60% 20%,20% 20%);background-color:#eb7132}.link-three[_ngcontent-%COMP%]:hover:after{transform:translate(0) scaleY(1)}.link-three[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-1;width:50%;height:100%;bottom:0%;right:0%;transform:translateY(50%) scaleY(0);transition:transform 1s ease;mix-blend-mode:difference;clip-path:polygon(80% 40%,0% 40%,0% 60%,80% 60%,80% 100%,40% 100%,40% 80%,80% 80%);background-color:#eb7132}.link-three[_ngcontent-%COMP%]:hover:before{transform:translate(0) scaleY(1)}']})};var oa=class n{x;y;constructor(e,t){this.x=e,this.y=t}getTopBox(){return this.y===0?null:new n(this.x,this.y-1)}getRightBox(){return this.x===2?null:new n(this.x+1,this.y)}getBottomBox(){return this.y===2?null:new n(this.x,this.y+1)}getLeftBox(){return this.x===0?null:new n(this.x-1,this.y)}getNextdoorBoxes(){return[this.getTopBox(),this.getRightBox(),this.getBottomBox(),this.getLeftBox()].filter(e=>e!==null)}getRandomNextdoorBox(){let e=this.getNextdoorBoxes();return e[Math.floor(Math.random()*e.length)]}};var ds=class n{static swapBoxes(e,t,r){let i=e[t.y][t.x];return e[t.y][t.x]=e[r.y][r.x],e[r.y][r.x]=i,e}static isSolved(e){return e[0][0]===1&&e[0][1]===2&&e[0][2]===3&&e[1][0]===4&&e[1][1]===5&&e[1][2]===6&&e[2][0]===7&&e[2][1]===8&&e[2][2]===0}static getRandomGrid(){let e=[[1,2,3],[4,5,6],[7,8,0]],t=new oa(2,2);for(let r=0;r<1e3;r++){let i=t.getRandomNextdoorBox();n.swapBoxes(e,t,i),t=i}return n.isSolved(e)?this.getRandomGrid():e}};var Fc=class n{grid;move=0;time=0;status="";constructor(e,t,r,i){this.grid=e,this.move=t,this.time=r,this.status=i}static ready(){return new n([[0,0,0],[0,0,0],[0,0,0]],0,0,"listo")}static start(){return new n(ds.getRandomGrid(),0,0,"jugando")}};function UV(n,e){if(n&1&&we(0,"img",13),n&2){let t=br().index,r=br();xC("src","assets/imagenes/gatito/",r.contenido[t],".jpg",su)}}function LV(n,e){if(n&1){let t=au();O(0,"button",3),Me("click",function(){let i=nu(t).index,s=br();return ru(s.handleClickBox(i))}),ot(1,UV,1,2,"img",12),U()}if(n&2){let t=e.index,r=br();se(),ke("ngIf",r.contenido[t]!="")}}var Ff=class n{resultado;estado;tickId;boton="";contenido=new Array(9);mensaje="";victoria="";grupoCajas;start;contador;constructor(){this.nuevoJuego(Fc.ready()),this.grupoCajas=[],this.contenido=[9,1,2,3,4,5,6,7,8],this.boton="Jugar",this.start="visible"}ngOnInit(){}nuevoJuego(e){this.estado=e,this.tickId=null,this.tick=this.tick.bind(this)}tick(){this.estado.time=this.estado.time+1}setState(e){this.estado=e,this.render()}handleClickBox(e){let t=this.grupoCajas[e],i=t.getNextdoorBoxes().find(s=>this.estado.grid[s.y][s.x]===0);if(i){let s=ds.swapBoxes(this.estado.grid,t,i);ds.isSolved(s)?(clearInterval(this.tickId),this.setState({grid:s,move:this.estado.move+1,time:this.estado.time,status:"gano"})):this.setState({grid:s,move:this.estado.move+1,time:this.estado.time,status:this.estado.status})}}render(){this.contador=0;for(let e=0;e<3;e++)for(let t=0;t<3;t++){if(this.estado.status==="jugando"){let r=new oa(t,e);this.grupoCajas.push(r),this.boton="Reiniciar"}this.contenido[this.contador]=this.estado.grid[e][t]===0?"":this.estado.grid[e][t].toString(),this.contador++}this.estado.status==="listo"&&(this.boton="Jugar",this.start="visible"),this.estado.status==="jugando"&&(this.boton="Reiniciar"),this.estado.status==="gano"&&(this.boton="Jugar",this.victoria="visible",this.resultado={tiempo:this.estado.time.toString()+" seg",resultado:"Gano",errores:"N/A",clicks:this.estado.move.toString(),correctas:"N/A",juego:"Rompecabezas"})}clickBoton(){clearInterval(this.tickId),this.tickId=setInterval(this.tick,1e3),this.setState(Fc.start()),this.start="",this.victoria="",this.render()}ordenar(){let e=[[1,2,3],[4,5,0],[7,8,6]];this.setState({grid:e,move:this.estado.move+1,time:this.estado.time,status:this.estado.status})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=He({type:n,selectors:[["app-mijuego"]],decls:23,vars:10,consts:[[1,"juegoContainer"],[1,"juego"],[1,"game"],[3,"click"],["id","victory-text",3,"click"],[1,"overlay-text-small"],[1,"grid"],[3,"click",4,"ngFor","ngForOf"],[1,"footer"],["id","move"],[1,"ordenar",3,"click"],["id","time"],["width","106px",3,"src",4,"ngIf"],["width","106px",3,"src"]],template:function(t,r){t&1&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Me("click",function(){return r.clickBoton()}),G(4," Click para empezar "),U(),O(5,"div",4),Me("click",function(){return r.clickBoton()}),O(6,"span",5),G(7,"Ganaste!!!"),U(),O(8,"span",5),we(9,"br"),G(10,"Click para jugar de nuevo"),U()(),O(11,"div",6),ot(12,LV,2,1,"button",7),U(),O(13,"div",8)(14,"button",3),Me("click",function(){return r.clickBoton()}),G(15),U(),O(16,"span",9),G(17),U()(),O(18,"div",8)(19,"button",10),Me("click",function(){return r.ordenar()}),G(20,"Ordenar para ganar"),U(),O(21,"span",11),G(22),U()()()()()),t&2&&(se(3),xa("overlay-text ",r.start,""),se(2),xa("overlay-text ",r.victoria,""),se(7),ke("ngForOf",r.contenido),se(3),dn(r.boton),se(2),Ma("Movimiento: ",r.estado.move,""),se(5),Ma("Tiempo: ",r.estado.time,""))},dependencies:[It,fu,Sn],styles:[".juegoContainer[_ngcontent-%COMP%]{margin:0;width:100vw;height:100vh}.juego[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}.game[_ngcontent-%COMP%]{box-shadow:0 1px 4px #00000080;padding:20px;background-image:linear-gradient(#d6e7b3,#a1e7e7);border-radius:5px}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:106px 106px 106px;grid-template-rows:106px 106px 106px;border:1px solid #550000}.grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{box-shadow:#ccdbe8 3px 3px 6px inset,#ffffff80 -3px -3px 6px 1px inset;background-color:#f5f4c0;color:#033;font-size:24px;font-weight:700;border:1px solid #550000;outline:none;cursor:pointer}.footer[_ngcontent-%COMP%]{margin-top:15px;display:flex;justify-content:space-between}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;font-size:20px;font-weight:700;border-radius:5px;box-shadow:0 1px 4px #00000080;padding:5px;width:100px;background-color:#d4ee9f;color:#033;outline:none;cursor:pointer}.ordenar[_ngcontent-%COMP%]{border:none;font-size:20px;font-weight:700;border-radius:5px;box-shadow:0 1px 4px #00000080;padding:5px;width:150px;background-color:#d4ee9f;color:#033;outline:none;cursor:pointer;margin-top:15px}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .ordenar[_ngcontent-%COMP%]:hover{color:#d4ee9f;background-color:#033}.footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:20px;color:#14a890;font-weight:700;margin:auto 0}.message[_ngcontent-%COMP%]{color:#aa3939;height:80px}.overlay-text[_ngcontent-%COMP%]{inset:0;z-index:100;display:none;position:fixed;justify-content:center;align-items:center;flex-direction:column;color:#fdbf8c;font-family:Creepy,serif;font-size:4em;transition:background-color .5s,font-size .5s}.overlay-text.visible[_ngcontent-%COMP%]{display:flex;animation:_ngcontent-%COMP%_overlay-grow .5s forwards}@keyframes _ngcontent-%COMP%_overlay-grow{0%{background-color:#0000;font-size:0}to{background-color:#000c;font-size:6em}}"]})};var Of=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=He({type:n,selectors:[["app-juegos"]],decls:14,vars:0,consts:[[1,"body"],[1,"background-one"],[1,"link-container"],["routerLink","/preguntados",1,"link-one"],[1,"background-two","link-container"],["routerLink","/ahorcado",1,"link-two"],[1,"background-three","link-container"],["routerLink","/mayormenor",1,"link-three"],[1,"background-fourth","link-container"],["routerLink","/mijuego",1,"link-fourth"]],template:function(t,r){t&1&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),G(4,"Preguntados"),U()()(),O(5,"div",4)(6,"a",5),G(7,"Ahorcado"),U()(),O(8,"div",6)(9,"a",7),G(10,"Mayor o menor"),U()(),O(11,"div",8)(12,"a",9),G(13,"Rompecabeza"),U()()())},dependencies:[It,Pr],styles:['.body[_ngcontent-%COMP%]{margin:0;height:100vh;display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:1fr}.background-one[_ngcontent-%COMP%], .background-two[_ngcontent-%COMP%], .background-three[_ngcontent-%COMP%], .background-fourth[_ngcontent-%COMP%]{background-color:#1f293a}.link-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;position:relative;z-index:0}a[_ngcontent-%COMP%]{font-family:Bungee,cursive;font-size:2.5em}.link-one[_ngcontent-%COMP%]{color:#53d9d1;transition:color 1s cubic-bezier(.32,0,.67,0);line-height:1em}.link-one[_ngcontent-%COMP%]:hover{color:#1f293a;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-one[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-1;width:100%;height:100%;top:0;right:0;background-color:#53d9d1;clip-path:circle(0% at 50% 50%);transition:clip-path 1s cubic-bezier(.65,0,.35,1)}.link-one[_ngcontent-%COMP%]:hover:before{clip-path:circle(100% at 50% 50%)}.link-one[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:100%;height:100%;top:0;right:0;background-color:#1f293a;clip-path:polygon(40% 0%,60% 0%,60% 0%,40% 0%,40% 100%,60% 100%,60% 100%,40% 100%);transition:clip-path 1s cubic-bezier(.65,0,.35,1)}.link-one[_ngcontent-%COMP%]:hover:after{clip-path:polygon(40% 10%,60% 10%,60% 35%,40% 35%,40% 90%,60% 90%,60% 65%,40% 65%)}.link-two[_ngcontent-%COMP%]{color:#f27b9b;transition:color 1s cubic-bezier(.32,0,.67,0)}.link-two[_ngcontent-%COMP%]:hover{color:#1f293a;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-two[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-2;width:100%;height:100%;top:0;right:0;clip-path:polygon(0% -20%,100% -30%,100% -10%,0% 0%,0% 130%,100% 120%,100% 100%,0% 110%);background-color:#f27b9b;transition:clip-path 1s cubic-bezier(.25,1,.5,1)}.link-two[_ngcontent-%COMP%]:hover:before{clip-path:polygon(0% 10%,100% 0%,100% 20%,0% 30%,0% 100%,100% 90%,100% 70%,0% 80%)}.link-two[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:5ch;height:5ch;top:50%;right:50%;transform:translate(50%,-50%) rotate(0) scale(0);transition:transform 1s ease;background-color:#f27b9b}.link-two[_ngcontent-%COMP%]:hover:after{transform:translate(50%,-50%) rotate(135deg) scale(1)}.link-three[_ngcontent-%COMP%]{color:#eb7132}.link-three[_ngcontent-%COMP%]:hover{color:#1f293a;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-three[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:50%;height:100%;top:0%;left:0%;transform:translateY(-50%) scaleY(0);transition:transform 1s ease;mix-blend-mode:difference;clip-path:polygon(20% 60%,100% 60%,100% 40%,20% 40%,20% 0%,60% 0%,60% 20%,20% 20%);background-color:#eb7132}.link-three[_ngcontent-%COMP%]:hover:after{transform:translate(0) scaleY(1)}.link-three[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-1;width:50%;height:100%;bottom:0%;right:0%;transform:translateY(50%) scaleY(0);transition:transform 1s ease;mix-blend-mode:difference;clip-path:polygon(80% 40%,0% 40%,0% 60%,80% 60%,80% 100%,40% 100%,40% 80%,80% 80%);background-color:#eb7132}.link-three[_ngcontent-%COMP%]:hover:before{transform:translate(0) scaleY(1)}.link-fourth[_ngcontent-%COMP%]{color:#7e56ed;transition:color 1s cubic-bezier(.32,0,.67,0);line-height:1em}.link-fourth[_ngcontent-%COMP%]:hover{color:#1f293a;transition:color 1s cubic-bezier(.33,1,.68,1)}.link-fourth[_ngcontent-%COMP%]:before{content:"";position:absolute;z-index:-1;width:100%;height:100%;top:0;right:0;background-color:#7e56ed;clip-path:circle(0% at 50% 50%);transition:clip-path 1s cubic-bezier(.65,0,.35,1)}.link-fourth[_ngcontent-%COMP%]:hover:before{clip-path:circle(100% at 50% 50%)}.link-fourth[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:-1;width:100%;height:100%;top:0;right:0;background-color:#1f293a;clip-path:polygon(50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%,50% 50%);transition:clip-path 1s cubic-bezier(.65,0,.35,1)}.link-fourth[_ngcontent-%COMP%]:hover:after{clip-path:polygon(20% 45%,10% 40%,30% 30%,40% 35%,60% 35%,70% 30%,90% 40%,80% 45%,60% 35%,40% 35%,20% 45%,20% 55%,10% 60%,30% 70%,40% 65%,60% 65%,70% 70%,90% 60%,80% 55%,60% 65%,40% 65%,20% 55%)}']})};function q1(n,e){return t=>{let r=t.controls[n],i=t.controls[e];i.errors&&!i.errors.confirmedValidator||(r.value!==i.value?i.setErrors({confirmedValidator:!0}):i.setErrors(null))}}function BV(n,e){n&1&&(O(0,"p",15),G(1," El email es requerido "),U())}function jV(n,e){n&1&&(O(0,"p",15),G(1," No cumple el formato de email. "),U())}function qV(n,e){n&1&&(O(0,"p",15),G(1," La contrase\xF1a es requerida. "),U())}function $V(n,e){n&1&&(O(0,"p",15),G(1," La contrase\xF1a tiene que tener minimo 6 caracteres "),U())}function zV(n,e){n&1&&(O(0,"p",15),G(1," Repetir la contrase\xF1a es requerido. "),U())}function GV(n,e){n&1&&(O(0,"p",15),G(1," La contrase\xF1a tiene que tener minimo 6 caracteres "),U())}function WV(n,e){n&1&&(O(0,"p",16),G(1," La contrase\xF1a y la confirmacion de la contrase\xF1a deben ser iguales "),U())}var Vf=class n{constructor(e,t,r){this.authSvc=e;this.router=t;this.fb=r}message="";registerForm;ngOnInit(){this.registerForm=this.fb.group({email:new _r("",[Mt.required,Mt.email]),password:new _r("",[Mt.required,Mt.minLength(6)]),passwordR:new _r("",[Mt.required,Mt.minLength(6)])},{validator:q1("password","passwordR")})}onRegister(){return R(this,null,function*(){let{email:e,password:t}=this.registerForm.value;console.log("onregister");try{let r=this.authSvc.registro(e,t);console.log("rty"),(yield r)&&(console.log("registrado"),this.router.navigate(["/home"]))}catch(r){console.log(r),this.message=r.message}})}static \u0275fac=function(t){return new(t||n)(Z(an),Z(Tt),Z(kf))};static \u0275cmp=He({type:n,selectors:[["app-registro"]],decls:32,vars:9,consts:[[1,"body"],[1,"container"],[1,"login-box"],[3,"ngSubmit","formGroup"],[1,"input-box"],["type","email","formControlName","email","required",""],["for","email"],["class","error ion-padding",4,"ngIf"],["type","password","formControlName","password","required",""],["type","password","formControlName","passwordR","ngModel","","minlength","6"],["for","passwordR"],["class","error",4,"ngIf"],["type","submit",1,"btn"],[1,"signup-link"],["routerLink","/login"],[1,"error","ion-padding"],[1,"error"]],template:function(t,r){if(t&1&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),G(4,"Registro"),U(),O(5,"form",3),Me("ngSubmit",function(){return r.onRegister()}),O(6,"p"),G(7),U(),O(8,"div",4),we(9,"input",5),O(10,"label",6),G(11,"Email"),U(),ot(12,BV,2,0,"p",7)(13,jV,2,0,"p",7),U(),O(14,"div",4),we(15,"input",8),O(16,"label"),G(17,"Contrase\xF1a"),U(),ot(18,qV,2,0,"p",7)(19,$V,2,0,"p",7),U(),O(20,"div",4),we(21,"input",9),O(22,"label",10),G(23,"Repetir Contrase\xF1a"),U(),ot(24,zV,2,0,"p",7)(25,GV,2,0,"p",7)(26,WV,2,0,"p",11),U(),O(27,"button",12),G(28,"Registrar"),U(),O(29,"div",13)(30,"a",14),G(31," \xBFYa tienes una cuenta?"),U()()()()()()),t&2){let i,s,o,a,c,u,d;se(5),ke("formGroup",r.registerForm),se(2),dn(r.message),se(5),ke("ngIf",((i=r.registerForm.get("email").errors)==null?null:i.required)&&r.registerForm.get("email").touched),se(),ke("ngIf",(s=r.registerForm.get("email").errors)==null?null:s.email),se(5),ke("ngIf",((o=r.registerForm.get("password").errors)==null?null:o.required)&&r.registerForm.get("password").touched),se(),ke("ngIf",((a=r.registerForm.get("password").errors)==null?null:a.minlength)&&r.registerForm.get("password").touched),se(5),ke("ngIf",((c=r.registerForm.get("passwordR").errors)==null?null:c.required)&&r.registerForm.get("passwordR").touched),se(),ke("ngIf",((u=r.registerForm.get("passwordR").errors)==null?null:u.minlength)&&r.registerForm.get("passwordR").touched),se(),ke("ngIf",(d=r.registerForm.get("passwordR").errors)==null?null:d.confirmedValidator)}},dependencies:[Mf,Df,ii,ia,Af,Mc,ew,xc,kc,It,Sn,sa],styles:['@font-face{font-family:Poppins;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDz8Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDz8Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDz8Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiEyp8kv8JHgFVrJJbecmNE.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiEyp8kv8JHgFVrJJnecmNE.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiEyp8kv8JHgFVrJJfecg.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLGT9Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLGT9Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLGT9Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLEj6Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLEj6Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLEj6Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLCz7Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLCz7Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLCz7Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDD4Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDD4Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDD4Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLBT5Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLBT5Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLBT5Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}.body[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:#1f293a}.container[_ngcontent-%COMP%]{position:relative;width:256px;height:256px;display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:0;width:32px;height:6px;background:#2c4766;border-radius:8px;transform-origin:128px;transform:scale(2.2) rotate(calc(var(--i) * (360deg / 50)));animation:_ngcontent-%COMP%_animateBlink 3s linear infinite;animation-delay:calc(var(--i) * (3s / 50))}@keyframes _ngcontent-%COMP%_animateBlink{0%{background:#0ef}25%{background:#2c4766}}.login-box[_ngcontent-%COMP%]{position:absolute;width:400px}.login-box[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;padding:0 50px}h2[_ngcontent-%COMP%]{font-size:2em;color:#0ef;text-align:center}p[_ngcontent-%COMP%]{color:#0ef;text-align:center}.error[_ngcontent-%COMP%]{color:red;text-align:center}.input-box[_ngcontent-%COMP%]{position:relative;margin:25px 0}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:50px;background:transparent;border:2px solid #2c4766;outline:none;border-radius:40px;font-size:1em;color:#fff;padding:0 20px;transition:.5s ease}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid{border-color:#0ef}.input-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:50%;left:20px;transform:translateY(-50%);font-size:1em;color:#fff;pointer-events:none;transition:.5s ease}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid ~ label[_ngcontent-%COMP%]{top:1px;font-size:.8em;background:#1f293a;padding:0 6px;color:#0ef}.forgot-pass[_ngcontent-%COMP%]{margin:-15px 0 10px;text-align:center}.forgot-pass[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.85em;color:#fff;text-decoration:none}.forgot-pass[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn[_ngcontent-%COMP%]{width:100%;height:45px;background:#0ef;border:none;outline:none;border-radius:40px;cursor:pointer;font-size:1em;color:#1f293a;font-weight:600}.signup-link[_ngcontent-%COMP%]{margin:20px 0 10px;text-align:center}.signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:1em;color:#0ef;text-decoration:none;font-weight:600}.signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};var Uf=class n{constructor(e){this.http=e}getGitHubInfo(){return this.http.get("https://api.github.com/users/vaninaquezada")}static \u0275fac=function(t){return new(t||n)(z(KC))};static \u0275prov=le({token:n,factory:n.\u0275fac,providedIn:"root"})};var Lf=class n{constructor(e){this.gitSvc=e;this.datos={name:"",avatar_url:"",login:""}}datos;ngOnInit(){this.gitSvc.getGitHubInfo().subscribe(e=>{setTimeout(()=>{this.datos=e,console.log(this.datos)},1e3)})}static \u0275fac=function(t){return new(t||n)(Z(Uf))};static \u0275cmp=He({type:n,selectors:[["app-quiensoy"]],decls:13,vars:1,consts:[[1,"row"],["id","quiwn",1,"col-md-6","text-center"],[1,"margin"],["href","https://github.com/Vaninaquezada/tp1salajuegos","target","_blank"],[1,"fa","fa-github"],["alt","Bird","width","350","height","350",1,"img-responsive","img-circle","margin",2,"display","inline",3,"src"],["id","que",1,"col-md-6","text-center"]],template:function(t,r){t&1&&(O(0,"div",0)(1,"div",1)(2,"h3",2),G(3,"\xBFQui\xE9n Soy?"),U(),O(4,"a",3),G(5,"en GitHub "),we(6,"i",4),U(),O(7,"p"),G(8,"Vanina Quezada"),U(),we(9,"img",5),O(10,"h3"),G(11," Soy Un alumno de la UTN FRA, Vanina Quezada. Me encantan los gatos y hacer piezas deformes de ceramica en mi tiempo libre. "),U()(),we(12,"div",6),U()),t&2&&(se(9),ka("src",r.datos.avatar_url,su))},styles:[".imagenDeQuienSoy[_ngcontent-%COMP%]{width:400px;height:250px}body[_ngcontent-%COMP%]{font:20px Montserrat,sans-serif;line-height:1.8;color:#5a8eff}.img-circle[_ngcontent-%COMP%]{border-radius:50%;border-width:20px;border-style:double;border-color:#f8f7b2}p[_ngcontent-%COMP%]{font-size:16px}.margin[_ngcontent-%COMP%]{margin-bottom:45px}.bg-1[_ngcontent-%COMP%]{background-color:#1abc9c;color:#5a8eff}.bg-2[_ngcontent-%COMP%]{background-color:#474e5d;color:#5a8eff}.bg-3[_ngcontent-%COMP%]{background-color:#5a8eff;color:#555}.bg-4[_ngcontent-%COMP%]{background-color:#3a0447;color:#5a8eff;height:20%}.container-fluid[_ngcontent-%COMP%]{padding-top:70px;padding-bottom:70px}.navbar[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;border:0;border-radius:0;margin-bottom:0;font-size:12px;letter-spacing:5px}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1abc9c!important}nav[_ngcontent-%COMP%]{display:flex;background-color:#0e3aff;color:#5a8eff}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px}.active[_ngcontent-%COMP%]{background-color:#f3f3f3;border:solid;border-radius:25px;border-color:#328afd;color:#5a8eff}a[_ngcontent-%COMP%]{color:#5a8eff}.row[_ngcontent-%COMP%]{background-color:#1f293a;padding:30px;color:#5a8eff}#que[_ngcontent-%COMP%]{margin-top:60px;border-width:20px;border-style:double;border-color:#f8f7b2}.juego[_ngcontent-%COMP%]{height:250px}.flecha[_ngcontent-%COMP%]{height:80px;margin:15px}"]})};function KV(n,e){n&1&&(O(0,"p",18),G(1," El email es requerido "),U())}function QV(n,e){n&1&&(O(0,"p",18),G(1," No cumple el formato de email. "),U())}function YV(n,e){n&1&&(O(0,"p",18),G(1," La contrase\xF1a es requerida. "),U())}var Bf=class n{constructor(e,t,r){this.fb=e;this.authService=t;this.router=r}loginForm;message="";seleccion="";usuario="";clave="";get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}ngOnInit(){this.loginForm=this.fb.group({email:["",[Mt.required,Mt.email]],password:["",[Mt.required,Mt.minLength(6)]]})}onLogin(){return R(this,null,function*(){let{email:e,password:t}=this.loginForm.value;try{let r=yield this.authService.login(e,t);r&&(this.message="Bienvenido "+e,console.log("pagina 2"+JSON.stringify(r)),setTimeout(()=>{this.router.navigate(["/home"])},1e3))}catch(r){console.log("pagina error "+r),console.log("error.message "+r.message),this.message=r.message}})}onChange(e){switch(console.log(e),this.message="",e){case"admin":this.loginForm.setValue({email:"admin@admin.com",password:"111111"}),console.log(this.loginForm.value);break;case"usuario":this.loginForm.setValue({email:"usuario@usuario.com",password:"123456"}),console.log(this.loginForm.value);break;case"fulanito":this.loginForm.setValue({email:"mail@hola.com",password:"clave123"});break}}static \u0275fac=function(t){return new(t||n)(Z(kf),Z(an),Z(Tt))};static \u0275cmp=He({type:n,selectors:[["app-login"]],decls:34,vars:8,consts:[[1,"body"],[1,"container"],[1,"login-box"],[3,"ngSubmit","formGroup"],[1,"input-box"],["type","email","formControlName","email","required","",3,"value"],["for","email"],["class","error",4,"ngIf"],["type","password","formControlName","password","required","",3,"value"],["type","submit",1,"btn"],[1,"signup-link"],["routerLink","/registro"],[1,"forgot-pass"],["for","usuarios"],["value","seleccione","name","usuarios",1,"form-control",3,"ngModelChange","change","ngModel"],["value","admin"],["value","usuario"],["value","fulanito"],[1,"error"]],template:function(t,r){if(t&1&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),G(4,"Login"),U(),O(5,"form",3),Me("ngSubmit",function(){return r.onLogin()}),O(6,"p"),G(7),U(),O(8,"div",4),we(9,"input",5),O(10,"label",6),G(11,"Email"),U(),ot(12,KV,2,0,"p",7)(13,QV,2,0,"p",7),U(),O(14,"div",4),we(15,"input",8),O(16,"label"),G(17,"Contrase\xF1a"),U(),ot(18,YV,2,0,"p",7),U(),O(19,"button",9),G(20,"Ingresar"),U(),O(21,"div",10)(22,"a",11),G(23,"Registro de usuario"),U()()(),O(24,"div",12)(25,"label",13),G(26,"Seleccione usuario "),U(),O(27,"select",14),uu("ngModelChange",function(s){return cu(r.seleccion,s)||(r.seleccion=s),s}),Me("change",function(){return r.onChange(r.seleccion)}),O(28,"option",15),G(29,"admin"),U(),O(30,"option",16),G(31,"usuario"),U(),O(32,"option",17),G(33,"Fulanito"),U()()()()()()),t&2){let i,s,o;se(5),ke("formGroup",r.loginForm),se(2),dn(r.message),se(2),ka("value",r.usuario),se(3),ke("ngIf",((i=r.loginForm.get("email").errors)==null?null:i.required)&&r.loginForm.get("email").touched),se(),ke("ngIf",(s=r.loginForm.get("email").errors)==null?null:s.email),se(2),ka("value",r.clave),se(3),ke("ngIf",((o=r.loginForm.get("password").errors)==null?null:o.required)&&r.loginForm.get("password").touched),se(9),lu("ngModel",r.seleccion)}},dependencies:[Mf,Df,V1,L1,ii,xf,ia,Af,Mc,xc,kc,It,Sn,sa,Dc],styles:['@font-face{font-family:Poppins;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDz8Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDz8Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDz8Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiEyp8kv8JHgFVrJJbecmNE.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiEyp8kv8JHgFVrJJnecmNE.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiEyp8kv8JHgFVrJJfecg.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLGT9Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLGT9Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLGT9Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLEj6Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLEj6Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLEj6Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLCz7Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLCz7Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLCz7Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDD4Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDD4Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:800;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLDD4Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLBT5Z11lFc-K.woff2) format("woff2");unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09}@font-face{font-family:Poppins;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLBT5Z1JlFc-K.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v24/pxiByp8kv8JHgFVrLBT5Z1xlFQ.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}.error[_ngcontent-%COMP%]{color:red;text-align:center}.body[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:#1f293a}.container[_ngcontent-%COMP%]{position:relative;width:256px;height:256px;display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:0;width:32px;height:6px;background:#2c4766;border-radius:8px;transform-origin:128px;transform:scale(2.2) rotate(calc(var(--i) * (360deg / 50)));animation:_ngcontent-%COMP%_animateBlink 3s linear infinite;animation-delay:calc(var(--i) * (3s / 50))}@keyframes _ngcontent-%COMP%_animateBlink{0%{background:#0ef}25%{background:#2c4766}}.login-box[_ngcontent-%COMP%]{position:absolute;width:400px}.login-box[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;padding:0 50px}h2[_ngcontent-%COMP%]{font-size:2em;color:#0ef;text-align:center}p[_ngcontent-%COMP%]{color:#0ef;text-align:center}.input-box[_ngcontent-%COMP%]{position:relative;margin:25px 0}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:50px;background:transparent;border:2px solid #2c4766;outline:none;border-radius:40px;font-size:1em;color:#fff;padding:0 20px;transition:.5s ease}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid{border-color:#0ef}.input-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:50%;left:20px;transform:translateY(-50%);font-size:1em;color:#fff;pointer-events:none;transition:.5s ease}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid ~ label[_ngcontent-%COMP%]{top:1px;font-size:.8em;background:#1f293a;padding:0 6px;color:#0ef}.forgot-pass[_ngcontent-%COMP%]{margin:-15px 0 10px;text-align:center}.forgot-pass[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.85em;color:#fff;text-decoration:none}.forgot-pass[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn[_ngcontent-%COMP%]{width:100%;height:45px;background:#0ef;border:none;outline:none;border-radius:40px;cursor:pointer;font-size:1em;color:#1f293a;font-weight:600}.signup-link[_ngcontent-%COMP%]{margin:20px 0 10px;text-align:center}.signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:1em;color:#0ef;text-decoration:none;font-weight:600}.signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};var $1=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"login",component:Bf},{path:"home",component:Nc},{path:"quiensoy",component:Lf},{path:"registro",component:Vf},{path:"juegos",component:Of},{path:"preguntados",loadComponent:()=>import("./chunk-4WKT766U.js").then(n=>n.PreguntadosComponent)},{path:"ahorcado",loadComponent:()=>import("./chunk-KUA3YUOF.js").then(n=>n.AhorcadoComponent)},{path:"mayormenor",loadComponent:()=>import("./chunk-FTPDPLQG.js").then(n=>n.MayoromenorComponent)},{path:"mijuego",component:Ff},{path:"**",component:Nc}];var z1={apiKey:"AIzaSyDaDxkZHkwvJy0N7o_DVcmMXIx_6vPSZ7I",authDomain:"tplab4-45942.firebaseapp.com",databaseURL:"https://tplab4-45942.firebaseio.com",projectId:"tplab4-45942",storageBucket:"tplab4-45942.appspot.com",messagingSenderId:"544089026720",appId:"1:544089026720:web:12140e7d4d8c437ea759c5"},G1={providers:[UC({eventCoalescing:!0}),wg($1),QC(),gC(dT.initializeApp(z1)),Jb(()=>Xb(z1)),n1(()=>i1()),YR(()=>XR())]};function JV(n,e){if(n&1){let t=au();O(0,"nav")(1,"a",3),G(2,"Home"),U(),O(3,"a",4),G(4,"Juegos"),U(),O(5,"a",5),G(6,"Quien Soy"),U(),O(7,"a",6),Me("click",function(){nu(t);let i=br();return ru(i.logOut())}),G(8,"Logout"),U(),O(9,"a"),G(10),U(),we(11,"div",7),U()}if(n&2){let t=br();se(10),dn(t.usuario.email)}}function XV(n,e){n&1&&(O(0,"nav")(1,"a",3),G(2,"Home"),U(),O(3,"a",8),G(4,"Login"),U(),O(5,"a",9),G(6,"Registro"),U(),we(7,"div",7),U())}var jf=class n{constructor(e,t){this.authSvc=e;this.router=t;this.user$=this.authSvc.user$,this.authSvc.user$.subscribe(r=>{this.usuario=r})}user$;usuario$;usuario;logOut(){return R(this,null,function*(){try{yield this.authSvc.logout(),this.router.navigate(["/login"])}catch(e){console.log(e)}})}static \u0275fac=function(t){return new(t||n)(Z(an),Z(Tt))};static \u0275cmp=He({type:n,selectors:[["app-menu"]],decls:5,vars:4,consts:[["login",""],[1,"body"],[4,"ngIf","ngIfElse"],["routerLink","/home"],["routerLink","/juegos"],["routerLink","/quiensoy"],[3,"click"],[1,"animation","start-home"],["routerLink","/login"],["routerLink","/registro"]],template:function(t,r){if(t&1&&(O(0,"div",1),ot(1,JV,12,1,"nav",2),fi(2,"async"),ot(3,XV,8,0,"ng-template",null,0,OC),U()),t&2){let i=MC(4);se(),ke("ngIf",Es(2,2,r.user$))("ngIfElse",i)}},dependencies:[It,Sn,Ts,Pr],styles:["nav[_ngcontent-%COMP%]{margin:27px auto 0;position:relative;width:700px;height:50px;background-color:#05a5b0;border-radius:8px;font-size:0}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{line-height:50px;height:100%;font-size:15px;display:inline-block;position:relative;z-index:1;text-decoration:none;text-transform:uppercase;text-align:center;color:#fff;cursor:pointer}nav[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:50px;height:100%;font-size:15px;display:inline-block;position:relative;z-index:1;text-decoration:none;text-transform:uppercase;text-align:center;color:#fff;cursor:pointer}nav[_ngcontent-%COMP%]   .animation[_ngcontent-%COMP%]{position:absolute;height:100%;top:0;z-index:0;transition:all .5s ease 0s;border-radius:8px}a[_ngcontent-%COMP%]:nth-child(1){width:100px}a[_ngcontent-%COMP%]:nth-child(2){width:110px}a[_ngcontent-%COMP%]:nth-child(3){width:100px}a[_ngcontent-%COMP%]:nth-child(4){width:160px}a[_ngcontent-%COMP%]:nth-child(5){width:120px}nav[_ngcontent-%COMP%]   .start-home[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:nth-child(1):hover ~ .animation[_ngcontent-%COMP%]{width:100px;left:0;background-color:#1abc9c}nav[_ngcontent-%COMP%]   .start-about[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:nth-child(2):hover ~ .animation[_ngcontent-%COMP%]{width:110px;left:100px;background-color:#e74c3c}nav[_ngcontent-%COMP%]   .start-blog[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:nth-child(3):hover ~ .animation[_ngcontent-%COMP%]{width:100px;left:210px;background-color:#3498db}nav[_ngcontent-%COMP%]   .start-portefolio[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:nth-child(4):hover ~ .animation[_ngcontent-%COMP%]{width:160px;left:310px;background-color:#9b59b6}body[_ngcontent-%COMP%]{font-size:12px;font-family:sans-serif;background:#1f293a;background-color:#2c4766}h1[_ngcontent-%COMP%]{margin:40px 0;text-align:center;font-size:30px;color:#ecf0f1;text-shadow:2px 2px 4px #000000;font-family:Cherry Swash,cursive}p[_ngcontent-%COMP%]{position:absolute;bottom:20px;width:100%;text-align:center;color:#ecf0f1;font-family:Cherry Swash,cursive;font-size:16px}span[_ngcontent-%COMP%]{color:#2bd6b4}"]})};var qf=class n{title="tp1salajuegos";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=He({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){t&1&&we(0,"app-menu")(1,"router-outlet")},dependencies:[sl,jf],styles:["body[_ngcontent-%COMP%]{background:#2c4766}"]})};Yp(qf,G1).catch(n=>console.error(n));
